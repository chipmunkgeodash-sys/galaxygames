<!DOCTYPE html>
<html lang="en" data-theme="midnight">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Galaxy Lounge</title>
<style>
:root{
  --bg:#050510;
  --panel:rgba(255,255,255,.06);
  --border:rgba(255,255,255,.10);
  --text:#e7eaf0;
  --muted:rgba(231,234,240,.72);
  --a1:#38bdf8;
  --a2:#a855f7;
  --danger:#ef4444;
  --blur:18px;
  --r:18px;
  --shadow:0 24px 80px rgba(0,0,0,.55);
}
:root[data-theme="aurora"]{--a1:#34d399;--a2:#60a5fa;}
:root[data-theme="sunset"]{--a1:#fb7185;--a2:#f59e0b;}
:root[data-theme="cyberpunk"]{--a1:#22d3ee;--a2:#f472b6;}
:root[data-theme="nebula"]{--a1:#a78bfa;--a2:#22c55e;}
:root[data-theme="mono"]{--a1:#e5e7eb;--a2:#94a3b8;}

*{box-sizing:border-box;font-family:Segoe UI,system-ui,-apple-system,Arial,sans-serif}
html,body{margin:0;height:100%;overflow:hidden;background:radial-gradient(1200px 800px at 20% 10%, #14124a 0%, var(--bg) 55%, #000 100%);color:var(--text)}
@keyframes fadeUp{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
@keyframes scaleIn{from{opacity:0;transform:scale(.96)}to{opacity:1;transform:scale(1)}}

#boot{position:fixed;inset:0;z-index:99999;display:flex;align-items:center;justify-content:center;
  background:radial-gradient(circle at 50% 40%, #2a1b6f 0%, #07081a 50%, #020617 100%);}
#boot .card{display:grid;gap:10px;place-items:center;animation:fadeUp 1.1s ease}
.logo{width:54px;height:54px;border-radius:18px;display:grid;place-items:center;font-weight:900;color:#020617;
  background:radial-gradient(circle at 30% 20%, var(--a1), var(--a2)); box-shadow:0 18px 55px rgba(56,189,248,.22);}
#boot h1{margin:0;font-size:1.6rem;letter-spacing:.28em}
#boot .sub{color:var(--muted);font-size:.92rem;letter-spacing:.08em}

#login{position:fixed;inset:0;z-index:90000;display:none;align-items:center;justify-content:center;
  background:radial-gradient(900px 600px at 55% 40%, rgba(56,189,248,.18), transparent 55%),
             radial-gradient(900px 600px at 35% 60%, rgba(168,85,247,.14), transparent 55%),
             rgba(2,6,23,.72);
  backdrop-filter:blur(var(--blur));}
.login-card{width:min(440px, calc(100vw - 28px));
  background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.05));
  border:1px solid var(--border);border-radius:24px;padding:22px;box-shadow:var(--shadow);animation:scaleIn .25s ease;}
.login-card .brand{display:flex;align-items:center;justify-content:center;gap:10px;margin-bottom:8px}
.login-card h2{margin:0;letter-spacing:.18em;font-size:1.05rem}
.login-card .hint{margin-top:6px;color:var(--muted);font-size:.88rem;text-align:center}
.login-card input{width:100%;margin-top:10px;padding:12px;border-radius:14px;border:1px solid rgba(255,255,255,.12);
  background:rgba(2,6,23,.55);color:var(--text);outline:none;}
.login-card input:focus{border-color:rgba(56,189,248,.45);box-shadow:0 0 0 3px rgba(56,189,248,.12)}
.login-card button{width:100%;margin-top:14px;padding:12px;border:none;border-radius:999px;cursor:pointer;font-weight:900;
  background:linear-gradient(135deg,var(--a1),var(--a2));color:#020617;}
#login-error{display:none;margin-top:10px;color:#fca5a5;font-size:.88rem;text-align:center}
.toggle{display:flex;align-items:center;gap:10px;margin-top:12px;color:var(--muted);font-size:.9rem;justify-content:center}

#topbar{position:fixed;top:0;left:0;right:0;height:44px;z-index:5000;
  display:flex;align-items:center;justify-content:space-between;padding:0 14px;
  background:rgba(2,6,23,.55);border-bottom:1px solid rgba(255,255,255,.08);backdrop-filter:blur(var(--blur));}
#topbar .left{display:flex;align-items:center;gap:10px}
.dot{width:9px;height:9px;border-radius:999px;background:rgba(56,189,248,.7);box-shadow:0 0 20px rgba(56,189,248,.35)}
.title{font-weight:900;letter-spacing:.12em}
#topbar .right{display:flex;gap:10px;align-items:center}
#panic{background:rgba(239,68,68,.12);border:1px solid rgba(239,68,68,.35);color:#fecaca;font-weight:900;padding:7px 14px;border-radius:999px;cursor:pointer}
#lock{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);color:var(--text);font-weight:800;padding:7px 12px;border-radius:999px;cursor:pointer}

#desktop{position:absolute;top:44px;left:0;right:0;bottom:54px;padding:22px;display:grid;
  grid-template-columns:repeat(auto-fill, 92px);gap:16px;align-content:start;}
.icon{width:92px;padding:10px 8px;border-radius:16px;display:grid;place-items:center;gap:6px;cursor:pointer;user-select:none;
  transition:transform .16s ease, background .16s ease;animation:fadeUp .25s ease;}
.icon:hover{background:rgba(255,255,255,.06);transform:translateY(-2px)}
.icon .emoji{font-size:28px}
.icon span{font-size:.78rem;color:var(--muted);text-align:center;line-height:1.2}

.window{position:absolute;left:16px;top:60px;width:calc(100vw - 32px);height:calc(100vh - 128px);
  background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.05));
  border:1px solid rgba(255,255,255,.10);border-radius:var(--r);box-shadow:0 30px 120px rgba(0,0,0,.65), 0 0 0 1px rgba(255,255,255,.06) inset;
  display:none;flex-direction:column;overflow:hidden;animation:scaleIn .18s ease;}
.titlebar{height:44px;display:flex;align-items:center;justify-content:space-between;padding:0 12px;
  background:rgba(2,6,23,.42);border-bottom:1px solid rgba(255,255,255,.08);cursor:grab;}
.titlebar .name{font-weight:800}
.win-actions{display:flex;gap:8px}
.win-actions button{width:32px;height:32px;border-radius:10px;border:1px solid rgba(255,255,255,.10);background:rgba(255,255,255,.06);color:var(--text);cursor:pointer;font-weight:900}
.win-actions .close{border-color:rgba(239,68,68,.25)}
.content{flex:1;padding:0;background:rgba(2,6,23,.25)}
.content iframe{width:100%;height:100%;border:none;display:block;background:transparent}

.window.maximized{left:0;top:44px;width:100vw;height:calc(100vh - 98px);border-radius:0}

#taskbar{position:fixed;bottom:0;left:0;right:0;height:54px;z-index:4500;display:flex;align-items:center;justify-content:center;gap:10px;padding:0 14px;
  background:rgba(2,6,23,.55);border-top:1px solid rgba(255,255,255,.08);backdrop-filter:blur(var(--blur));}
#startBtn{border:1px solid rgba(255,255,255,.12);background:linear-gradient(135deg, rgba(56,189,248,.25), rgba(168,85,247,.25));
  color:white;padding:10px 16px;border-radius:999px;font-weight:900;cursor:pointer}
.task-btn{border:1px solid rgba(255,255,255,.10);background:rgba(255,255,255,.06);color:var(--text);padding:9px 12px;border-radius:999px;cursor:pointer;font-weight:700;font-size:.85rem}
.task-btn.active{background:linear-gradient(135deg, rgba(56,189,248,.22), rgba(168,85,247,.18));border-color:rgba(56,189,248,.22)}

/* Start menu */
#startMenu{position:fixed;bottom:64px;left:16px;width:260px;background:rgba(2,6,23,.75);
  backdrop-filter:blur(22px);border:1px solid rgba(255,255,255,.12);border-radius:20px;box-shadow:0 40px 120px rgba(0,0,0,.6);
  display:none;padding:14px;z-index:6000;}
#startMenu h3{margin:0 0 10px;font-size:.9rem;letter-spacing:.12em;color:var(--muted)}
.start-item{padding:10px 12px;border-radius:14px;cursor:pointer}
.start-item:hover{background:rgba(255,255,255,.08)}

/* Scrollbars */
*::-webkit-scrollbar{width:8px;height:8px}
*::-webkit-scrollbar-track{background:transparent}
*::-webkit-scrollbar-thumb{background:linear-gradient(180deg, var(--a1), var(--a2));border-radius:999px}

/* Ensure embedded apps fill the entire window content */
.window .content{padding:0 !important;}
.window .content iframe{width:100% !important;height:100% !important;display:block;}


/* Buttons (used by Changelog modal) */
.btn{padding:10px 14px;border-radius:999px;border:1px solid rgba(255,255,255,.14);background:rgba(255,255,255,.06);color:var(--text);cursor:pointer;font-weight:800}
.btn:hover{background:rgba(255,255,255,.09)}
.btn.primary{border:none;background:linear-gradient(135deg,var(--a1),var(--a2));color:#020617}
</style>
</head>
<body>

<div id="boot">
  <div class="card">
    <div class="logo">GX</div>
    <h1>GALAXY LOUNGE</h1>
    <div class="sub">Starting up</div>
  </div>
</div>

<div id="login">
  <div class="login-card">
    <div class="brand"><div class="logo" style="width:42px;height:42px;border-radius:14px;">GX</div><h2>GALAXY LOUNGE</h2></div>
    <div class="hint">Sign in to continue</div>
    <div id="login-error"></div>
    <input id="user" placeholder="Username" autocomplete="username" />
    <input id="pass" type="password" placeholder="Password" autocomplete="current-password" />
    <div class="toggle"><input id="autoLogin" type="checkbox" /> <label for="autoLogin">Auto-login</label></div>
    <button onclick="login()">Login</button>
  </div>
</div>

<div id="topbar">
  <div class="left"><div class="dot"></div><div class="title">Galaxy Lounge</div></div>
  <div class="right">
    <button id="lock" onclick="lockScreen()">Lock</button>
    <button id="panic" onclick="panic()">Panic</button>
  </div>
</div>

<div id="desktop">
  <div class="icon" onclick="openWin('games')"><div class="emoji">üéÆ</div><span>Games</span></div>
  <div class="icon" onclick="openWin('music')"><div class="emoji">üéµ</div><span>Music</span></div>
  <div class="icon" onclick="openWin('settings')"><div class="emoji">‚öôÔ∏è</div><span>Settings</span></div>
  <div class="icon" onclick="openWin('browser')"><div class="emoji">üåê</div><span>Browser</span></div>
</div>

<div id="taskbar">
  <button id="startBtn" onclick="toggleStart()">Start</button>
</div>

<div id="startMenu">
  <h3>APPS</h3>
  <div class="start-item" onclick="openWin('games');toggleStart()">üéÆ Games</div>
  <div class="start-item" onclick="openWin('music');toggleStart()">üéµ Music</div>
    <div class="start-item" onclick="openChangelog();toggleStart()">üìù Changelog</div>
<div class="start-item" onclick="openWin('settings');toggleStart()">‚öôÔ∏è Settings</div>
  <div class="start-item" onclick="openWin('browser');toggleStart()">üåê Browser</div>
  <div class="start-item" onclick="openChangelog();toggleStart()">üìù Changelog</div>
</div>

<div id="games" class="window">
  <div class="titlebar"><div class="name">Games</div><div class="win-actions">
    <button title="Maximize" onclick="toggleMax('games')">‚ñ¢</button>
    <button title="Minimize" onclick="minWin('games')">‚Äì</button>
    <button class="close" title="Close" onclick="closeWin('games')">√ó</button>
  </div></div>
  <div class="content"><iframe onload="try{this.contentDocument.documentElement.classList.add('app-mode')}catch(e){}" src="data:text/html;base64,PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+CiAgPG1ldGEgY2hhcnNldD0iVVRGLTgiPgogIDx0aXRsZT5HYWxheHkgR2FtZXMgLSBSZWRlc2lnbjwvdGl0bGU+CiAgPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xLjAiPgogIDxzdHlsZT4KICAgIDpyb290IHsKICAgICAgLS1iZzogcmFkaWFsLWdyYWRpZW50KGNpcmNsZSBhdCB0b3AgbGVmdCwgIzExMTgyNywgIzAyMDYxNyA1NSUsICMwMDAwMDApOwogICAgICAtLWJnLXBhbmVsOiByZ2JhKDE1LDIzLDQyLDAuOTYpOwogICAgICAtLWFjY2VudDogIzM4YmRmODsKICAgICAgLS1hY2NlbnQtc29mdDogcmdiYSg1NiwxODksMjQ4LDAuMTgpOwogICAgICAtLWFjY2VudC0yOiAjYTg1NWY3OwogICAgICAtLXRleHQtbWFpbjogI2Y5ZmFmYjsKICAgICAgLS10ZXh0LW11dGVkOiAjOWNhM2FmOwogICAgICAtLWJvcmRlci1zdWJ0bGU6IHJnYmEoMTQ4LDE2MywxODQsMC4zKTsKICAgICAgLS1yYWRpdXMtbGc6IDE4cHg7CiAgICAgIC0tc2hhZG93LXNvZnQ6IDAgMjRweCA4MHB4IHJnYmEoMTUsMjMsNDIsMC45KTsKICAgIH0KICAgICosCiAgICAqOjpiZWZvcmUsCiAgICAqOjphZnRlciB7CiAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7CiAgICB9CiAgICBodG1sLCBib2R5IHsKICAgICAgbWFyZ2luOiAwOwogICAgICBwYWRkaW5nOiAwOwogICAgICBoZWlnaHQ6IDEwMCU7CiAgICB9CiAgICBib2R5IHsKICAgICAgZm9udC1mYW1pbHk6IHN5c3RlbS11aSwgLWFwcGxlLXN5c3RlbSwgQmxpbmtNYWNTeXN0ZW1Gb250LCAiU0YgUHJvIFRleHQiLCBzYW5zLXNlcmlmOwogICAgICBjb2xvcjogdmFyKC0tdGV4dC1tYWluKTsKICAgICAgYmFja2dyb3VuZDogdmFyKC0tYmcpOwogICAgICBiYWNrZ3JvdW5kLWF0dGFjaG1lbnQ6IGZpeGVkOwogICAgICBkaXNwbGF5OiBmbGV4OwogICAgICBhbGlnbi1pdGVtczogc3RyZXRjaDsKICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICB9CiAgICAuYXBwLXNoZWxsIHsKICAgICAgZGlzcGxheTogZ3JpZDsKICAgICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiA4MHB4IG1pbm1heCgwLCAxZnIpOwogICAgICBtYXgtd2lkdGg6IDEyMDBweDsKICAgICAgd2lkdGg6IDEwMCU7CiAgICAgIGhlaWdodDogMTAwdmg7CiAgICAgIHBhZGRpbmc6IDE4cHg7CiAgICAgIGdhcDogMThweDsKICAgIH0KICAgIC8qIFNpZGViYXIgKi8KICAgIC5zaWRlYmFyIHsKICAgICAgYmFja2dyb3VuZDogcmdiYSgxNSwyMyw0MiwwLjk2KTsKICAgICAgYm9yZGVyLXJhZGl1czogMjRweDsKICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgxNSwyMyw0MiwwLjkpOwogICAgICBib3gtc2hhZG93OiB2YXIoLS1zaGFkb3ctc29mdCk7CiAgICAgIHBhZGRpbmc6IDE0cHggMTBweDsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogICAgfQogICAgLmxvZ28tY2lyY2xlIHsKICAgICAgd2lkdGg6IDQycHg7CiAgICAgIGhlaWdodDogNDJweDsKICAgICAgYm9yZGVyLXJhZGl1czogOTk5cHg7CiAgICAgIGJhY2tncm91bmQ6IHJhZGlhbC1ncmFkaWVudChjaXJjbGUgYXQgMzAlIDIwJSwgIzM4YmRmOCwgIzBmMTcyYSk7CiAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgICBmb250LXdlaWdodDogODAwOwogICAgICBsZXR0ZXItc3BhY2luZzogMC4wNGVtOwogICAgICBmb250LXNpemU6IDFyZW07CiAgICAgIGJveC1zaGFkb3c6IDAgMTBweCAzMHB4IHJnYmEoNTYsMTg5LDI0OCwwLjM1KTsKICAgIH0KICAgIC5zaWRlLW5hdiB7CiAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICAgIGdhcDogMTBweDsKICAgICAgbWFyZ2luLXRvcDogMTJweDsKICAgIH0KICAgIC5zaWRlLW5hdiBidXR0b24gewogICAgICBhbGw6IHVuc2V0OwogICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgIHdpZHRoOiA0MHB4OwogICAgICBoZWlnaHQ6IDQwcHg7CiAgICAgIGJvcmRlci1yYWRpdXM6IDk5OXB4OwogICAgICBkaXNwbGF5OiBmbGV4OwogICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgICAgZm9udC1zaXplOiAxLjJyZW07CiAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsKICAgICAgdHJhbnNpdGlvbjogYWxsIDAuMThzIGVhc2U7CiAgICB9CiAgICAuc2lkZS1uYXYgYnV0dG9uOmhvdmVyIHsKICAgICAgYmFja2dyb3VuZDogcmdiYSgxNSwyMyw0MiwwLjkpOwogICAgICBjb2xvcjogdmFyKC0tdGV4dC1tYWluKTsKICAgIH0KICAgIC5zaWRlLW5hdiBidXR0b24uYWN0aXZlIHsKICAgICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgdmFyKC0tYWNjZW50KSwgdmFyKC0tYWNjZW50LTIpKTsKICAgICAgY29sb3I6ICMwYjExMjA7CiAgICAgIGJveC1zaGFkb3c6IDAgMTBweCAzNXB4IHJnYmEoNTYsMTg5LDI0OCwwLjQpOwogICAgfQogICAgLnNpZGUtY2xvY2sgewogICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICAgIGZvbnQtc2l6ZTogMC43cmVtOwogICAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7CiAgICAgIGRpc3BsYXk6IGdyaWQ7CiAgICAgIGdhcDogMnB4OwogICAgfQogICAgLnNpZGUtY2xvY2stdGltZSB7CiAgICAgIGZvbnQtc2l6ZTogMC45cmVtOwogICAgICBmb250LXdlaWdodDogNjAwOwogICAgICBsZXR0ZXItc3BhY2luZzogMC4wOGVtOwogICAgfQogICAgLyogTWFpbiBhcmVhICovCiAgICAubWFpbiB7CiAgICAgIGJhY2tncm91bmQ6IHZhcigtLWJnLXBhbmVsKTsKICAgICAgYm9yZGVyLXJhZGl1czogMjRweDsKICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgxNSwyMyw0MiwwLjkpOwogICAgICBib3gtc2hhZG93OiB2YXIoLS1zaGFkb3ctc29mdCk7CiAgICAgIHBhZGRpbmc6IDE4cHggMjJweCAyMHB4OwogICAgICBkaXNwbGF5OiBmbGV4OwogICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgICBnYXA6IDE4cHg7CiAgICAgIG92ZXJmbG93OiBoaWRkZW47CiAgICB9CiAgICAubWFpbi1oZWFkZXIgewogICAgICBkaXNwbGF5OiBmbGV4OwogICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47CiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgIGdhcDogMTZweDsKICAgIH0KICAgIC5icmFuZC1ibG9jayB7CiAgICAgIGRpc3BsYXk6IGdyaWQ7CiAgICAgIGdhcDogNHB4OwogICAgfQogICAgLmJyYW5kLXRpdGxlIHsKICAgICAgZm9udC1zaXplOiAxLjRyZW07CiAgICAgIGZvbnQtd2VpZ2h0OiA4MDA7CiAgICAgIGxldHRlci1zcGFjaW5nOiAwLjA4ZW07CiAgICAgIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7CiAgICB9CiAgICAuYnJhbmQtc3VidGl0bGUgewogICAgICBmb250LXNpemU6IDAuODVyZW07CiAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsKICAgIH0KICAgIC5waWxsLXJvdyB7CiAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgIGdhcDogOHB4OwogICAgICBmbGV4LXdyYXA6IHdyYXA7CiAgICAgIGZvbnQtc2l6ZTogMC43NXJlbTsKICAgIH0KICAgIC5waWxsIHsKICAgICAgcGFkZGluZzogNHB4IDhweDsKICAgICAgYm9yZGVyLXJhZGl1czogOTk5cHg7CiAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHJnYmEoMTQ4LDE2MywxODQsMC4zNSk7CiAgICAgIGJhY2tncm91bmQ6IHJnYmEoMTUsMjMsNDIsMC45KTsKICAgICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOwogICAgfQogICAgLyogVG9wIHRhYiByb3cgKi8KICAgIC50b3AtdGFicyB7CiAgICAgIGRpc3BsYXk6IGlubGluZS1mbGV4OwogICAgICBwYWRkaW5nOiA0cHg7CiAgICAgIGJvcmRlci1yYWRpdXM6IDk5OXB4OwogICAgICBiYWNrZ3JvdW5kOiByZ2JhKDE1LDIzLDQyLDAuNyk7CiAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHJnYmEoMTUsMjMsNDIsMC45KTsKICAgIH0KICAgIC50b3AtdGFicyBidXR0b24gewogICAgICBhbGw6IHVuc2V0OwogICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgIHBhZGRpbmc6IDZweCAxNHB4OwogICAgICBib3JkZXItcmFkaXVzOiA5OTlweDsKICAgICAgZm9udC1zaXplOiAwLjg1cmVtOwogICAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7CiAgICAgIHRyYW5zaXRpb246IGFsbCAwLjE2czsKICAgIH0KICAgIC50b3AtdGFicyBidXR0b24uYWN0aXZlIHsKICAgICAgYmFja2dyb3VuZDogcmFkaWFsLWdyYWRpZW50KGNpcmNsZSBhdCB0b3AgbGVmdCwgdmFyKC0tYWNjZW50KSwgdmFyKC0tYWNjZW50LTIpKTsKICAgICAgY29sb3I6ICMwMjA2MTc7CiAgICAgIGJveC1zaGFkb3c6IDAgMTBweCAyNXB4IHJnYmEoNTYsMTg5LDI0OCwwLjQ1KTsKICAgICAgZm9udC13ZWlnaHQ6IDYwMDsKICAgIH0KICAgIC8qIFBhbmVscyAqLwogICAgLnBhbmVsLXNoZWxsIHsKICAgICAgZmxleDogMTsKICAgICAgYm9yZGVyLXJhZGl1czogMThweDsKICAgICAgYmFja2dyb3VuZDogcmFkaWFsLWdyYWRpZW50KGNpcmNsZSBhdCB0b3AgbGVmdCwgcmdiYSgxNSwyMyw0MiwwLjk1KSwgIzAyMDYxNyk7CiAgICAgIHBhZGRpbmc6IDE4cHggMThweCAxNnB4OwogICAgICBkaXNwbGF5OiBmbGV4OwogICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgfQogICAgLnRhYi1wYW5lbCB7CiAgICAgIGRpc3BsYXk6IG5vbmU7CiAgICAgIGhlaWdodDogMTAwJTsKICAgIH0KICAgIC50YWItcGFuZWwuYWN0aXZlIHsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgICAgZ2FwOiAxNnB4OwogICAgfQogICAgLyogRml4IGN1dG9mZiAqLwogICAgLnRhYi1wYW5lbFtkYXRhLXRhYj0iZ2FtZXMiXSwKICAgIC50YWItcGFuZWxbZGF0YS10YWI9Im11c2ljIl0gewogICAgICBvdmVyZmxvdy15OiBhdXRvOwogICAgICBtYXgtaGVpZ2h0OiBjYWxjKDEwMHZoIC0gMjIwcHgpOwogICAgICBwYWRkaW5nLXJpZ2h0OiA0cHg7CiAgICB9CiAgICAvKiBIb21lIHBhbmVsICovCiAgICAuaGVybyB7CiAgICAgIGRpc3BsYXk6IGdyaWQ7CiAgICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogbWlubWF4KDAsIDEuNGZyKSBtaW5tYXgoMCwgMWZyKTsKICAgICAgZ2FwOiAxOHB4OwogICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgfQogICAgLmhlcm8tdGl0bGUgewogICAgICBmb250LXNpemU6IDJyZW07CiAgICAgIGZvbnQtd2VpZ2h0OiA4MDA7CiAgICAgIGxldHRlci1zcGFjaW5nOiAwLjA2ZW07CiAgICAgIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7CiAgICB9CiAgICAuaGVyby10aXRsZSBzcGFuLmFjY2VudCB7CiAgICAgIGNvbG9yOiB2YXIoLS1hY2NlbnQpOwogICAgfQogICAgLmhlcm8tc3ViIHsKICAgICAgbWFyZ2luLXRvcDogOHB4OwogICAgICBmb250LXNpemU6IDAuOXJlbTsKICAgICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOwogICAgICBtYXgtd2lkdGg6IDM4MHB4OwogICAgfQogICAgLmhlcm8tYWN0aW9ucyB7CiAgICAgIG1hcmdpbi10b3A6IDE0cHg7CiAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgIGdhcDogMTBweDsKICAgICAgZmxleC13cmFwOiB3cmFwOwogICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgfQogICAgLmJ0bi1wcmltYXJ5IHsKICAgICAgcGFkZGluZzogMC43cmVtIDEuNHJlbTsKICAgICAgYm9yZGVyLXJhZGl1czogOTk5cHg7CiAgICAgIGJvcmRlcjogbm9uZTsKICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgICBiYWNrZ3JvdW5kOiByYWRpYWwtZ3JhZGllbnQoY2lyY2xlIGF0IHRvcCBsZWZ0LCB2YXIoLS1hY2NlbnQpLCB2YXIoLS1hY2NlbnQtMikpOwogICAgICBjb2xvcjogIzAyMDYxNzsKICAgICAgZm9udC13ZWlnaHQ6IDYwMDsKICAgICAgZm9udC1zaXplOiAwLjlyZW07CiAgICAgIGJveC1zaGFkb3c6IDAgMTJweCAzMHB4IHJnYmEoNTYsMTg5LDI0OCwwLjQ1KTsKICAgIH0KICAgIC5idG4tcHJpbWFyeTpob3ZlciB7CiAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMXB4KTsKICAgIH0KICAgIC5idG4tZ2hvc3QgewogICAgICBwYWRkaW5nOiAwLjZyZW0gMS4xcmVtOwogICAgICBib3JkZXItcmFkaXVzOiA5OTlweDsKICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgxNDgsMTYzLDE4NCwwLjQpOwogICAgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDsKICAgICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOwogICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgIGZvbnQtc2l6ZTogMC44NXJlbTsKICAgIH0KICAgIC5oZXJvLWNhcmQgewogICAgICBib3JkZXItcmFkaXVzOiAyMHB4OwogICAgICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDE0OCwxNjMsMTg0LDAuMzUpOwogICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCByZ2JhKDE1LDIzLDQyLDAuOSksIHJnYmEoMzAsNjQsMTc1LDAuOSkpOwogICAgICBwYWRkaW5nOiAxNHB4OwogICAgICBkaXNwbGF5OiBncmlkOwogICAgICBnYXA6IDEwcHg7CiAgICB9CiAgICAuaGVyby1jYXJkLXRodW1iIHsKICAgICAgYm9yZGVyLXJhZGl1czogMTRweDsKICAgICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKCdodHRwczovL2ltYWdlcy5wZXhlbHMuY29tL3Bob3Rvcy8zOTUwMS9sYW1ib3JnaGluaS1icm5vLXJhY2luZy1jYXItYXV0b21vYmlsZXMtMzk1MDEuanBlZz9hdXRvPWNvbXByZXNzJmNzPXRpbnlzcmdiJnc9MTIwMCcpOwogICAgICBiYWNrZ3JvdW5kLXNpemU6IGNvdmVyOwogICAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7CiAgICAgIGhlaWdodDogMTUwcHg7CiAgICB9CiAgICAuaGVyby1jYXJkLXRpdGxlIHsKICAgICAgZm9udC13ZWlnaHQ6IDYwMDsKICAgICAgZm9udC1zaXplOiAwLjk1cmVtOwogICAgfQogICAgLmhlcm8tY2FyZC1tZXRhIHsKICAgICAgZm9udC1zaXplOiAwLjhyZW07CiAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAgZ2FwOiAxMHB4OwogICAgfQogICAgLyogR2FtZXMgcGFuZWwgKi8KICAgIC5nYW1lcy1oZWFkZXItcm93IHsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICBnYXA6IDEwcHg7CiAgICAgIGZsZXgtd3JhcDogd3JhcDsKICAgIH0KICAgIC5nYW1lcy10aXRsZSB7CiAgICAgIGZvbnQtc2l6ZTogMS4ycmVtOwogICAgICBmb250LXdlaWdodDogNzAwOwogICAgfQogICAgLnNlYXJjaC1iYXIgewogICAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICAgIHdpZHRoOiAyNjBweDsKICAgICAgbWF4LXdpZHRoOiAxMDAlOwogICAgfQogICAgLnNlYXJjaC1iYXIgaW5wdXQgewogICAgICB3aWR0aDogMTAwJTsKICAgICAgcGFkZGluZzogMC42cmVtIDJyZW0gMC42cmVtIDAuOHJlbTsKICAgICAgYm9yZGVyLXJhZGl1czogOTk5cHg7CiAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHJnYmEoMTQ4LDE2MywxODQsMC40KTsKICAgICAgYmFja2dyb3VuZDogcmdiYSgxNSwyMyw0MiwwLjg1KTsKICAgICAgY29sb3I6IHZhcigtLXRleHQtbWFpbik7CiAgICAgIGZvbnQtc2l6ZTogMC44NXJlbTsKICAgIH0KICAgIC5zZWFyY2gtYmFyIHNwYW4gewogICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgIHJpZ2h0OiAwLjdyZW07CiAgICAgIHRvcDogNTAlOwogICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTUwJSk7CiAgICAgIGZvbnQtc2l6ZTogMC45cmVtOwogICAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7CiAgICB9CiAgICAuZ2FtZS1saXN0IHsKICAgICAgbWFyZ2luLXRvcDogMTRweDsKICAgICAgZGlzcGxheTogZ3JpZDsKICAgICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiByZXBlYXQoYXV0by1maWxsLCBtaW5tYXgoMjEwcHgsIDFmcikpOwogICAgICBnYXA6IDEycHg7CiAgICAgIG92ZXJmbG93OiBhdXRvOwogICAgICBwYWRkaW5nLXJpZ2h0OiA0cHg7CiAgICB9CiAgICAuZ2FtZS1jYXJkIHsKICAgICAgYm9yZGVyLXJhZGl1czogMTZweDsKICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgxNDgsMTYzLDE4NCwwLjI1KTsKICAgICAgYmFja2dyb3VuZDogcmdiYSgxNSwyMyw0MiwwLjkpOwogICAgICBwYWRkaW5nOiAxMHB4OwogICAgICBkaXNwbGF5OiBncmlkOwogICAgICBnYXA6IDhweDsKICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC4xMnMgZWFzZSwgYm94LXNoYWRvdyAwLjEycyBlYXNlLCBib3JkZXItY29sb3IgMC4xMnMgZWFzZTsKICAgIH0KICAgIC5nYW1lLWNhcmQ6aG92ZXIgewogICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTJweCk7CiAgICAgIGJveC1zaGFkb3c6IDAgMTRweCAzNXB4IHJnYmEoMTUsMjMsNDIsMC45KTsKICAgICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1hY2NlbnQtc29mdCk7CiAgICB9CiAgICAuZ2FtZS10b3Atcm93IHsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgZ2FwOiA4cHg7CiAgICB9CiAgICAuZ2FtZS1pY29uIHsKICAgICAgd2lkdGg6IDMycHg7CiAgICAgIGhlaWdodDogMzJweDsKICAgICAgYm9yZGVyLXJhZGl1czogMTJweDsKICAgICAgYmFja2dyb3VuZC1zaXplOiBjb3ZlcjsKICAgICAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyOwogICAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDMxLDQxLDU1LDAuOSk7CiAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgICBmb250LXNpemU6IDEuMXJlbTsKICAgIH0KICAgIC5nYW1lLWJvZHkgewogICAgICBkaXNwbGF5OiBncmlkOwogICAgICBnYXA6IDJweDsKICAgIH0KICAgIC5nYW1lLXRpdGxlIHsKICAgICAgZm9udC1zaXplOiAwLjlyZW07CiAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7CiAgICB9CiAgICAuZ2FtZS1kZXNjIHsKICAgICAgZm9udC1zaXplOiAwLjc1cmVtOwogICAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7CiAgICB9CiAgICAuZ2FtZS10aHVtYiB7CiAgICAgIGJvcmRlci1yYWRpdXM6IDEycHg7CiAgICAgIGhlaWdodDogOTZweDsKICAgICAgYmFja2dyb3VuZC1zaXplOiBjb3ZlcjsKICAgICAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyOwogICAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDE1LDIzLDQyLDAuOSk7CiAgICB9CiAgICAuZ2FtZS1hY3Rpb25zIHsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAganVzdGlmeS1jb250ZW50OiBmbGV4LWVuZDsKICAgIH0KICAgIC5nYW1lLWJ1dHRvbiB7CiAgICAgIHBhZGRpbmc6IDAuNHJlbSAwLjlyZW07CiAgICAgIGJvcmRlci1yYWRpdXM6IDk5OXB4OwogICAgICBib3JkZXI6IG5vbmU7CiAgICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsIHZhcigtLWFjY2VudCksIHZhcigtLWFjY2VudC0yKSk7CiAgICAgIGNvbG9yOiAjMDIwNjE3OwogICAgICBmb250LXNpemU6IDAuOHJlbTsKICAgICAgZm9udC13ZWlnaHQ6IDYwMDsKICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgfQogICAgLmdhbWUtYnV0dG9uOmhvdmVyIHsKICAgICAgZmlsdGVyOiBicmlnaHRuZXNzKDEuMDUpOwogICAgfQogICAgLyogU291bmRib2FyZCBwYW5lbCAqLwogICAgLnNvdW5kYm9hcmQtbm90ZSB7CiAgICAgIGZvbnQtc2l6ZTogMC44cmVtOwogICAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7CiAgICAgIG1hcmdpbi10b3A6IDRweDsKICAgIH0KICAgIC5zb3VuZGJvYXJkLXN0YXR1cyB7CiAgICAgIGZvbnQtc2l6ZTogMC44cmVtOwogICAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7CiAgICAgIG1pbi1oZWlnaHQ6IDFlbTsKICAgICAgbWFyZ2luLXRvcDogNnB4OwogICAgfQogICAgLnNvdW5kYm9hcmQtZ3JpZCB7CiAgICAgIG1hcmdpbi10b3A6IDE0cHg7CiAgICAgIGRpc3BsYXk6IGdyaWQ7CiAgICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogcmVwZWF0KGF1dG8tZml0LCBtaW5tYXgoMTYwcHgsIDFmcikpOwogICAgICBnYXA6IDEwcHg7CiAgICB9CiAgICAuc291bmQtcGFkIHsKICAgICAgYm9yZGVyLXJhZGl1czogMTRweDsKICAgICAgcGFkZGluZzogMTBweDsKICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgxNDgsMTYzLDE4NCwwLjMpOwogICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCByZ2JhKDE1LDIzLDQyLDAuOSksIHJnYmEoMTUsMjMsNDIsMC45OCkpOwogICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgIGRpc3BsYXk6IGdyaWQ7CiAgICAgIGdhcDogNHB4OwogICAgfQogICAgLnNvdW5kLXBhZCAudGFnIHsKICAgICAgZm9udC1zaXplOiAwLjdyZW07CiAgICAgIGNvbG9yOiB2YXIoLS1hY2NlbnQpOwogICAgICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlOwogICAgICBsZXR0ZXItc3BhY2luZzogMC4xMmVtOwogICAgfQogICAgLnNvdW5kLXBhZCAudGl0bGUgewogICAgICBmb250LXNpemU6IDAuOXJlbTsKICAgICAgZm9udC13ZWlnaHQ6IDYwMDsKICAgIH0KICAgIC5zb3VuZC1wYWQgLmhpbnQgewogICAgICBmb250LXNpemU6IDAuNzVyZW07CiAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsKICAgIH0KICAgIC5zb3VuZC1wYWQucGxheWluZyB7CiAgICAgIGJveC1zaGFkb3c6IDAgMCAwIDFweCB2YXIoLS1hY2NlbnQtc29mdCksIDAgMCAyMHB4IHJnYmEoNTYsMTg5LDI0OCwwLjQpOwogICAgfQogICAgLyogQWJvdXQgcGFuZWwgKi8KICAgIC5hYm91dC10ZXh0IHsKICAgICAgbWF4LXdpZHRoOiA1MjBweDsKICAgICAgZm9udC1zaXplOiAwLjlyZW07CiAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsKICAgICAgbGluZS1oZWlnaHQ6IDEuNzsKICAgIH0KICAgIC8qIE11c2ljIHRhYiAqLwogICAgLm11c2ljLWhlcm8gewogICAgICBkaXNwbGF5OiBncmlkOwogICAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IG1pbm1heCgwLCAxLjJmcikgbWlubWF4KDAsIDAuOGZyKTsKICAgICAgZ2FwOiAxNnB4OwogICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgfQogICAgLm11c2ljLWhlcm8gaDIgewogICAgICBtYXJnaW46IDA7CiAgICAgIGZvbnQtc2l6ZTogMS40cmVtOwogICAgICBsZXR0ZXItc3BhY2luZzogMC4wNWVtOwogICAgfQogICAgLm11c2ljLWhlcm8gcCB7CiAgICAgIG1hcmdpbjogNnB4IDAgMCAwOwogICAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7CiAgICAgIGZvbnQtc2l6ZTogMC45cmVtOwogICAgICBtYXgtd2lkdGg6IDUyMHB4OwogICAgfQogICAgLm11c2ljLXBpbGxzIHsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAgZ2FwOiA4cHg7CiAgICAgIGZsZXgtd3JhcDogd3JhcDsKICAgICAgbWFyZ2luLXRvcDogMTBweDsKICAgIH0KICAgIC5tdXNpYy1waWxsIHsKICAgICAgcGFkZGluZzogNnB4IDEwcHg7CiAgICAgIGJvcmRlci1yYWRpdXM6IDk5OXB4OwogICAgICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDE0OCwxNjMsMTg0LDAuMzUpOwogICAgICBiYWNrZ3JvdW5kOiByZ2JhKDE1LDIzLDQyLDAuNzgpOwogICAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7CiAgICAgIGZvbnQtc2l6ZTogMC43OHJlbTsKICAgIH0KICAgIC5tdXNpYy1ncmlkIHsKICAgICAgZGlzcGxheTogZ3JpZDsKICAgICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiByZXBlYXQoYXV0by1maWxsLCBtaW5tYXgoMjIwcHgsIDFmcikpOwogICAgICBnYXA6IDEycHg7CiAgICB9CiAgICAubXVzaWMtY2FyZCB7CiAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHJnYmEoMTQ4LDE2MywxODQsMC4yMik7CiAgICAgIGJvcmRlci1yYWRpdXM6IDE0cHg7CiAgICAgIGJhY2tncm91bmQ6IHJnYmEoMTUsMjMsNDIsMC45KTsKICAgICAgcGFkZGluZzogMTBweDsKICAgICAgZGlzcGxheTogZ3JpZDsKICAgICAgZ2FwOiA4cHg7CiAgICAgIGJveC1zaGFkb3c6IDAgMTBweCAyNnB4IHJnYmEoMiw2LDIzLDAuNTUpOwogICAgfQogICAgLm11c2ljLWNhcmQtaGVhZGVyIHsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAgZ2FwOiAxMHB4OwogICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgfQogICAgLm11c2ljLXRodW1iIHsKICAgICAgd2lkdGg6IDUycHg7CiAgICAgIGhlaWdodDogNTJweDsKICAgICAgYm9yZGVyLXJhZGl1czogMTJweDsKICAgICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgcmdiYSg1NiwxODksMjQ4LDAuMjgpLCByZ2JhKDE2OCw4NSwyNDcsMC4yOCkpOwogICAgICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDE0OCwxNjMsMTg0LDAuMyk7CiAgICAgIGZsZXg6IDAgMCBhdXRvOwogICAgICBvdmVyZmxvdzogaGlkZGVuOwogICAgICBkaXNwbGF5OiBncmlkOwogICAgICBwbGFjZS1pdGVtczogY2VudGVyOwogICAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7CiAgICAgIGZvbnQtc2l6ZTogMC43NXJlbTsKICAgICAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTsKICAgICAgbGV0dGVyLXNwYWNpbmc6IDAuMDhlbTsKICAgIH0KICAgIC5tdXNpYy10aHVtYiBpbWcgewogICAgICB3aWR0aDogMTAwJTsKICAgICAgaGVpZ2h0OiAxMDAlOwogICAgICBvYmplY3QtZml0OiBjb3ZlcjsKICAgICAgZGlzcGxheTogYmxvY2s7CiAgICB9CiAgICAubXVzaWMtbWV0YSB7CiAgICAgIG1pbi13aWR0aDogMDsKICAgIH0KICAgIC5tdXNpYy10aXRsZSB7CiAgICAgIGZvbnQtd2VpZ2h0OiA3MDA7CiAgICAgIGZvbnQtc2l6ZTogMC45NXJlbTsKICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDsKICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7CiAgICB9CiAgICAubXVzaWMtYXJ0aXN0IHsKICAgICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOwogICAgICBmb250LXNpemU6IDAuOHJlbTsKICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDsKICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7CiAgICB9CiAgICAubXVzaWMtYWN0aW9ucyB7CiAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgIGdhcDogOHB4OwogICAgICBmbGV4LXdyYXA6IHdyYXA7CiAgICB9CiAgICAubXVzaWMtYnRuIHsKICAgICAgcGFkZGluZzogNnB4IDEwcHg7CiAgICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7CiAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHJnYmEoMTQ4LDE2MywxODQsMC4zNSk7CiAgICAgIGJhY2tncm91bmQ6IHJnYmEoMTUsMjMsNDIsMC44NSk7CiAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LW1haW4pOwogICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgIGZvbnQtc2l6ZTogMC44cmVtOwogICAgICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kIDAuMTVzIGVhc2UsIHRyYW5zZm9ybSAwLjEycyBlYXNlOwogICAgfQogICAgLm11c2ljLWJ0bjpob3ZlciB7CiAgICAgIGJhY2tncm91bmQ6IHJnYmEoNTYsMTg5LDI0OCwwLjEpOwogICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTFweCk7CiAgICB9CiAgICAubXVzaWMtYnRuLnByaW1hcnkgewogICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCB2YXIoLS1hY2NlbnQpLCB2YXIoLS1hY2NlbnQtMikpOwogICAgICBjb2xvcjogIzAyMDYxNzsKICAgICAgYm9yZGVyOiBub25lOwogICAgICBmb250LXdlaWdodDogNzAwOwogICAgfQogICAgLm11c2ljLWZpZWxkIHsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAgZ2FwOiAxMHB4OwogICAgICBmbGV4LXdyYXA6IHdyYXA7CiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICB9CiAgICAubXVzaWMtZmllbGQgaW5wdXQgewogICAgICBmbGV4OiAxOwogICAgICBtaW4td2lkdGg6IDIyMHB4OwogICAgICBwYWRkaW5nOiAwLjY1cmVtIDAuOXJlbTsKICAgICAgYm9yZGVyLXJhZGl1czogMTJweDsKICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgxNDgsMTYzLDE4NCwwLjM1KTsKICAgICAgYmFja2dyb3VuZDogcmdiYSgxNSwyMyw0MiwwLjg1KTsKICAgICAgY29sb3I6IHZhcigtLXRleHQtbWFpbik7CiAgICAgIGZvbnQtc2l6ZTogMC45cmVtOwogICAgfQogICAgLm11c2ljLXN1YiB7CiAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsKICAgICAgZm9udC1zaXplOiAwLjgycmVtOwogICAgfQogICAgLm11c2ljLWVtcHR5IHsKICAgICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOwogICAgICBmb250LXNpemU6IDAuODVyZW07CiAgICAgIGJvcmRlcjogMXB4IGRhc2hlZCByZ2JhKDE0OCwxNjMsMTg0LDAuMyk7CiAgICAgIGJvcmRlci1yYWRpdXM6IDEycHg7CiAgICAgIHBhZGRpbmc6IDEycHg7CiAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgIH0KICAgIEBtZWRpYSAobWF4LXdpZHRoOiA3ODBweCkgewogICAgICAubXVzaWMtaGVybyB7IGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyOyB9CiAgICB9CiAgLyogR2xvYmFsIHRvcCBzZWFyY2ggKi8KLmdsb2JhbC1zZWFyY2ggewogIHBvc2l0aW9uOiByZWxhdGl2ZTsKICB3aWR0aDogbWluKDQyMHB4LCA0MHZ3KTsKICBtYXgtd2lkdGg6IDEwMCU7Cn0KLmdsb2JhbC1zZWFyY2ggaW5wdXQgewogIHdpZHRoOiAxMDAlOwogIHBhZGRpbmc6IDAuNnJlbSAyLjRyZW0gMC42cmVtIDAuOXJlbTsKICBib3JkZXItcmFkaXVzOiA5OTlweDsKICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDE0OCwxNjMsMTg0LDAuNCk7CiAgYmFja2dyb3VuZDogcmdiYSgxNSwyMyw0MiwwLjg1KTsKICBjb2xvcjogdmFyKC0tdGV4dC1tYWluKTsKICBmb250LXNpemU6IDAuODVyZW07CiAgb3V0bGluZTogbm9uZTsKfQouZ2xvYmFsLXNlYXJjaCBidXR0b24gewogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICByaWdodDogMC40cmVtOwogIHRvcDogNTAlOwogIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtNTAlKTsKICB3aWR0aDogMzRweDsKICBoZWlnaHQ6IDM0cHg7CiAgYm9yZGVyLXJhZGl1czogOTk5cHg7CiAgYm9yZGVyOiBub25lOwogIGN1cnNvcjogcG9pbnRlcjsKICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCB2YXIoLS1hY2NlbnQpLCB2YXIoLS1hY2NlbnQtMikpOwogIGNvbG9yOiAjMDIwNjE3OwogIGZvbnQtd2VpZ2h0OiA4MDA7CiAgZGlzcGxheTogZ3JpZDsKICBwbGFjZS1pdGVtczogY2VudGVyOwogIGJveC1zaGFkb3c6IDAgMTBweCAyNXB4IHJnYmEoNTYsMTg5LDI0OCwwLjI1KTsKfQpAbWVkaWEgKG1heC13aWR0aDogNzgwcHgpIHsKICAubWFpbi1oZWFkZXIgeyBmbGV4LXdyYXA6IHdyYXA7IH0KICAuZ2xvYmFsLXNlYXJjaCB7IHdpZHRoOiAxMDAlOyBvcmRlcjogMzsgfQp9CiAgPC9zdHlsZT4KCjxzdHlsZT4KLyogPT09PT0gR2FsYXh5IExvdW5nZSBhcHAgbW9kZSAoZW1iZWQpID09PT09ICovCmh0bWwuYXBwLW1vZGUsIGh0bWwuYXBwLW1vZGUgYm9keXsKICBoZWlnaHQ6MTAwJTsKICB3aWR0aDoxMDAlOwogIG1hcmdpbjowICFpbXBvcnRhbnQ7CiAgcGFkZGluZzowICFpbXBvcnRhbnQ7Cn0KaHRtbC5hcHAtbW9kZSBib2R5ewogIG92ZXJmbG93OmhpZGRlbiAhaW1wb3J0YW50OwogIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50ICFpbXBvcnRhbnQ7Cn0KaHRtbC5hcHAtbW9kZSAqeyBib3gtc2l6aW5nOmJvcmRlci1ib3g7IH0KCi8qIEhpZGUgT05MWSBsYXVuY2hlciBjaHJvbWUgKi8KaHRtbC5hcHAtbW9kZSAuc2lkZWJhciwKaHRtbC5hcHAtbW9kZSAubWFpbi1oZWFkZXIsCmh0bWwuYXBwLW1vZGUgLnRvcC10YWJzLApodG1sLmFwcC1tb2RlIC5nbG9iYWwtc2VhcmNoewogIGRpc3BsYXk6bm9uZSAhaW1wb3J0YW50Owp9CgovKiBNYWtlIHRoZSBjb250ZW50IHJlZ2lvbiBmaWxsIHRoZSBpZnJhbWUgKi8KaHRtbC5hcHAtbW9kZSAuYXBwLXNoZWxsewogIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyICFpbXBvcnRhbnQ7CiAgZ2FwOiAwICFpbXBvcnRhbnQ7CiAgcGFkZGluZzogMCAhaW1wb3J0YW50OwogIGhlaWdodDogMTAwdmggIWltcG9ydGFudDsKICBtaW4taGVpZ2h0OiAxMDB2aCAhaW1wb3J0YW50Owp9Cmh0bWwuYXBwLW1vZGUgLm1haW57CiAgcGFkZGluZzogMCAhaW1wb3J0YW50OyAgICAgICAgICAvKiBrZXk6IHJlbW92ZSBpbm5lciBwYWRkaW5nIHNvIGl0IGZpbGxzICovCiAgaGVpZ2h0OiAxMDB2aCAhaW1wb3J0YW50OwogIG1pbi1oZWlnaHQ6IDEwMHZoICFpbXBvcnRhbnQ7Cn0KaHRtbC5hcHAtbW9kZSAucGFuZWwtc2hlbGx7CiAgaGVpZ2h0OiAxMDB2aCAhaW1wb3J0YW50OyAgICAgICAgLyoga2V5OiBtYXRjaCB2aWV3cG9ydCAqLwogIG1pbi1oZWlnaHQ6IDEwMHZoICFpbXBvcnRhbnQ7CiAgYm9yZGVyLXJhZGl1czogMCAhaW1wb3J0YW50OwogIG92ZXJmbG93OiBhdXRvICFpbXBvcnRhbnQ7CiAgb3ZlcmZsb3cteDogaGlkZGVuICFpbXBvcnRhbnQ7CiAgcGFkZGluZzogMTRweCAhaW1wb3J0YW50OyAgICAgICAgLyoga2VlcCBzbWFsbCBpbnRlcm5hbCBwYWRkaW5nICovCn0KCi8qIFN0b3AgaG9yaXpvbnRhbCBzY3JvbGwgc291cmNlcyAqLwpodG1sLmFwcC1tb2RlIGJvZHksCmh0bWwuYXBwLW1vZGUgLmFwcC1zaGVsbCwKaHRtbC5hcHAtbW9kZSAubWFpbiwKaHRtbC5hcHAtbW9kZSAucGFuZWwtc2hlbGx7CiAgb3ZlcmZsb3cteDogaGlkZGVuICFpbXBvcnRhbnQ7Cn0KPC9zdHlsZT4KPHN0eWxlPgoKLyogPT09IEZPUkNFIEZVTEwgSEVJR0hUIFdIRU4gRU1CRURERUQgKHBhdGNoZWQpID09PSAqLwpodG1sLmFwcC1tb2RlIC50YWItcGFuZWxbZGF0YS10YWI9ImdhbWVzIl0sCmh0bWwuYXBwLW1vZGUgLnRhYi1wYW5lbFtkYXRhLXRhYj0ibXVzaWMiXXsKICBoZWlnaHQ6IDEwMCUgIWltcG9ydGFudDsKICBtYXgtaGVpZ2h0OiBub25lICFpbXBvcnRhbnQ7Cn0KaHRtbC5hcHAtbW9kZSAucGFuZWwtc2hlbGwsCmh0bWwuYXBwLW1vZGUgLm1haW4sCmh0bWwuYXBwLW1vZGUgLmFwcC1zaGVsbHsKICBoZWlnaHQ6IDEwMCUgIWltcG9ydGFudDsKICBtaW4taGVpZ2h0OiAxMDAlICFpbXBvcnRhbnQ7CiAgZmxleDogMSAxIGF1dG8gIWltcG9ydGFudDsKfQpodG1sLmFwcC1tb2RlIGJvZHl7CiAgaGVpZ2h0OiAxMDAlICFpbXBvcnRhbnQ7Cn0KCjwvc3R5bGU+CjwvaGVhZD4KCjxib2R5Pgo8c2NyaXB0PgooZnVuY3Rpb24oKXsKICAvLyBBcHAtbW9kZSBpcyB3aGVuIGVtYmVkZGVkIGluIEdhbGF4eSBMb3VuZ2UgKGlmcmFtZSkuCiAgaWYod2luZG93LnNlbGYgIT09IHdpbmRvdy50b3ApewogICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsYXNzTGlzdC5hZGQoImFwcC1tb2RlIik7CiAgfQp9KSgpOwo8L3NjcmlwdD4KCiAgPGRpdiBjbGFzcz0iYXBwLXNoZWxsIj4KICAgIDxhc2lkZSBjbGFzcz0ic2lkZWJhciI+CiAgICAgIDxkaXYgY2xhc3M9ImxvZ28tY2lyY2xlIj5HWDwvZGl2PgogICAgICA8bmF2IGNsYXNzPSJzaWRlLW5hdiI+CiAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYWN0aXZlIiBkYXRhLXRhYi10YXJnZXQ9ImhvbWUiIHRpdGxlPSJIb21lIj7wn4+gPC9idXR0b24+CiAgICAgICAgPGJ1dHRvbiBkYXRhLXRhYi10YXJnZXQ9ImdhbWVzIiB0aXRsZT0iR2FtZXMiPvCfjq48L2J1dHRvbj4KICAgICAgICA8YnV0dG9uIGRhdGEtdGFiLXRhcmdldD0ic291bmRib2FyZCIgdGl0bGU9IlNvdW5kIEJvYXJkIj7wn5SKPC9idXR0b24+CiAgICAgICAgPGJ1dHRvbiBkYXRhLXRhYi10YXJnZXQ9Im11c2ljIiB0aXRsZT0iTXVzaWMiPvCfjrU8L2J1dHRvbj4KICAgICAgICA8YnV0dG9uIGRhdGEtdGFiLXRhcmdldD0idGVsZXZpc2lvbiIgdGl0bGU9IlRWIj7wn5O6PC9idXR0b24+CiAgICAgICAgPGJ1dHRvbiBkYXRhLXRhYi10YXJnZXQ9ImFib3V0IiB0aXRsZT0iQWJvdXQiPuKEue+4jzwvYnV0dG9uPgogICAgICA8L25hdj4KICAgICAgPGRpdiBjbGFzcz0ic2lkZS1jbG9jayI+CiAgICAgICAgPGRpdiBpZD0ic3lzdGVtLWNsb2NrLXRpbWUiIGNsYXNzPSJzaWRlLWNsb2NrLXRpbWUiPjwvZGl2PgogICAgICAgIDxkaXYgaWQ9InN5c3RlbS1jbG9jay1kYXRlIiBjbGFzcz0ic2lkZS1jbG9jay1kYXRlIj48L2Rpdj4KICAgICAgPC9kaXY+CiAgICA8L2FzaWRlPgogICAgPG1haW4gY2xhc3M9Im1haW4iPgogICAgICA8ZGl2IGNsYXNzPSJtYWluLWhlYWRlciI+CiAgICAgICAgPGRpdiBjbGFzcz0iYnJhbmQtYmxvY2siPgogICAgICAgICAgPGRpdiBjbGFzcz0iYnJhbmQtdGl0bGUiPkdhbGF4eSBHYW1lczwvZGl2PgogICAgICAgICAgPGRpdiBjbGFzcz0iYnJhbmQtc3VidGl0bGUiPkxhdW5jaCB1bmJsb2NrZWQgZ2FtZXMgaW4gYSBzaW5nbGUgY2xlYW4gZGFzaGJvYXJkLjwvZGl2PgogICAgICAgICAgPGRpdiBjbGFzcz0icGlsbC1yb3ciPgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJwaWxsIj5GYXN0IGxhdW5jaDwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJwaWxsIj5GdWxsLXNjcmVlbiBvdmVybGF5PC9kaXY+CiAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSJ0b3AtdGFicyI+CiAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJhY3RpdmUiIGRhdGEtdGFiLXRhcmdldD0iaG9tZSI+8J+PoCBIb21lPC9idXR0b24+CiAgICAgICAgICA8YnV0dG9uIGRhdGEtdGFiLXRhcmdldD0iZ2FtZXMiPvCfjq4gR2FtZXM8L2J1dHRvbj4KICAgICAgICAgIDxidXR0b24gZGF0YS10YWItdGFyZ2V0PSJzb3VuZGJvYXJkIj7wn5SKIFNvdW5kPC9idXR0b24+CiAgICAgICAgICA8YnV0dG9uIGRhdGEtdGFiLXRhcmdldD0ibXVzaWMiPvCfjrUgTXVzaWM8L2J1dHRvbj4KICAgICAgICAgIDxidXR0b24gZGF0YS10YWItdGFyZ2V0PSJ0ZWxldmlzaW9uIj7wn5O6IFRWPC9idXR0b24+CiAgICAgICAgICA8YnV0dG9uIGRhdGEtdGFiLXRhcmdldD0iYWJvdXQiPuKEue+4jyBBYm91dDwvYnV0dG9uPgogICAgICAgIDwvZGl2PgoKPGRpdiBjbGFzcz0iZ2xvYmFsLXNlYXJjaCIgdGl0bGU9IlNlYXJjaCB0aGUgY3VycmVudCB0YWIiPgogIDxpbnB1dCBpZD0iZ2xvYmFsLXNlYXJjaCIgdHlwZT0idGV4dCIgcGxhY2Vob2xkZXI9IlNlYXJjaCBnYW1lcyBvciBtdXNpYy4uLiIgLz4KICA8YnV0dG9uIGlkPSJnbG9iYWwtc2VhcmNoLWJ0biIgYXJpYS1sYWJlbD0iU2VhcmNoIj7wn5SOPC9idXR0b24+CjwvZGl2PgogICAgICA8L2Rpdj4KICAgICAgPGRpdiBjbGFzcz0icGFuZWwtc2hlbGwiPgogICAgICAgIDwhLS0gSG9tZSAtLT4KICAgICAgICA8c2VjdGlvbiBjbGFzcz0idGFiLXBhbmVsIGFjdGl2ZSIgZGF0YS10YWI9ImhvbWUiPgogICAgICAgICAgPGRpdiBjbGFzcz0iaGVybyI+CiAgICAgICAgICAgIDxkaXY+CiAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iaGVyby10aXRsZSI+V2VsY29tZSB0byA8c3BhbiBjbGFzcz0iYWNjZW50Ij5HYWxheHkgR2FtZXM8L3NwYW4+PC9kaXY+CiAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iaGVyby1zdWIiPkJyb3dzZSBhIGN1cmF0ZWQgbGlzdCBvZiB3ZWIgZ2FtZXMgYW5kIGxhdW5jaCB0aGVtIGluIGEgZGlzdHJhY3Rpb24tZnJlZSBvdmVybGF5LjwvZGl2PgogICAgICAgICAgICAgIDxkaXYgY2xhc3M9Imhlcm8tYWN0aW9ucyI+CiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4tcHJpbWFyeSIgaWQ9ImhvbWUtc3RhcnQtYnRuIj5TdGFydCBwbGF5aW5nPC9idXR0b24+CiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4tZ2hvc3QiIGRhdGEtdGFiLWp1bXA9ImdhbWVzIj5WaWV3IGFsbCBnYW1lczwvYnV0dG9uPgogICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0iaGVyby1jYXJkIj4KICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJoZXJvLWNhcmQtdGh1bWIiPjwvZGl2PgogICAgICAgICAgICAgIDxkaXYgY2xhc3M9Imhlcm8tY2FyZC10aXRsZSI+RmVhdHVyZWQ6IExhbWJvcmdoaW5pIFNwcmludDwvZGl2PgogICAgICAgICAgICAgIDxkaXYgY2xhc3M9Imhlcm8tY2FyZC1tZXRhIj4KICAgICAgICAgICAgICAgIDxzcGFuPkFyY2FkZSDigKIgSGlnaCBzY29yZSBjaGFzZTwvc3Bhbj4KICAgICAgICAgICAgICAgIDxzcGFuPkluc3RhbnQgbG9hZCB2aWEgb3ZlcmxheTwvc3Bhbj4KICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L3NlY3Rpb24+CgogICAgICAgIAo8IS0tIEdsb2JhbCBTZWFyY2ggLS0+CjxzY3JpcHQ+CiAgKGZ1bmN0aW9uKCkgewogICAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZ2xvYmFsLXNlYXJjaCIpOwogICAgY29uc3QgYnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImdsb2JhbC1zZWFyY2gtYnRuIik7CgogICAgZnVuY3Rpb24gZ2V0QWN0aXZlVGFiKCkgewogICAgICByZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtdGFiXS5hY3RpdmUnKT8uZGF0YXNldC50YWIgfHwgImhvbWUiOwogICAgfQoKICAgIGZ1bmN0aW9uIHJ1bigpIHsKICAgICAgY29uc3QgcSA9IChpbnB1dD8udmFsdWUgfHwgIiIpLnRyaW0oKTsKICAgICAgaWYgKCFxKSByZXR1cm47CgogICAgICBjb25zdCB0YWIgPSBnZXRBY3RpdmVUYWIoKTsKCiAgICAgIGlmICh0YWIgPT09ICJnYW1lcyIpIHsKICAgICAgICBjb25zdCBnYW1lU2VhcmNoID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImdhbWUtc2VhcmNoIik7CiAgICAgICAgaWYgKGdhbWVTZWFyY2gpIHsKICAgICAgICAgIGdhbWVTZWFyY2gudmFsdWUgPSBxOwogICAgICAgICAgZ2FtZVNlYXJjaC5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgiaW5wdXQiLCB7IGJ1YmJsZXM6IHRydWUgfSkpOwogICAgICAgICAgZ2FtZVNlYXJjaC5mb2N1cygpOwogICAgICAgIH0KICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0YWIgPT09ICJtdXNpYyIpIHsKICAgICAgICBjb25zdCBtdXNpY1NlYXJjaCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtdXNpYy1zZWFyY2giKTsKICAgICAgICBjb25zdCBtdXNpY0J0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtdXNpYy1zZWFyY2gtYnRuIik7CiAgICAgICAgaWYgKG11c2ljU2VhcmNoKSBtdXNpY1NlYXJjaC52YWx1ZSA9IHE7CiAgICAgICAgbXVzaWNCdG4/LmNsaWNrKCk7CiAgICAgICAgbXVzaWNTZWFyY2g/LmZvY3VzKCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICAvLyBDb252ZW5pZW5jZTogaWYgeW91J3JlIG5vdCBvbiBHYW1lcy9NdXNpYywganVtcCB0byBNdXNpYyBieSBkZWZhdWx0LgogICAgICBjb25zdCBqdW1wTXVzaWMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS10YWItdGFyZ2V0PSJtdXNpYyJdJyk7CiAgICAgIGp1bXBNdXNpYz8uY2xpY2soKTsKICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgY29uc3QgbXVzaWNTZWFyY2ggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibXVzaWMtc2VhcmNoIik7CiAgICAgICAgY29uc3QgbXVzaWNCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibXVzaWMtc2VhcmNoLWJ0biIpOwogICAgICAgIGlmIChtdXNpY1NlYXJjaCkgbXVzaWNTZWFyY2gudmFsdWUgPSBxOwogICAgICAgIG11c2ljQnRuPy5jbGljaygpOwogICAgICAgIG11c2ljU2VhcmNoPy5mb2N1cygpOwogICAgICB9LCAwKTsKICAgIH0KCiAgICBidG4/LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgcnVuKTsKICAgIGlucHV0Py5hZGRFdmVudExpc3RlbmVyKCJrZXlkb3duIiwgKGUpID0+IHsgaWYgKGUua2V5ID09PSAiRW50ZXIiKSBydW4oKTsgfSk7CgogICAgLy8gS2VlcCBwbGFjZWhvbGRlciBhbGlnbmVkIHdpdGggdGhlIGFjdGl2ZSB0YWIuCiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIChlKSA9PiB7CiAgICAgIGNvbnN0IHRhYkJ0biA9IGUudGFyZ2V0LmNsb3Nlc3QoIltkYXRhLXRhYi10YXJnZXRdIik7CiAgICAgIGlmICghdGFiQnRuIHx8ICFpbnB1dCkgcmV0dXJuOwogICAgICBjb25zdCB0ID0gdGFiQnRuLmRhdGFzZXQudGFiVGFyZ2V0OwogICAgICBpbnB1dC5wbGFjZWhvbGRlciA9IHQgPT09ICJnYW1lcyIKICAgICAgICA/ICJTZWFyY2ggZ2FtZXMuLi4iCiAgICAgICAgOiB0ID09PSAibXVzaWMiCiAgICAgICAgICA/ICJTZWFyY2ggaVR1bmVzLi4uIgogICAgICAgICAgOiAiU2VhcmNoIGdhbWVzIG9yIG11c2ljLi4uIjsKICAgIH0pOwogIH0pKCk7Cjwvc2NyaXB0PgoKICA8IS0tIEdhbWVzIC0tPgogICAgICAgIDxzZWN0aW9uIGNsYXNzPSJ0YWItcGFuZWwiIGRhdGEtdGFiPSJnYW1lcyI+CiAgICAgICAgICA8ZGl2IGNsYXNzPSJnYW1lcy1oZWFkZXItcm93Ij4KICAgICAgICAgICAgPGRpdj4KICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJnYW1lcy10aXRsZSI+QWxsIGdhbWVzPC9kaXY+CiAgICAgICAgICAgICAgPGRpdiBzdHlsZT0iZm9udC1zaXplOiAwLjhyZW07IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsiPlNlYXJjaCB0aGUgZmVlZCBhbmQgY2xpY2sgYW55IHRpbGUgdG8gbGF1bmNoLjwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0ic2VhcmNoLWJhciI+CiAgICAgICAgICAgICAgPGlucHV0IGlkPSJnYW1lLXNlYXJjaCIgdHlwZT0idGV4dCIgcGxhY2Vob2xkZXI9IlNlYXJjaCBnYW1lcy4uLiIgLz4KICAgICAgICAgICAgICA8c3Bhbj7wn5SNPC9zcGFuPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIDwvZGl2PgogICAgICAgICAgPGRpdiBjbGFzcz0iZ2FtZS1saXN0IiBpZD0iZ2FtZS1saXN0Ij48L2Rpdj4KICAgICAgICA8L3NlY3Rpb24+CgogICAgICAgIDwhLS0gU291bmRib2FyZCAtLT4KICAgICAgICA8c2VjdGlvbiBjbGFzcz0idGFiLXBhbmVsIiBkYXRhLXRhYj0ic291bmRib2FyZCI+CiAgICAgICAgICA8ZGl2IGNsYXNzPSJnYW1lcy10aXRsZSI+U291bmQgQm9hcmQ8L2Rpdj4KICAgICAgICAgIDxkaXYgc3R5bGU9ImZvbnQtc2l6ZTogMC44cmVtOyBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7IG1hcmdpbi1ib3R0b206IDZweDsiPlRhcCBhIHBhZCBmb3IgaW5zdGFudCBhcmNhZGUgc291bmRzLjwvZGl2PgogICAgICAgICAgPGRpdiBpZD0ic291bmRib2FyZC1ncmlkIiBjbGFzcz0ic291bmRib2FyZC1ncmlkIj48L2Rpdj4KICAgICAgICA8L3NlY3Rpb24+CgogICAgICAgIDwhLS0gTXVzaWMgLS0+CiAgICAgICAgPHNlY3Rpb24gY2xhc3M9InRhYi1wYW5lbCIgZGF0YS10YWI9Im11c2ljIj4KICAgICAgICAgIDxkaXYgY2xhc3M9Im11c2ljLWhlcm8iPgogICAgICAgICAgICA8ZGl2PgogICAgICAgICAgICAgIDxoMj5HYWxheHkgTXVzaWMgSHViPC9oMj4KICAgICAgICAgICAgICA8cD5TdHJlYW0gMzAtc2Vjb25kIHByZXZpZXdzIGZyb20gaVR1bmVzLiBNb250aGx5IHBpY2tzIGFuZCBzZWFyY2ggaW4gb25lIHBsYWNlLjwvcD4KICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJtdXNpYy1waWxscyI+CiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ibXVzaWMtcGlsbCI+aVR1bmVzIHNlYXJjaDwvc3Bhbj4KICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJtdXNpYy1waWxsIj5QcmV2aWV3IHNuaXBwZXRzPC9zcGFuPgogICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9Im11c2ljLXBpbGwiPk1vbnRobHkgc3BvdGxpZ2h0PC9zcGFuPgogICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0ibXVzaWMtY2FyZCI+CiAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibXVzaWMtY2FyZC1oZWFkZXIiPgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibXVzaWMtdGh1bWIiPk5PVzwvZGl2PgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibXVzaWMtbWV0YSI+CiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im11c2ljLXRpdGxlIj5Nb250aGx5IFNwb3RsaWdodDwvZGl2PgogICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJtdXNpYy1hcnRpc3QiPkhhbmQtcGlja2VkIGRyb3BzIGZvciB0aGlzIG1vbnRoPC9kaXY+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJtdXNpYy1hY3Rpb25zIj4KICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9Im11c2ljLWJ0biBwcmltYXJ5IiBpZD0ibXVzaWMtcmVmcmVzaCI+UmVmcmVzaCBwaWNrczwvYnV0dG9uPgogICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIDwvZGl2PgogICAgICAgICAgPGRpdiBzdHlsZT0iZGlzcGxheTpmbGV4OyBqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2VlbjsgYWxpZ24taXRlbXM6Y2VudGVyOyBnYXA6MTBweDsgZmxleC13cmFwOndyYXA7IG1hcmdpbi10b3A6MTJweDsiPgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJnYW1lcy10aXRsZSI+TW9udGhseSBzb25nczwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJtdXNpYy1zdWIiPkRhcmsgVGhvdWdodHMgwrcgTW9udGFnZW0gUmVib2xhIMK3IFJhbnNvbSDCtyBIZWFkc2hvdDwvZGl2PgogICAgICAgICAgPC9kaXY+CiAgICAgICAgICA8ZGl2IGNsYXNzPSJtdXNpYy1ncmlkIiBpZD0ibXVzaWMtbW9udGhseSI+PC9kaXY+CiAgICAgICAgICA8ZGl2IHN0eWxlPSJtYXJnaW4tdG9wOjE4cHg7Ij4KICAgICAgICAgICAgPGRpdiBjbGFzcz0iZ2FtZXMtdGl0bGUiPlNlYXJjaCBpVHVuZXM8L2Rpdj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0ibXVzaWMtZmllbGQiIHN0eWxlPSJtYXJnaW4tdG9wOjZweDsiPgogICAgICAgICAgICAgIDxpbnB1dCBpZD0ibXVzaWMtc2VhcmNoIiB0eXBlPSJ0ZXh0IiBwbGFjZWhvbGRlcj0iU2VhcmNoIGlUdW5lcyAoZS5nLiwgTGlsIFRlY2NhKSIgLz4KICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJtdXNpYy1idG4gcHJpbWFyeSIgaWQ9Im11c2ljLXNlYXJjaC1idG4iPlNlYXJjaDwvYnV0dG9uPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIDwvZGl2PgogICAgICAgICAgPGRpdiBjbGFzcz0ibXVzaWMtZ3JpZCIgaWQ9Im11c2ljLXJlc3VsdHMiIHN0eWxlPSJtYXJnaW4tdG9wOjEycHg7Ij48L2Rpdj4KICAgICAgICAgIDxkaXYgY2xhc3M9Im11c2ljLWVtcHR5IiBpZD0ibXVzaWMtZW1wdHkiIHN0eWxlPSJkaXNwbGF5Om5vbmU7Ij5ObyBzb25ncyB5ZXQuIFRyeSBhIHNlYXJjaC48L2Rpdj4KICAgICAgICA8L3NlY3Rpb24+CgogICAgICAgIDwhLS0gVFYgLS0+CiAgICAgICAgPHNlY3Rpb24gY2xhc3M9InRhYi1wYW5lbCIgZGF0YS10YWI9InRlbGV2aXNpb24iPgogICAgICAgICAgPGRpdiBjbGFzcz0iZ2FtZXMtdGl0bGUiPlRlbGV2aXNpb248L2Rpdj4KICAgICAgICAgIDxkaXYgc3R5bGU9ImRpc3BsYXk6Z3JpZDtncmlkLXRlbXBsYXRlLWNvbHVtbnM6cmVwZWF0KGF1dG8tZml0LG1pbm1heCg0MjBweCwxZnIpKTtnYXA6MTZweDsiPgogICAgICAgICAgICA8ZGl2PgogICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImZvbnQtd2VpZ2h0OjYwMDttYXJnaW4tYm90dG9tOjZweDsiPkRpc25leTwvZGl2PgogICAgICAgICAgICAgIDxpZnJhbWUgc3JjPSJodHRwczovL2RvY3MuZ29vZ2xlLmNvbS9wcmVzZW50YXRpb24vZC8xY3FNb1M3ck52T1g3NzkzOEd1c2RXTmk2bVlWUE9mRVRDVnNBVlc5STlwcy9wcmV2aWV3P3NsaWRlPWlkLmcyY2FhMTgwNGYxZl8wXzcxIiBzdHlsZT0id2lkdGg6MTAwJTtoZWlnaHQ6MzIwcHg7Ym9yZGVyLXJhZGl1czoxNHB4O2JvcmRlcjoxcHggc29saWQgcmdiYSgxNDgsMTYzLDE4NCwwLjIpOyIgYWxsb3dmdWxsc2NyZWVuPjwvaWZyYW1lPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPGRpdj4KICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJmb250LXdlaWdodDo2MDA7bWFyZ2luLWJvdHRvbTo2cHg7Ij5QYXJhbW91bnQ8L2Rpdj4KICAgICAgICAgICAgICA8aWZyYW1lIHNyYz0iaHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vcHJlc2VudGF0aW9uL2QvMUNpWk1kQm02NzdNN0VJdXM3Z1Q4OVdQeHdZUHpYSlFnd21YR3Yzc0xBYXcvcHJldmlldz9zbGlkZT1pZC5nMWI3MWY4YmRiM2NfMl83NyIgc3R5bGU9IndpZHRoOjEwMCU7aGVpZ2h0OjMyMHB4O2JvcmRlci1yYWRpdXM6MTRweDtib3JkZXI6MXB4IHNvbGlkIHJnYmEoMTQ4LDE2MywxODQsMC4yKTsiIGFsbG93ZnVsbHNjcmVlbj48L2lmcmFtZT4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L3NlY3Rpb24+CgogICAgICAgIDwhLS0gQWJvdXQgLS0+CiAgICAgICAgPHNlY3Rpb24gY2xhc3M9InRhYi1wYW5lbCIgZGF0YS10YWI9ImFib3V0Ij4KICAgICAgICAgIDxkaXYgY2xhc3M9ImdhbWVzLXRpdGxlIj5BYm91dCB0aGlzIGxhdW5jaGVyPC9kaXY+CiAgICAgICAgICA8ZGl2IGNsYXNzPSJhYm91dC10ZXh0Ij4KICAgICAgICAgICAgR2FsYXh5IEdhbWVzIGxvYWRzIGdhbWVzIGZyb20gYSBwdWJsaWMgSlNPTiBmZWVkIGFuZCBwbGF5cyBpVHVuZXMgcHJldmlld3MuIEV2ZXJ5dGhpbmcgcnVucyBpbiB5b3VyIGJyb3dzZXIg4oCUIG5vIGFjY291bnRzLCBubyB0cmFja2luZy4KICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvc2VjdGlvbj4KICAgICAgPC9kaXY+CiAgICA8L21haW4+CiAgPC9kaXY+CgogIDwhLS0gVGFiIFN5c3RlbSAtLT4KICA8c2NyaXB0PgogICAgKGZ1bmN0aW9uKCkgewogICAgICBmdW5jdGlvbiBzZXRBY3RpdmUodGFiKSB7CiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtdGFiXScpLmZvckVhY2gocCA9PiBwLmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScsIHAuZGF0YXNldC50YWIgPT09IHRhYikpOwogICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLXRhYi10YXJnZXRdJykuZm9yRWFjaChiID0+IGIuY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJywgYi5kYXRhc2V0LnRhYlRhcmdldCA9PT0gdGFiKSk7CiAgICAgIH0KICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHsKICAgICAgICBjb25zdCBidG4gPSBlLnRhcmdldC5jbG9zZXN0KCdbZGF0YS10YWItdGFyZ2V0XScpOwogICAgICAgIGlmIChidG4pIHNldEFjdGl2ZShidG4uZGF0YXNldC50YWJUYXJnZXQpOwogICAgICAgIGNvbnN0IGp1bXAgPSBlLnRhcmdldC5jbG9zZXN0KCdbZGF0YS10YWItanVtcF0nKTsKICAgICAgICBpZiAoanVtcCkgc2V0QWN0aXZlKGp1bXAuZGF0YXNldC50YWJKdW1wKTsKICAgICAgfSk7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdob21lLXN0YXJ0LWJ0bicpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICBzZXRBY3RpdmUoJ2dhbWVzJyk7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dhbWUtc2VhcmNoJyk/LmZvY3VzKCk7CiAgICAgIH0pOwogICAgfSkoKTsKICA8L3NjcmlwdD4KCiAgPCEtLSBHYW1lcyAtLT4KICA8c2NyaXB0PgogICAgKGZ1bmN0aW9uKCkgewogICAgICBjb25zdCBaT05FU19VUkwgPSAiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL05vdHJleGVkL2Fzc2V0c0BsYXRlc3QvYWxsem9uZS5qc29uIjsKICAgICAgY29uc3QgQ09WRVJfVVJMID0gImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9Ob3RyZXhlZC9jb3ZlcnNAbWFpbiI7CiAgICAgIGNvbnN0IEhUTUxfVVJMID0gImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9Ob3RyZXhlZC9odG1sQGxhdGVzdCI7CiAgICAgIGNvbnN0IGdhbWVMaXN0RWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZ2FtZS1saXN0Iik7CiAgICAgIGNvbnN0IHNlYXJjaElucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImdhbWUtc2VhcmNoIik7CiAgICAgIGxldCB6b25lcyA9IFtdOwogICAgICBsZXQgZmlsdGVyZWQgPSBbXTsKCiAgICAgIGZ1bmN0aW9uIGNyZWF0ZU92ZXJsYXkoKSB7CiAgICAgICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJnYW1lLW92ZXJsYXkiKSkgcmV0dXJuOwogICAgICAgIGNvbnN0IG92ZXJsYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgICBvdmVybGF5LmlkID0gImdhbWUtb3ZlcmxheSI7CiAgICAgICAgb3ZlcmxheS5zdHlsZS5jc3NUZXh0ID0gYHBvc2l0aW9uOmZpeGVkO2luc2V0OjA7YmFja2dyb3VuZDpyZ2JhKDAsMCwwLDAuOTQpO2JhY2tkcm9wLWZpbHRlcjpibHVyKDEwcHgpO2Rpc3BsYXk6bm9uZTthbGlnbi1pdGVtczpzdHJldGNoO2p1c3RpZnktY29udGVudDpjZW50ZXI7ei1pbmRleDo5OTk5O2A7CiAgICAgICAgY29uc3QgaWZyYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiaWZyYW1lIik7CiAgICAgICAgaWZyYW1lLmlkID0gImdhbWUtZnJhbWUiOwogICAgICAgIGlmcmFtZS5zdHlsZS5jc3NUZXh0ID0gImJvcmRlcjpub25lO3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7YmFja2dyb3VuZDojMDAwOyI7CiAgICAgICAgaWZyYW1lLnNldEF0dHJpYnV0ZSgiYWxsb3ciLCAiYWNjZWxlcm9tZXRlcjsgYXV0b3BsYXk7IGZ1bGxzY3JlZW47IGNsaXBib2FyZC1yZWFkOyBjbGlwYm9hcmQtd3JpdGU7IGdhbWVwYWQ7Iik7CiAgICAgICAgaWZyYW1lLnJlZmVycmVyUG9saWN5ID0gIm5vLXJlZmVycmVyIjsKICAgICAgICBjb25zdCBjbG9zZUJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIpOwogICAgICAgIGNsb3NlQnRuLnRleHRDb250ZW50ID0gIsOXIjsKICAgICAgICBjbG9zZUJ0bi5zdHlsZS5jc3NUZXh0ID0gYHBvc2l0aW9uOmZpeGVkO3RvcDoxOHB4O3JpZ2h0OjI0cHg7d2lkdGg6MzZweDtoZWlnaHQ6MzZweDtib3JkZXItcmFkaXVzOjk5OXB4O2JvcmRlcjpub25lO2JhY2tncm91bmQ6cmdiYSgxNSwyMyw0MiwwLjg1KTtjb2xvcjojZTVlN2ViO2ZvbnQtc2l6ZToyMnB4O2N1cnNvcjpwb2ludGVyO3otaW5kZXg6MTAwMDA7YDsKICAgICAgICBjbG9zZUJ0bi5vbmNsaWNrID0gKCkgPT4gb3ZlcmxheS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICAgIG92ZXJsYXkuYXBwZW5kQ2hpbGQoaWZyYW1lKTsKICAgICAgICBvdmVybGF5LmFwcGVuZENoaWxkKGNsb3NlQnRuKTsKCiAgICAgICAgLy8gRmFsbGJhY2sgLyBEb3dubG9hZCBwYW5lbCAoc2hvd24gaWYgYSBnYW1lIGZhaWxzIHRvIGxvYWQgb3IgdXNlciB3YW50cyBhbiBvZmZsaW5lIGNvcHkpCiAgICAgICAgY29uc3QgZmFsbGJhY2sgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgICBmYWxsYmFjay5pZCA9ICJnYW1lLWZhbGxiYWNrIjsKICAgICAgICBmYWxsYmFjay5zdHlsZS5jc3NUZXh0ID0gYAogICAgICAgICAgcG9zaXRpb246Zml4ZWQ7CiAgICAgICAgICBsZWZ0OjUwJTsKICAgICAgICAgIGJvdHRvbToxOHB4OwogICAgICAgICAgdHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTUwJSk7CiAgICAgICAgICBtYXgtd2lkdGg6bWluKDcyMHB4LCBjYWxjKDEwMHZ3IC0gMjRweCkpOwogICAgICAgICAgd2lkdGg6Zml0LWNvbnRlbnQ7CiAgICAgICAgICBwYWRkaW5nOjEycHggMTRweDsKICAgICAgICAgIGJvcmRlci1yYWRpdXM6MTRweDsKICAgICAgICAgIGJvcmRlcjoxcHggc29saWQgcmdiYSgxNDgsMTYzLDE4NCwwLjM1KTsKICAgICAgICAgIGJhY2tncm91bmQ6cmdiYSgxNSwyMyw0MiwwLjkyKTsKICAgICAgICAgIGJveC1zaGFkb3c6MCAxOHB4IDYwcHggcmdiYSgwLDAsMCwwLjU1KTsKICAgICAgICAgIGRpc3BsYXk6bm9uZTsKICAgICAgICAgIHotaW5kZXg6MTAwMDE7CiAgICAgICAgYDsKICAgICAgICBmYWxsYmFjay5pbm5lckhUTUwgPSBgCiAgICAgICAgICA8ZGl2IHN0eWxlPSJkaXNwbGF5OmZsZXg7Z2FwOjEycHg7YWxpZ24taXRlbXM6Y2VudGVyO2ZsZXgtd3JhcDp3cmFwOyI+CiAgICAgICAgICAgIDxkaXYgc3R5bGU9Im1pbi13aWR0aDoyMjBweDsiPgogICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImZvbnQtd2VpZ2h0OjcwMDtmb250LXNpemU6MC45MnJlbTsiPkhhdmluZyB0cm91YmxlIGxvYWRpbmcgdGhpcyBnYW1lPzwvZGl2PgogICAgICAgICAgICAgIDxkaXYgaWQ9ImdhbWUtZmFsbGJhY2stbXNnIiBzdHlsZT0iY29sb3I6cmdiYSgxNTYsMTYzLDE3NSwwLjk1KTtmb250LXNpemU6MC44MnJlbTttYXJnaW4tdG9wOjJweDsiPgogICAgICAgICAgICAgICAgSWYgaXQgZG9lc27igJl0IHdvcmssIGRvd25sb2FkIHRoZSBIVE1MIGFuZCBvcGVuIGl0IGxvY2FsbHkuCiAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8ZGl2IHN0eWxlPSJkaXNwbGF5OmZsZXg7Z2FwOjhweDtmbGV4LXdyYXA6d3JhcDthbGlnbi1pdGVtczpjZW50ZXI7bWFyZ2luLWxlZnQ6YXV0bzsiPgogICAgICAgICAgICAgIDxidXR0b24gaWQ9ImdhbWUtZG93bmxvYWQtYnRuIiBzdHlsZT0icGFkZGluZzo4cHggMTBweDtib3JkZXItcmFkaXVzOjEycHg7Ym9yZGVyOm5vbmU7Y3Vyc29yOnBvaW50ZXI7Zm9udC13ZWlnaHQ6NzAwO2JhY2tncm91bmQ6bGluZWFyLWdyYWRpZW50KDEzNWRlZywgdmFyKC0tYWNjZW50KSwgdmFyKC0tYWNjZW50LTIpKTtjb2xvcjojMDIwNjE3OyI+CiAgICAgICAgICAgICAgICBEb3dubG9hZCBIVE1MCiAgICAgICAgICAgICAgPC9idXR0b24+CiAgICAgICAgICAgICAgPGEgaWQ9ImdhbWUtb3Blbi1zb3VyY2UiIGhyZWY9IiMiIHRhcmdldD0iX2JsYW5rIiByZWw9Im5vb3BlbmVyIiBzdHlsZT0icGFkZGluZzo4cHggMTBweDtib3JkZXItcmFkaXVzOjEycHg7Ym9yZGVyOjFweCBzb2xpZCByZ2JhKDE0OCwxNjMsMTg0LDAuMzUpO2JhY2tncm91bmQ6cmdiYSgxNSwyMyw0MiwwLjg1KTtjb2xvcjp2YXIoLS10ZXh0LW1haW4pO3RleHQtZGVjb3JhdGlvbjpub25lOyI+CiAgICAgICAgICAgICAgICBPcGVuIHNvdXJjZQogICAgICAgICAgICAgIDwvYT4KICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJnYW1lLWNsb3NlLWZhbGxiYWNrIiBzdHlsZT0icGFkZGluZzo4cHggMTBweDtib3JkZXItcmFkaXVzOjEycHg7Ym9yZGVyOjFweCBzb2xpZCByZ2JhKDE0OCwxNjMsMTg0LDAuMzUpO2JhY2tncm91bmQ6cmdiYSgxNSwyMyw0MiwwLjg1KTtjb2xvcjp2YXIoLS10ZXh0LW1haW4pO2N1cnNvcjpwb2ludGVyOyI+CiAgICAgICAgICAgICAgICBEaXNtaXNzCiAgICAgICAgICAgICAgPC9idXR0b24+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgPC9kaXY+CiAgICAgICAgYDsKICAgICAgICBmYWxsYmFjay5xdWVyeVNlbGVjdG9yKCIjZ2FtZS1jbG9zZS1mYWxsYmFjayIpLm9uY2xpY2sgPSAoKSA9PiAoZmFsbGJhY2suc3R5bGUuZGlzcGxheSA9ICJub25lIik7CiAgICAgICAgb3ZlcmxheS5hcHBlbmRDaGlsZChmYWxsYmFjayk7CiAgICAgICAgb3ZlcmxheS5vbmNsaWNrID0gZSA9PiB7IGlmIChlLnRhcmdldCA9PT0gb3ZlcmxheSkgb3ZlcmxheS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOyB9OwogICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoImtleWRvd24iLCBlID0+IHsgaWYgKGUua2V5ID09PSAiRXNjYXBlIikgb3ZlcmxheS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOyB9KTsKICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG92ZXJsYXkpOwogICAgICB9CgogICAgICBmdW5jdGlvbiBvcGVuR2FtZSh6b25lKSB7CiAgICAgICAgaWYgKCF6b25lKSByZXR1cm47CiAgICAgICAgY3JlYXRlT3ZlcmxheSgpOwogICAgICAgIGNvbnN0IG92ZXJsYXkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZ2FtZS1vdmVybGF5Iik7CiAgICAgICAgY29uc3QgaWZyYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImdhbWUtZnJhbWUiKTsKICAgICAgICBjb25zdCBmYWxsYmFjayA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJnYW1lLWZhbGxiYWNrIik7CiAgICAgICAgY29uc3QgZG93bmxvYWRCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZ2FtZS1kb3dubG9hZC1idG4iKTsKICAgICAgICBjb25zdCBvcGVuU291cmNlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImdhbWUtb3Blbi1zb3VyY2UiKTsKICAgICAgICBjb25zdCBtc2cgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZ2FtZS1mYWxsYmFjay1tc2ciKTsKCiAgICAgICAgb3ZlcmxheS5zdHlsZS5kaXNwbGF5ID0gImZsZXgiOwogICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSAiaGlkZGVuIjsKCiAgICAgICAgLy8gUmVzZXQgZmFsbGJhY2sgVUkKICAgICAgICBpZiAoZmFsbGJhY2spIGZhbGxiYWNrLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgaWYgKG1zZykgbXNnLnRleHRDb250ZW50ID0gIklmIGl0IGRvZXNu4oCZdCB3b3JrLCBkb3dubG9hZCB0aGUgSFRNTCBhbmQgb3BlbiBpdCBsb2NhbGx5LiI7CgogICAgICAgIGNvbnN0IHVybCA9ICh6b25lLnVybCB8fCAiIikucmVwbGFjZSgie0hUTUxfVVJMfSIsIEhUTUxfVVJMKS5yZXBsYWNlKCJ7Q09WRVJfVVJMfSIsIENPVkVSX1VSTCk7CiAgICAgICAgbGV0IGxhc3RIdG1sID0gIiI7CiAgICAgICAgbGV0IGxhc3RGaWxlbmFtZSA9ICh6b25lLm5hbWUgfHwgImdhbWUiKS50b1N0cmluZygpLnRyaW0oKSB8fCAiZ2FtZSI7CgogICAgICAgIC8vIFNhZmVyIGZpbGVuYW1lCiAgICAgICAgbGFzdEZpbGVuYW1lID0gbGFzdEZpbGVuYW1lCiAgICAgICAgICAucmVwbGFjZSgvW15hLXowLTlcLVxfIF0vZ2ksICIiKQogICAgICAgICAgLnJlcGxhY2UoL1xzKy9nLCAiXyIpCiAgICAgICAgICAuc2xpY2UoMCwgNjApIHx8ICJnYW1lIjsKCiAgICAgICAgZnVuY3Rpb24gZG93bmxvYWRIdG1sKGZpbGVuYW1lLCBodG1sVGV4dCkgewogICAgICAgICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtodG1sVGV4dF0sIHsgdHlwZTogInRleHQvaHRtbDtjaGFyc2V0PXV0Zi04IiB9KTsKICAgICAgICAgIGNvbnN0IGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIik7CiAgICAgICAgICBhLmhyZWYgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpOwogICAgICAgICAgYS5kb3dubG9hZCA9IGZpbGVuYW1lICsgIi5odG1sIjsKICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYSk7CiAgICAgICAgICBhLmNsaWNrKCk7CiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgVVJMLnJldm9rZU9iamVjdFVSTChhLmhyZWYpOwogICAgICAgICAgICBhLnJlbW92ZSgpOwogICAgICAgICAgfSwgMCk7CiAgICAgICAgfQoKICAgICAgICBpZiAob3BlblNvdXJjZSkgb3BlblNvdXJjZS5ocmVmID0gdXJsOwoKICAgICAgICAvLyBEb3dubG9hZCBidXR0b24gYmVoYXZpb3I6CiAgICAgICAgLy8gLSBJZiB3ZSBhbHJlYWR5IGhhdmUgdGhlIEhUTUwsIGRvd25sb2FkIGltbWVkaWF0ZWx5LgogICAgICAgIC8vIC0gT3RoZXJ3aXNlLCB0cnkgdG8gZmV0Y2ggYW5kIHRoZW4gZG93bmxvYWQuCiAgICAgICAgaWYgKGRvd25sb2FkQnRuKSB7CiAgICAgICAgICBkb3dubG9hZEJ0bi5vbmNsaWNrID0gYXN5bmMgKCkgPT4gewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGlmIChsYXN0SHRtbCkgewogICAgICAgICAgICAgICAgZG93bmxvYWRIdG1sKGxhc3RGaWxlbmFtZSwgbGFzdEh0bWwpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaCh1cmwsIHsgY2FjaGU6ICJuby1zdG9yZSIgfSk7CiAgICAgICAgICAgICAgY29uc3QgaHRtbCA9IGF3YWl0IHJlcy50ZXh0KCk7CiAgICAgICAgICAgICAgbGFzdEh0bWwgPSBodG1sOwogICAgICAgICAgICAgIGRvd25sb2FkSHRtbChsYXN0RmlsZW5hbWUsIGxhc3RIdG1sKTsKICAgICAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICAgICAgaWYgKGZhbGxiYWNrKSBmYWxsYmFjay5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgICAgICAgICBpZiAobXNnKSBtc2cudGV4dENvbnRlbnQgPSAiRG93bmxvYWQgZmFpbGVkLiBUcnkgb3BlbmluZyB0aGUgc291cmNlIGluc3RlYWQuIjsKICAgICAgICAgICAgfQogICAgICAgICAgfTsKICAgICAgICB9CgogICAgICAgIC8vIExvYWQgaW50byBpZnJhbWUgKHRpbWVvdXQgaGVscHMgZGV0ZWN0IGJsb2NrZWQgZmV0Y2hlcyAvIHNsb3cgbmV0d29ya3MpCiAgICAgICAgY29uc3QgY29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTsKICAgICAgICBjb25zdCB0aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiBjb250cm9sbGVyLmFib3J0KCksIDEyMDAwKTsKCiAgICAgICAgZmV0Y2godXJsLCB7IHNpZ25hbDogY29udHJvbGxlci5zaWduYWwsIGNhY2hlOiAibm8tc3RvcmUiIH0pCiAgICAgICAgICAudGhlbihyZXMgPT4gcmVzLnRleHQoKSkKICAgICAgICAgIC50aGVuKGh0bWwgPT4gewogICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7CiAgICAgICAgICAgIGxhc3RIdG1sID0gaHRtbDsKCiAgICAgICAgICAgIGNvbnN0IGRvYyA9IGlmcmFtZS5jb250ZW50V2luZG93LmRvY3VtZW50OwogICAgICAgICAgICBkb2Mub3BlbigpOwogICAgICAgICAgICBkb2Mud3JpdGUoaHRtbCk7CiAgICAgICAgICAgIGRvYy5jbG9zZSgpOwoKICAgICAgICAgICAgLy8gQWx3YXlzIGFsbG93IHRoZSB1c2VyIHRvIGRvd25sb2FkIGEgbG9jYWwgY29weSwgZXZlbiBpZiBpdCBsb2FkZWQuCiAgICAgICAgICAgIGlmIChmYWxsYmFjaykgZmFsbGJhY2suc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CiAgICAgICAgICB9KQogICAgICAgICAgLmNhdGNoKCgpID0+IHsKICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGlmcmFtZS5jb250ZW50V2luZG93LmRvY3VtZW50LmJvZHkuaW5uZXJIVE1MID0gIjxkaXYgc3R5bGU9J2NvbG9yOiNlNWU3ZWI7Zm9udC1mYW1pbHk6c3lzdGVtLXVpO3BhZGRpbmc6MThweDsnPkZhaWxlZCB0byBsb2FkIGdhbWUuPC9kaXY+IjsKICAgICAgICAgICAgfSBjYXRjaCB7fQogICAgICAgICAgICBpZiAoZmFsbGJhY2spIGZhbGxiYWNrLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgICAgICAgICBpZiAobXNnKSBtc2cudGV4dENvbnRlbnQgPSAiVGhpcyBnYW1lIGRpZCBub3QgbG9hZCBpbiB5b3VyIGJyb3dzZXIuIFVzZSBEb3dubG9hZCBIVE1MIG9yIE9wZW4gc291cmNlLiI7CiAgICAgICAgICB9KTsKICAgICAgfQoKCiAgICAgIGZ1bmN0aW9uIHJlbmRlcihsaXN0KSB7CiAgICAgICAgZ2FtZUxpc3RFbC5pbm5lckhUTUwgPSAiIjsKICAgICAgICBsaXN0LmZvckVhY2goeiA9PiB7CiAgICAgICAgICBpZiAoKHoubmFtZSB8fCAiIikudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygib3ZvIikgfHwgei5pZCA9PT0gLTEpIHJldHVybjsKICAgICAgICAgIGNvbnN0IGNhcmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgICAgIGNhcmQuY2xhc3NOYW1lID0gImdhbWUtY2FyZCI7CiAgICAgICAgICBjb25zdCBjb3ZlciA9ICh6LmNvdmVyIHx8ICIiKS5yZXBsYWNlKCJ7Q09WRVJfVVJMfSIsIENPVkVSX1VSTCkucmVwbGFjZSgie0hUTUxfVVJMfSIsIEhUTUxfVVJMKTsKICAgICAgICAgIGNhcmQuaW5uZXJIVE1MID0gYAogICAgICAgICAgICA8ZGl2IGNsYXNzPSJnYW1lLXRvcC1yb3ciPgogICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImdhbWUtaWNvbiIgJHtjb3ZlciA/IGBzdHlsZT0iYmFja2dyb3VuZC1pbWFnZTp1cmwoJHtjb3Zlcn0pImAgOiAiIn0+JHtjb3ZlciA/ICIiIDogIj8/In08L2Rpdj4KICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJnYW1lLWJvZHkiPgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZ2FtZS10aXRsZSI+JHt6Lm5hbWUgfHwgIlVudGl0bGVkIn08L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImdhbWUtZGVzYyI+JHt6LmF1dGhvciB8fCAiQ2xpY2sgdG8gcGxheSJ9PC9kaXY+CiAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJnYW1lLWFjdGlvbnMiPjxidXR0b24gY2xhc3M9ImdhbWUtYnV0dG9uIj5QbGF5PC9idXR0b24+PC9kaXY+CiAgICAgICAgICBgOwogICAgICAgICAgY2FyZC5vbmNsaWNrID0gKCkgPT4gb3BlbkdhbWUoeik7CiAgICAgICAgICBjYXJkLnF1ZXJ5U2VsZWN0b3IoIi5nYW1lLWJ1dHRvbiIpLm9uY2xpY2sgPSBlID0+IHsgZS5zdG9wUHJvcGFnYXRpb24oKTsgb3BlbkdhbWUoeik7IH07CiAgICAgICAgICBnYW1lTGlzdEVsLmFwcGVuZENoaWxkKGNhcmQpOwogICAgICAgIH0pOwogICAgICB9CgogICAgICBmdW5jdGlvbiBmaWx0ZXIocSkgewogICAgICAgIGlmICghem9uZXMgfHwgem9uZXMubGVuZ3RoID09PSAwKSByZXR1cm47CiAgICAgICAgcSA9IHEudHJpbSgpLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgZmlsdGVyZWQgPSBxID8gem9uZXMuZmlsdGVyKHogPT4gKHoubmFtZSB8fCAiIikudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxKSkgOiB6b25lczsKICAgICAgICByZW5kZXIoZmlsdGVyZWQpOwogICAgICB9CgogICAgICBhc3luYyBmdW5jdGlvbiBpbml0KCkgewogICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKFpPTkVTX1VSTCArICI/dD0iICsgRGF0ZS5ub3coKSk7CiAgICAgICAgem9uZXMgPSBhd2FpdCByZXMuanNvbigpOwogICAgICAgIHJlbmRlcih6b25lcyk7CiAgICAgICAgc2VhcmNoSW5wdXQ/LmFkZEV2ZW50TGlzdGVuZXIoImlucHV0IiwgZSA9PiBmaWx0ZXIoZS50YXJnZXQudmFsdWUpKTsKICAgICAgfQoKICAgICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICJsb2FkaW5nIikgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsIGluaXQpOwogICAgICBlbHNlIGluaXQoKTsKICAgIH0pKCk7CiAgPC9zY3JpcHQ+CgogIDwhLS0gU291bmRib2FyZCAtLT4KICA8c2NyaXB0PgogICAgKGZ1bmN0aW9uICgpIHsKICAgICAgY29uc3QgcGFkcyA9IFsKICAgICAgICB7IGxhYmVsOiAiTGFzZXIgU3dlZXAiLCB0YWc6ICJBcmNhZGUiLCB0b25lczogW3sgZnJlcTogNzYwLCBkdXJhdGlvbjogMC4xOCB9LCB7IGZyZXE6IDI4MCwgZHVyYXRpb246IDAuMjIsIGRlbGF5OiAwLjAyIH1dIH0sCiAgICAgICAgeyBsYWJlbDogIkNvaW4gUGlja3VwIiwgdGFnOiAiUmV0cm8iLCB0b25lczogW3sgZnJlcTogOTgwLCBkdXJhdGlvbjogMC4xMiB9LCB7IGZyZXE6IDEyODAsIGR1cmF0aW9uOiAwLjE2LCBkZWxheTogMC4wMiB9XSB9LAogICAgICAgIHsgbGFiZWw6ICJBaXIgSG9ybiIsIHRhZzogIkh5cGUiLCB0b25lczogW3sgZnJlcTogMjIwLCBkdXJhdGlvbjogMC40NSB9XSB9LAogICAgICAgIHsgbGFiZWw6ICJQaW5nIiwgdGFnOiAiQWxlcnQiLCB0b25lczogW3sgZnJlcTogNjYwLCBkdXJhdGlvbjogMC4xMiB9LCB7IGZyZXE6IDg4MCwgZHVyYXRpb246IDAuMTYsIGRlbGF5OiAwLjA1IH1dIH0sCiAgICAgIF07CiAgICAgIGNvbnN0IGdyaWQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic291bmRib2FyZC1ncmlkIik7CiAgICAgIGxldCBhdWRpb0N0eCA9IG51bGw7CgogICAgICBmdW5jdGlvbiBwbGF5KHRvbmVzKSB7CiAgICAgICAgaWYgKCFhdWRpb0N0eCkgewogICAgICAgICAgY29uc3QgQ3R4ID0gd2luZG93LkF1ZGlvQ29udGV4dCB8fCB3aW5kb3cud2Via2l0QXVkaW9Db250ZXh0OwogICAgICAgICAgaWYgKCFDdHgpIHJldHVybjsKICAgICAgICAgIGF1ZGlvQ3R4ID0gbmV3IEN0eCgpOwogICAgICAgIH0KICAgICAgICBpZiAoYXVkaW9DdHguc3RhdGUgPT09ICJzdXNwZW5kZWQiKSBhdWRpb0N0eC5yZXN1bWUoKTsKICAgICAgICBsZXQgdCA9IGF1ZGlvQ3R4LmN1cnJlbnRUaW1lOwogICAgICAgIHRvbmVzLmZvckVhY2goKHsgZnJlcSwgZHVyYXRpb24sIGRlbGF5ID0gMCB9KSA9PiB7CiAgICAgICAgICBjb25zdCBvID0gYXVkaW9DdHguY3JlYXRlT3NjaWxsYXRvcigpOwogICAgICAgICAgY29uc3QgZyA9IGF1ZGlvQ3R4LmNyZWF0ZUdhaW4oKTsKICAgICAgICAgIG8udHlwZSA9ICJzaW5lIjsKICAgICAgICAgIG8uZnJlcXVlbmN5LnNldFZhbHVlQXRUaW1lKGZyZXEsIHQpOwogICAgICAgICAgZy5nYWluLnNldFZhbHVlQXRUaW1lKDAuMDAxLCB0KTsKICAgICAgICAgIGcuZ2Fpbi5leHBvbmVudGlhbFJhbXBUb1ZhbHVlQXRUaW1lKDAuMzUsIHQgKyAwLjAyKTsKICAgICAgICAgIGcuZ2Fpbi5leHBvbmVudGlhbFJhbXBUb1ZhbHVlQXRUaW1lKDAuMDAxLCB0ICsgZHVyYXRpb24pOwogICAgICAgICAgby5jb25uZWN0KGcpLmNvbm5lY3QoYXVkaW9DdHguZGVzdGluYXRpb24pOwogICAgICAgICAgby5zdGFydCh0KTsgby5zdG9wKHQgKyBkdXJhdGlvbiArIDAuMDUpOwogICAgICAgICAgdCArPSBkdXJhdGlvbiArIGRlbGF5OwogICAgICAgIH0pOwogICAgICB9CgogICAgICBpZiAoZ3JpZCkgewogICAgICAgIGdyaWQuaW5uZXJIVE1MID0gIiI7CiAgICAgICAgcGFkcy5mb3JFYWNoKHBhZCA9PiB7CiAgICAgICAgICBjb25zdCBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICAgICAgZWwuY2xhc3NOYW1lID0gInNvdW5kLXBhZCI7CiAgICAgICAgICBlbC5pbm5lckhUTUwgPSBgPGRpdiBjbGFzcz0idGFnIj4ke3BhZC50YWd9PC9kaXY+PGRpdiBjbGFzcz0idGl0bGUiPiR7cGFkLmxhYmVsfTwvZGl2PmA7CiAgICAgICAgICBlbC5vbmNsaWNrID0gKCkgPT4gcGxheShwYWQudG9uZXMpOwogICAgICAgICAgZ3JpZC5hcHBlbmRDaGlsZChlbCk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0pKCk7CiAgPC9zY3JpcHQ+CgogIDwhLS0gTXVzaWMgLS0+CiAgPHNjcmlwdD4KICAgIChmdW5jdGlvbiAoKSB7CiAgICAgIGNvbnN0IG1vbnRobHlFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtdXNpYy1tb250aGx5Iik7CiAgICAgIGNvbnN0IHJlc3VsdHNFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtdXNpYy1yZXN1bHRzIik7CiAgICAgIGNvbnN0IHNlYXJjaElucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm11c2ljLXNlYXJjaCIpOwogICAgICBjb25zdCBzZWFyY2hCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibXVzaWMtc2VhcmNoLWJ0biIpOwogICAgICBjb25zdCByZWZyZXNoQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm11c2ljLXJlZnJlc2giKTsKICAgICAgY29uc3QgZW1wdHlFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtdXNpYy1lbXB0eSIpOwoKICAgICAgY29uc3QgTU9OVEhMWV9QSUNLUyA9IFsKICAgICAgICB7IHRpdGxlOiAiRGFyayBUaG91Z2h0cyIsIGFydGlzdDogIkxpbCBUZWNjYSIgfSwKICAgICAgICB7IHRpdGxlOiAiTW9udGFnZW0gUmVib2xhIiwgYXJ0aXN0OiAiIiB9LAogICAgICAgIHsgdGl0bGU6ICJSYW5zb20iLCBhcnRpc3Q6ICJMaWwgVGVjY2EiIH0sCiAgICAgICAgeyB0aXRsZTogIkhlYWRzaG90IDIyMyIsIGFydGlzdDogIklTaG93U3BlZWQiIH0sCiAgICAgIF07CgogICAgICBsZXQgYXVkaW8gPSBuZXcgQXVkaW8oKTsKICAgICAgbGV0IGN1cnJlbnRCdG4gPSBudWxsOwoKICAgICAgYXVkaW8uYWRkRXZlbnRMaXN0ZW5lcigiZW5kZWQiLCAoKSA9PiB7CiAgICAgICAgaWYgKGN1cnJlbnRCdG4pIHsKICAgICAgICAgIHNldEJ0blN0YXRlKGN1cnJlbnRCdG4sIGZhbHNlKTsKICAgICAgICAgIGN1cnJlbnRCdG4gPSBudWxsOwogICAgICAgIH0KICAgICAgfSk7CgogICAgICBmdW5jdGlvbiBlc2NhcGVIVE1MKHMpIHsKICAgICAgICByZXR1cm4gU3RyaW5nKHMgfHwgIiIpLnJlcGxhY2UoLyYvZywgIiZhbXA7IikucmVwbGFjZSgvPC9nLCAiJmx0OyIpLnJlcGxhY2UoLz4vZywgIiZndDsiKS5yZXBsYWNlKC8iL2csICImcXVvdDsiKS5yZXBsYWNlKC8nL2csICImIzAzOTsiKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gaW5pdGlhbHModGl0bGUpIHsKICAgICAgICByZXR1cm4gKHRpdGxlIHx8ICJOVyIpLnNwbGl0KCIgIikubWFwKHAgPT4gcC50cmltKClbMF0gfHwgIiIpLmpvaW4oIiIpLnNsaWNlKDAsIDIpLnRvVXBwZXJDYXNlKCk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIHNldEJ0blN0YXRlKGJ0biwgcGxheWluZykgewogIGlmICghYnRuKSByZXR1cm47CiAgYnRuLnRleHRDb250ZW50ID0gcGxheWluZyA/ICJQYXVzZSBwcmV2aWV3IiA6ICJQbGF5IHByZXZpZXciOwogIGJ0bi5kaXNhYmxlZCA9IGZhbHNlOwogIGJ0bi5zZXRBdHRyaWJ1dGUoImFyaWEtcHJlc3NlZCIsIHBsYXlpbmcgPyAidHJ1ZSIgOiAiZmFsc2UiKTsKfQoKICAgICAgZnVuY3Rpb24gYmluZFByZXZpZXcoYnRuLCB0cmFjaykgewogICAgICAgIGlmICghYnRuIHx8ICF0cmFjay5wcmV2aWV3VXJsKSB7CiAgICAgICAgICBpZiAoYnRuKSB7CiAgICAgICAgICAgIGJ0bi50ZXh0Q29udGVudCA9ICJObyBwcmV2aWV3IjsKICAgICAgICAgICAgYnRuLmRpc2FibGVkID0gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgKCkgPT4gewogICAgICAgICAgaWYgKGN1cnJlbnRCdG4gJiYgY3VycmVudEJ0biAhPT0gYnRuKSB7CiAgICAgICAgICAgIHNldEJ0blN0YXRlKGN1cnJlbnRCdG4sIGZhbHNlKTsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChjdXJyZW50QnRuID09PSBidG4gJiYgIWF1ZGlvLnBhdXNlZCkgewogICAgICAgICAgICBhdWRpby5wYXVzZSgpOwogICAgICAgICAgICBzZXRCdG5TdGF0ZShidG4sIGZhbHNlKTsKICAgICAgICAgICAgY3VycmVudEJ0biA9IG51bGw7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICAgIGF1ZGlvLnNyYyA9IHRyYWNrLnByZXZpZXdVcmw7CiAgICAgICAgICBhdWRpby5wbGF5KCkudGhlbigoKSA9PiB7CiAgICAgICAgICAgIGN1cnJlbnRCdG4gPSBidG47CiAgICAgICAgICAgIHNldEJ0blN0YXRlKGJ0biwgdHJ1ZSk7CiAgICAgICAgICB9KS5jYXRjaCgoKSA9PiB7CiAgICAgICAgICAgIGJ0bi50ZXh0Q29udGVudCA9ICJQcmV2aWV3IGJsb2NrZWQiOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGNhcmRGcm9tVHJhY2sodHJhY2spIHsKICAgICAgICBjb25zdCBjYXJkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgICAgY2FyZC5jbGFzc05hbWUgPSAibXVzaWMtY2FyZCI7CiAgICAgICAgY29uc3QgYXJ0SFRNTCA9IHRyYWNrLmFydAogICAgICAgICAgPyBgPGltZyBzcmM9IiR7ZXNjYXBlSFRNTCh0cmFjay5hcnQpfSI+YAogICAgICAgICAgOiBpbml0aWFscyh0cmFjay50aXRsZSk7CiAgICAgICAgY2FyZC5pbm5lckhUTUwgPSBgCiAgICAgICAgICA8ZGl2IGNsYXNzPSJtdXNpYy1jYXJkLWhlYWRlciI+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9Im11c2ljLXRodW1iIj4ke2FydEhUTUx9PC9kaXY+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9Im11c2ljLW1ldGEiPgogICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im11c2ljLXRpdGxlIj4ke2VzY2FwZUhUTUwodHJhY2sudGl0bGUpfTwvZGl2PgogICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im11c2ljLWFydGlzdCI+JHtlc2NhcGVIVE1MKHRyYWNrLmFydGlzdCl9JHt0cmFjay5hbGJ1bSA/ICIgwrcgIiArIGVzY2FwZUhUTUwodHJhY2suYWxidW0pIDogIiJ9PC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgPC9kaXY+CiAgICAgICAgICA8ZGl2IGNsYXNzPSJtdXNpYy1hY3Rpb25zIj4KICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0ibXVzaWMtYnRuIHByaW1hcnkiPlBsYXkgcHJldmlldzwvYnV0dG9uPgogICAgICAgICAgICAke3RyYWNrLml0dW5lc1VybCA/IGA8YSBjbGFzcz0ibXVzaWMtYnRuIiBocmVmPSIke2VzY2FwZUhUTUwodHJhY2suaXR1bmVzVXJsKX0iIHRhcmdldD0iX2JsYW5rIj5pVHVuZXM8L2E+YCA6ICIifQogICAgICAgICAgPC9kaXY+CiAgICAgICAgYDsKICAgICAgICBjb25zdCBwcmV2aWV3QnRuID0gY2FyZC5xdWVyeVNlbGVjdG9yKCIubXVzaWMtYnRuLnByaW1hcnkiKTsKICAgICAgICBiaW5kUHJldmlldyhwcmV2aWV3QnRuLCB0cmFjayk7CiAgICAgICAgcmV0dXJuIGNhcmQ7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGpzb25wKHVybCwgdGltZW91dE1zID0gMTIwMDApIHsKICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgY29uc3QgY2IgPSAiaXR1bmVzX2pzb25wXyIgKyBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zbGljZSgyKTsKICAgIGNvbnN0IHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInNjcmlwdCIpOwogICAgY29uc3Qgc2VwID0gdXJsLmluY2x1ZGVzKCI/IikgPyAiJiIgOiAiPyI7CiAgICBjb25zdCB0aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgIGNsZWFudXAoKTsKICAgICAgcmVqZWN0KG5ldyBFcnJvcigiSlNPTlAgdGltZW91dCIpKTsKICAgIH0sIHRpbWVvdXRNcyk7CgogICAgZnVuY3Rpb24gY2xlYW51cCgpIHsKICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpOwogICAgICBkZWxldGUgd2luZG93W2NiXTsKICAgICAgc2NyaXB0LnJlbW92ZSgpOwogICAgfQoKICAgIHdpbmRvd1tjYl0gPSAocGF5bG9hZCkgPT4gewogICAgICBjbGVhbnVwKCk7CiAgICAgIHJlc29sdmUocGF5bG9hZCk7CiAgICB9OwoKICAgIHNjcmlwdC5zcmMgPSB1cmwgKyBzZXAgKyAiY2FsbGJhY2s9IiArIGNiOwogICAgc2NyaXB0Lm9uZXJyb3IgPSAoKSA9PiB7CiAgICAgIGNsZWFudXAoKTsKICAgICAgcmVqZWN0KG5ldyBFcnJvcigiSlNPTlAgZXJyb3IiKSk7CiAgICB9OwogICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzY3JpcHQpOwogIH0pOwp9Cgphc3luYyBmdW5jdGlvbiBmZXRjaEl0dW5lcyh0ZXJtLCBsaW1pdCA9IDYpIHsKICBjb25zdCBiYXNlID0gImh0dHBzOi8vaXR1bmVzLmFwcGxlLmNvbS9zZWFyY2giOwogIGNvbnN0IHVybCA9IGAke2Jhc2V9P3Rlcm09JHtlbmNvZGVVUklDb21wb25lbnQodGVybSl9Jm1lZGlhPW11c2ljJmVudGl0eT1tdXNpY1RyYWNrJmxpbWl0PSR7bGltaXR9YDsKICAvLyBpVHVuZXMgU2VhcmNoIGlzIG9mdGVuIGJsb2NrZWQgYnkgQ09SUyBmcm9tIHN0YXRpYyBwYWdlczsgSlNPTlAgaXMgdGhlIG1vc3QgcmVsaWFibGUgb3B0aW9uLgogIGNvbnN0IGRhdGEgPSBhd2FpdCBqc29ucCh1cmwpOwogIHJldHVybiAoZGF0YS5yZXN1bHRzIHx8IFtdKS5tYXAociA9PiAoewogICAgdGl0bGU6IHIudHJhY2tOYW1lIHx8ICJVbmtub3duIiwKICAgIGFydGlzdDogci5hcnRpc3ROYW1lIHx8ICJVbmtub3duIEFydGlzdCIsCiAgICBhbGJ1bTogci5jb2xsZWN0aW9uTmFtZSwKICAgIGFydDogci5hcnR3b3JrVXJsMTAwLAogICAgcHJldmlld1VybDogci5wcmV2aWV3VXJsLAogICAgaXR1bmVzVXJsOiByLnRyYWNrVmlld1VybAogIH0pKS5maWx0ZXIociA9PiByLnRpdGxlKTsKfQoKICAgICAgYXN5bmMgZnVuY3Rpb24gbG9hZE1vbnRobHkoKSB7CiAgICAgICAgbW9udGhseUVsLmlubmVySFRNTCA9ICc8ZGl2IHN0eWxlPSJjb2xvcjp2YXIoLS10ZXh0LW11dGVkKTsiPkxvYWRpbmcuLi48L2Rpdj4nOwogICAgICAgIGNvbnN0IHRyYWNrcyA9IGF3YWl0IFByb21pc2UuYWxsKE1PTlRITFlfUElDS1MubWFwKGFzeW5jIHBpY2sgPT4gewogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgY29uc3QgaGl0cyA9IGF3YWl0IGZldGNoSXR1bmVzKGAke3BpY2sudGl0bGV9ICR7cGljay5hcnRpc3R9YCwgMSk7CiAgICAgICAgICAgIHJldHVybiBoaXRzWzBdIHx8IHBpY2s7CiAgICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgcmV0dXJuIHsgLi4ucGljaywgcHJldmlld1VybDogIiIsIGl0dW5lc1VybDogIiIsIGFydDogIiIgfTsKICAgICAgICAgIH0KICAgICAgICB9KSk7CiAgICAgICAgbW9udGhseUVsLmlubmVySFRNTCA9ICIiOwogICAgICAgIHRyYWNrcy5mb3JFYWNoKHQgPT4gbW9udGhseUVsLmFwcGVuZENoaWxkKGNhcmRGcm9tVHJhY2sodCkpKTsKICAgICAgfQoKICAgICAgYXN5bmMgZnVuY3Rpb24gcnVuU2VhcmNoKCkgewogICAgICAgIGNvbnN0IHRlcm0gPSBzZWFyY2hJbnB1dC52YWx1ZS50cmltKCk7CiAgICAgICAgaWYgKCF0ZXJtKSByZXR1cm47CiAgICAgICAgcmVzdWx0c0VsLmlubmVySFRNTCA9ICc8ZGl2IHN0eWxlPSJjb2xvcjp2YXIoLS10ZXh0LW11dGVkKTsiPlNlYXJjaGluZy4uLjwvZGl2Pic7CiAgICAgICAgZW1wdHlFbC5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICAgIHRyeSB7CiAgICAgICAgICBjb25zdCBoaXRzID0gYXdhaXQgZmV0Y2hJdHVuZXModGVybSwgOSk7CiAgICAgICAgICByZXN1bHRzRWwuaW5uZXJIVE1MID0gIiI7CiAgICAgICAgICBpZiAoaGl0cy5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgZW1wdHlFbC50ZXh0Q29udGVudCA9ICJObyByZXN1bHRzLiI7CiAgICAgICAgICAgIGVtcHR5RWwuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBoaXRzLmZvckVhY2godCA9PiByZXN1bHRzRWwuYXBwZW5kQ2hpbGQoY2FyZEZyb21UcmFjayh0KSkpOwogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgIHJlc3VsdHNFbC5pbm5lckhUTUwgPSAiIjsKICAgICAgICAgIGVtcHR5RWwudGV4dENvbnRlbnQgPSAiU2VhcmNoIGZhaWxlZC4iOwogICAgICAgICAgZW1wdHlFbC5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJlZnJlc2hCdG4/LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgbG9hZE1vbnRobHkpOwogICAgICBzZWFyY2hCdG4/LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgcnVuU2VhcmNoKTsKICAgICAgc2VhcmNoSW5wdXQ/LmFkZEV2ZW50TGlzdGVuZXIoImtleXByZXNzIiwgZSA9PiB7IGlmIChlLmtleSA9PT0gIkVudGVyIikgcnVuU2VhcmNoKCk7IH0pOwogICAgICBsb2FkTW9udGhseSgpOwogICAgfSkoKTsKICA8L3NjcmlwdD4KCiAgPCEtLSBDbG9jayAtLT4KICA8c2NyaXB0PgogICAgZnVuY3Rpb24gdXBkYXRlQ2xvY2soKSB7CiAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7CiAgICAgIGxldCBoID0gbm93LmdldEhvdXJzKCksIG0gPSBub3cuZ2V0TWludXRlcygpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKSwgYW0gPSBoID49IDEyID8gJ1BNJyA6ICdBTSc7CiAgICAgIGggPSBoICUgMTIgfHwgMTI7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzeXN0ZW0tY2xvY2stdGltZScpLnRleHRDb250ZW50ID0gYCR7aH06JHttfSAke2FtfWA7CiAgICAgIGNvbnN0IG1vID0gKG5vdy5nZXRNb250aCgpICsgMSkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpOwogICAgICBjb25zdCBkID0gbm93LmdldERhdGUoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyk7CiAgICAgIGNvbnN0IHkgPSBub3cuZ2V0RnVsbFllYXIoKTsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N5c3RlbS1jbG9jay1kYXRlJykudGV4dENvbnRlbnQgPSBgJHttb30vJHtkfS8ke3l9YDsKICAgIH0KICAgIHVwZGF0ZUNsb2NrKCk7CiAgICBzZXRJbnRlcnZhbCh1cGRhdGVDbG9jaywgMzAwMDApOwogIDwvc2NyaXB0PgoKPHNjcmlwdD4KKGZ1bmN0aW9uKCl7CiAgZnVuY3Rpb24gc2V0VGFiKHRhYil7CiAgICBjb25zdCBidG49ZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtdGFiLXRhcmdldD0iJyt0YWIrJyJdJyk7CiAgICBpZihidG4pIGJ0bi5jbGljaygpOwogIH0KICBmdW5jdGlvbiBhcHBseUhhc2goKXsKICAgIGNvbnN0IGg9KGxvY2F0aW9uLmhhc2h8fCIiKS5yZXBsYWNlKCIjIiwiIikudHJpbSgpLnRvTG93ZXJDYXNlKCk7CiAgICBpZighaCkgcmV0dXJuOwogICAgc2V0VGFiKGgpOwogIH0KICBpZihkb2N1bWVudC5yZWFkeVN0YXRlPT09ImxvYWRpbmciKSBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJET01Db250ZW50TG9hZGVkIiwgYXBwbHlIYXNoKTsKICBlbHNlIGFwcGx5SGFzaCgpOwogIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJoYXNoY2hhbmdlIiwgYXBwbHlIYXNoKTsKfSkoKTsKPC9zY3JpcHQ+CjwvYm9keT4KCjwvaHRtbD4=" onload="try{this.contentDocument.documentElement.classList.add('app-mode')}catch(e){}"></iframe></div>
</div>

<div id="music" class="window">
  <div class="titlebar"><div class="name">Music</div><div class="win-actions">
    <button title="Maximize" onclick="toggleMax('music')">‚ñ¢</button>
    <button title="Minimize" onclick="minWin('music')">‚Äì</button>
    <button class="close" title="Close" onclick="closeWin('music')">√ó</button>
  </div></div>
  <div class="content"><iframe onload="try{this.contentDocument.documentElement.classList.add('app-mode')}catch(e){}" src="data:text/html;base64,PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+CiAgPG1ldGEgY2hhcnNldD0iVVRGLTgiPgogIDx0aXRsZT5HYWxheHkgR2FtZXMgLSBSZWRlc2lnbjwvdGl0bGU+CiAgPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xLjAiPgogIDxzdHlsZT4KICAgIDpyb290IHsKICAgICAgLS1iZzogcmFkaWFsLWdyYWRpZW50KGNpcmNsZSBhdCB0b3AgbGVmdCwgIzExMTgyNywgIzAyMDYxNyA1NSUsICMwMDAwMDApOwogICAgICAtLWJnLXBhbmVsOiByZ2JhKDE1LDIzLDQyLDAuOTYpOwogICAgICAtLWFjY2VudDogIzM4YmRmODsKICAgICAgLS1hY2NlbnQtc29mdDogcmdiYSg1NiwxODksMjQ4LDAuMTgpOwogICAgICAtLWFjY2VudC0yOiAjYTg1NWY3OwogICAgICAtLXRleHQtbWFpbjogI2Y5ZmFmYjsKICAgICAgLS10ZXh0LW11dGVkOiAjOWNhM2FmOwogICAgICAtLWJvcmRlci1zdWJ0bGU6IHJnYmEoMTQ4LDE2MywxODQsMC4zKTsKICAgICAgLS1yYWRpdXMtbGc6IDE4cHg7CiAgICAgIC0tc2hhZG93LXNvZnQ6IDAgMjRweCA4MHB4IHJnYmEoMTUsMjMsNDIsMC45KTsKICAgIH0KICAgICosCiAgICAqOjpiZWZvcmUsCiAgICAqOjphZnRlciB7CiAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7CiAgICB9CiAgICBodG1sLCBib2R5IHsKICAgICAgbWFyZ2luOiAwOwogICAgICBwYWRkaW5nOiAwOwogICAgICBoZWlnaHQ6IDEwMCU7CiAgICB9CiAgICBib2R5IHsKICAgICAgZm9udC1mYW1pbHk6IHN5c3RlbS11aSwgLWFwcGxlLXN5c3RlbSwgQmxpbmtNYWNTeXN0ZW1Gb250LCAiU0YgUHJvIFRleHQiLCBzYW5zLXNlcmlmOwogICAgICBjb2xvcjogdmFyKC0tdGV4dC1tYWluKTsKICAgICAgYmFja2dyb3VuZDogdmFyKC0tYmcpOwogICAgICBiYWNrZ3JvdW5kLWF0dGFjaG1lbnQ6IGZpeGVkOwogICAgICBkaXNwbGF5OiBmbGV4OwogICAgICBhbGlnbi1pdGVtczogc3RyZXRjaDsKICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICB9CiAgICAuYXBwLXNoZWxsIHsKICAgICAgZGlzcGxheTogZ3JpZDsKICAgICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiA4MHB4IG1pbm1heCgwLCAxZnIpOwogICAgICBtYXgtd2lkdGg6IDEyMDBweDsKICAgICAgd2lkdGg6IDEwMCU7CiAgICAgIGhlaWdodDogMTAwdmg7CiAgICAgIHBhZGRpbmc6IDE4cHg7CiAgICAgIGdhcDogMThweDsKICAgIH0KICAgIC8qIFNpZGViYXIgKi8KICAgIC5zaWRlYmFyIHsKICAgICAgYmFja2dyb3VuZDogcmdiYSgxNSwyMyw0MiwwLjk2KTsKICAgICAgYm9yZGVyLXJhZGl1czogMjRweDsKICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgxNSwyMyw0MiwwLjkpOwogICAgICBib3gtc2hhZG93OiB2YXIoLS1zaGFkb3ctc29mdCk7CiAgICAgIHBhZGRpbmc6IDE0cHggMTBweDsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogICAgfQogICAgLmxvZ28tY2lyY2xlIHsKICAgICAgd2lkdGg6IDQycHg7CiAgICAgIGhlaWdodDogNDJweDsKICAgICAgYm9yZGVyLXJhZGl1czogOTk5cHg7CiAgICAgIGJhY2tncm91bmQ6IHJhZGlhbC1ncmFkaWVudChjaXJjbGUgYXQgMzAlIDIwJSwgIzM4YmRmOCwgIzBmMTcyYSk7CiAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgICBmb250LXdlaWdodDogODAwOwogICAgICBsZXR0ZXItc3BhY2luZzogMC4wNGVtOwogICAgICBmb250LXNpemU6IDFyZW07CiAgICAgIGJveC1zaGFkb3c6IDAgMTBweCAzMHB4IHJnYmEoNTYsMTg5LDI0OCwwLjM1KTsKICAgIH0KICAgIC5zaWRlLW5hdiB7CiAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICAgIGdhcDogMTBweDsKICAgICAgbWFyZ2luLXRvcDogMTJweDsKICAgIH0KICAgIC5zaWRlLW5hdiBidXR0b24gewogICAgICBhbGw6IHVuc2V0OwogICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgIHdpZHRoOiA0MHB4OwogICAgICBoZWlnaHQ6IDQwcHg7CiAgICAgIGJvcmRlci1yYWRpdXM6IDk5OXB4OwogICAgICBkaXNwbGF5OiBmbGV4OwogICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgICAgZm9udC1zaXplOiAxLjJyZW07CiAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsKICAgICAgdHJhbnNpdGlvbjogYWxsIDAuMThzIGVhc2U7CiAgICB9CiAgICAuc2lkZS1uYXYgYnV0dG9uOmhvdmVyIHsKICAgICAgYmFja2dyb3VuZDogcmdiYSgxNSwyMyw0MiwwLjkpOwogICAgICBjb2xvcjogdmFyKC0tdGV4dC1tYWluKTsKICAgIH0KICAgIC5zaWRlLW5hdiBidXR0b24uYWN0aXZlIHsKICAgICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgdmFyKC0tYWNjZW50KSwgdmFyKC0tYWNjZW50LTIpKTsKICAgICAgY29sb3I6ICMwYjExMjA7CiAgICAgIGJveC1zaGFkb3c6IDAgMTBweCAzNXB4IHJnYmEoNTYsMTg5LDI0OCwwLjQpOwogICAgfQogICAgLnNpZGUtY2xvY2sgewogICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICAgIGZvbnQtc2l6ZTogMC43cmVtOwogICAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7CiAgICAgIGRpc3BsYXk6IGdyaWQ7CiAgICAgIGdhcDogMnB4OwogICAgfQogICAgLnNpZGUtY2xvY2stdGltZSB7CiAgICAgIGZvbnQtc2l6ZTogMC45cmVtOwogICAgICBmb250LXdlaWdodDogNjAwOwogICAgICBsZXR0ZXItc3BhY2luZzogMC4wOGVtOwogICAgfQogICAgLyogTWFpbiBhcmVhICovCiAgICAubWFpbiB7CiAgICAgIGJhY2tncm91bmQ6IHZhcigtLWJnLXBhbmVsKTsKICAgICAgYm9yZGVyLXJhZGl1czogMjRweDsKICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgxNSwyMyw0MiwwLjkpOwogICAgICBib3gtc2hhZG93OiB2YXIoLS1zaGFkb3ctc29mdCk7CiAgICAgIHBhZGRpbmc6IDE4cHggMjJweCAyMHB4OwogICAgICBkaXNwbGF5OiBmbGV4OwogICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgICBnYXA6IDE4cHg7CiAgICAgIG92ZXJmbG93OiBoaWRkZW47CiAgICB9CiAgICAubWFpbi1oZWFkZXIgewogICAgICBkaXNwbGF5OiBmbGV4OwogICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47CiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgIGdhcDogMTZweDsKICAgIH0KICAgIC5icmFuZC1ibG9jayB7CiAgICAgIGRpc3BsYXk6IGdyaWQ7CiAgICAgIGdhcDogNHB4OwogICAgfQogICAgLmJyYW5kLXRpdGxlIHsKICAgICAgZm9udC1zaXplOiAxLjRyZW07CiAgICAgIGZvbnQtd2VpZ2h0OiA4MDA7CiAgICAgIGxldHRlci1zcGFjaW5nOiAwLjA4ZW07CiAgICAgIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7CiAgICB9CiAgICAuYnJhbmQtc3VidGl0bGUgewogICAgICBmb250LXNpemU6IDAuODVyZW07CiAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsKICAgIH0KICAgIC5waWxsLXJvdyB7CiAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgIGdhcDogOHB4OwogICAgICBmbGV4LXdyYXA6IHdyYXA7CiAgICAgIGZvbnQtc2l6ZTogMC43NXJlbTsKICAgIH0KICAgIC5waWxsIHsKICAgICAgcGFkZGluZzogNHB4IDhweDsKICAgICAgYm9yZGVyLXJhZGl1czogOTk5cHg7CiAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHJnYmEoMTQ4LDE2MywxODQsMC4zNSk7CiAgICAgIGJhY2tncm91bmQ6IHJnYmEoMTUsMjMsNDIsMC45KTsKICAgICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOwogICAgfQogICAgLyogVG9wIHRhYiByb3cgKi8KICAgIC50b3AtdGFicyB7CiAgICAgIGRpc3BsYXk6IGlubGluZS1mbGV4OwogICAgICBwYWRkaW5nOiA0cHg7CiAgICAgIGJvcmRlci1yYWRpdXM6IDk5OXB4OwogICAgICBiYWNrZ3JvdW5kOiByZ2JhKDE1LDIzLDQyLDAuNyk7CiAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHJnYmEoMTUsMjMsNDIsMC45KTsKICAgIH0KICAgIC50b3AtdGFicyBidXR0b24gewogICAgICBhbGw6IHVuc2V0OwogICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgIHBhZGRpbmc6IDZweCAxNHB4OwogICAgICBib3JkZXItcmFkaXVzOiA5OTlweDsKICAgICAgZm9udC1zaXplOiAwLjg1cmVtOwogICAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7CiAgICAgIHRyYW5zaXRpb246IGFsbCAwLjE2czsKICAgIH0KICAgIC50b3AtdGFicyBidXR0b24uYWN0aXZlIHsKICAgICAgYmFja2dyb3VuZDogcmFkaWFsLWdyYWRpZW50KGNpcmNsZSBhdCB0b3AgbGVmdCwgdmFyKC0tYWNjZW50KSwgdmFyKC0tYWNjZW50LTIpKTsKICAgICAgY29sb3I6ICMwMjA2MTc7CiAgICAgIGJveC1zaGFkb3c6IDAgMTBweCAyNXB4IHJnYmEoNTYsMTg5LDI0OCwwLjQ1KTsKICAgICAgZm9udC13ZWlnaHQ6IDYwMDsKICAgIH0KICAgIC8qIFBhbmVscyAqLwogICAgLnBhbmVsLXNoZWxsIHsKICAgICAgZmxleDogMTsKICAgICAgYm9yZGVyLXJhZGl1czogMThweDsKICAgICAgYmFja2dyb3VuZDogcmFkaWFsLWdyYWRpZW50KGNpcmNsZSBhdCB0b3AgbGVmdCwgcmdiYSgxNSwyMyw0MiwwLjk1KSwgIzAyMDYxNyk7CiAgICAgIHBhZGRpbmc6IDE4cHggMThweCAxNnB4OwogICAgICBkaXNwbGF5OiBmbGV4OwogICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgfQogICAgLnRhYi1wYW5lbCB7CiAgICAgIGRpc3BsYXk6IG5vbmU7CiAgICAgIGhlaWdodDogMTAwJTsKICAgIH0KICAgIC50YWItcGFuZWwuYWN0aXZlIHsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgICAgZ2FwOiAxNnB4OwogICAgfQogICAgLyogRml4IGN1dG9mZiAqLwogICAgLnRhYi1wYW5lbFtkYXRhLXRhYj0iZ2FtZXMiXSwKICAgIC50YWItcGFuZWxbZGF0YS10YWI9Im11c2ljIl0gewogICAgICBvdmVyZmxvdy15OiBhdXRvOwogICAgICBtYXgtaGVpZ2h0OiBjYWxjKDEwMHZoIC0gMjIwcHgpOwogICAgICBwYWRkaW5nLXJpZ2h0OiA0cHg7CiAgICB9CiAgICAvKiBIb21lIHBhbmVsICovCiAgICAuaGVybyB7CiAgICAgIGRpc3BsYXk6IGdyaWQ7CiAgICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogbWlubWF4KDAsIDEuNGZyKSBtaW5tYXgoMCwgMWZyKTsKICAgICAgZ2FwOiAxOHB4OwogICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgfQogICAgLmhlcm8tdGl0bGUgewogICAgICBmb250LXNpemU6IDJyZW07CiAgICAgIGZvbnQtd2VpZ2h0OiA4MDA7CiAgICAgIGxldHRlci1zcGFjaW5nOiAwLjA2ZW07CiAgICAgIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7CiAgICB9CiAgICAuaGVyby10aXRsZSBzcGFuLmFjY2VudCB7CiAgICAgIGNvbG9yOiB2YXIoLS1hY2NlbnQpOwogICAgfQogICAgLmhlcm8tc3ViIHsKICAgICAgbWFyZ2luLXRvcDogOHB4OwogICAgICBmb250LXNpemU6IDAuOXJlbTsKICAgICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOwogICAgICBtYXgtd2lkdGg6IDM4MHB4OwogICAgfQogICAgLmhlcm8tYWN0aW9ucyB7CiAgICAgIG1hcmdpbi10b3A6IDE0cHg7CiAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgIGdhcDogMTBweDsKICAgICAgZmxleC13cmFwOiB3cmFwOwogICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgfQogICAgLmJ0bi1wcmltYXJ5IHsKICAgICAgcGFkZGluZzogMC43cmVtIDEuNHJlbTsKICAgICAgYm9yZGVyLXJhZGl1czogOTk5cHg7CiAgICAgIGJvcmRlcjogbm9uZTsKICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgICBiYWNrZ3JvdW5kOiByYWRpYWwtZ3JhZGllbnQoY2lyY2xlIGF0IHRvcCBsZWZ0LCB2YXIoLS1hY2NlbnQpLCB2YXIoLS1hY2NlbnQtMikpOwogICAgICBjb2xvcjogIzAyMDYxNzsKICAgICAgZm9udC13ZWlnaHQ6IDYwMDsKICAgICAgZm9udC1zaXplOiAwLjlyZW07CiAgICAgIGJveC1zaGFkb3c6IDAgMTJweCAzMHB4IHJnYmEoNTYsMTg5LDI0OCwwLjQ1KTsKICAgIH0KICAgIC5idG4tcHJpbWFyeTpob3ZlciB7CiAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMXB4KTsKICAgIH0KICAgIC5idG4tZ2hvc3QgewogICAgICBwYWRkaW5nOiAwLjZyZW0gMS4xcmVtOwogICAgICBib3JkZXItcmFkaXVzOiA5OTlweDsKICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgxNDgsMTYzLDE4NCwwLjQpOwogICAgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDsKICAgICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOwogICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgIGZvbnQtc2l6ZTogMC44NXJlbTsKICAgIH0KICAgIC5oZXJvLWNhcmQgewogICAgICBib3JkZXItcmFkaXVzOiAyMHB4OwogICAgICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDE0OCwxNjMsMTg0LDAuMzUpOwogICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCByZ2JhKDE1LDIzLDQyLDAuOSksIHJnYmEoMzAsNjQsMTc1LDAuOSkpOwogICAgICBwYWRkaW5nOiAxNHB4OwogICAgICBkaXNwbGF5OiBncmlkOwogICAgICBnYXA6IDEwcHg7CiAgICB9CiAgICAuaGVyby1jYXJkLXRodW1iIHsKICAgICAgYm9yZGVyLXJhZGl1czogMTRweDsKICAgICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKCdodHRwczovL2ltYWdlcy5wZXhlbHMuY29tL3Bob3Rvcy8zOTUwMS9sYW1ib3JnaGluaS1icm5vLXJhY2luZy1jYXItYXV0b21vYmlsZXMtMzk1MDEuanBlZz9hdXRvPWNvbXByZXNzJmNzPXRpbnlzcmdiJnc9MTIwMCcpOwogICAgICBiYWNrZ3JvdW5kLXNpemU6IGNvdmVyOwogICAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7CiAgICAgIGhlaWdodDogMTUwcHg7CiAgICB9CiAgICAuaGVyby1jYXJkLXRpdGxlIHsKICAgICAgZm9udC13ZWlnaHQ6IDYwMDsKICAgICAgZm9udC1zaXplOiAwLjk1cmVtOwogICAgfQogICAgLmhlcm8tY2FyZC1tZXRhIHsKICAgICAgZm9udC1zaXplOiAwLjhyZW07CiAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAgZ2FwOiAxMHB4OwogICAgfQogICAgLyogR2FtZXMgcGFuZWwgKi8KICAgIC5nYW1lcy1oZWFkZXItcm93IHsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICBnYXA6IDEwcHg7CiAgICAgIGZsZXgtd3JhcDogd3JhcDsKICAgIH0KICAgIC5nYW1lcy10aXRsZSB7CiAgICAgIGZvbnQtc2l6ZTogMS4ycmVtOwogICAgICBmb250LXdlaWdodDogNzAwOwogICAgfQogICAgLnNlYXJjaC1iYXIgewogICAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICAgIHdpZHRoOiAyNjBweDsKICAgICAgbWF4LXdpZHRoOiAxMDAlOwogICAgfQogICAgLnNlYXJjaC1iYXIgaW5wdXQgewogICAgICB3aWR0aDogMTAwJTsKICAgICAgcGFkZGluZzogMC42cmVtIDJyZW0gMC42cmVtIDAuOHJlbTsKICAgICAgYm9yZGVyLXJhZGl1czogOTk5cHg7CiAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHJnYmEoMTQ4LDE2MywxODQsMC40KTsKICAgICAgYmFja2dyb3VuZDogcmdiYSgxNSwyMyw0MiwwLjg1KTsKICAgICAgY29sb3I6IHZhcigtLXRleHQtbWFpbik7CiAgICAgIGZvbnQtc2l6ZTogMC44NXJlbTsKICAgIH0KICAgIC5zZWFyY2gtYmFyIHNwYW4gewogICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgIHJpZ2h0OiAwLjdyZW07CiAgICAgIHRvcDogNTAlOwogICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTUwJSk7CiAgICAgIGZvbnQtc2l6ZTogMC45cmVtOwogICAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7CiAgICB9CiAgICAuZ2FtZS1saXN0IHsKICAgICAgbWFyZ2luLXRvcDogMTRweDsKICAgICAgZGlzcGxheTogZ3JpZDsKICAgICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiByZXBlYXQoYXV0by1maWxsLCBtaW5tYXgoMjEwcHgsIDFmcikpOwogICAgICBnYXA6IDEycHg7CiAgICAgIG92ZXJmbG93OiBhdXRvOwogICAgICBwYWRkaW5nLXJpZ2h0OiA0cHg7CiAgICB9CiAgICAuZ2FtZS1jYXJkIHsKICAgICAgYm9yZGVyLXJhZGl1czogMTZweDsKICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgxNDgsMTYzLDE4NCwwLjI1KTsKICAgICAgYmFja2dyb3VuZDogcmdiYSgxNSwyMyw0MiwwLjkpOwogICAgICBwYWRkaW5nOiAxMHB4OwogICAgICBkaXNwbGF5OiBncmlkOwogICAgICBnYXA6IDhweDsKICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC4xMnMgZWFzZSwgYm94LXNoYWRvdyAwLjEycyBlYXNlLCBib3JkZXItY29sb3IgMC4xMnMgZWFzZTsKICAgIH0KICAgIC5nYW1lLWNhcmQ6aG92ZXIgewogICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTJweCk7CiAgICAgIGJveC1zaGFkb3c6IDAgMTRweCAzNXB4IHJnYmEoMTUsMjMsNDIsMC45KTsKICAgICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1hY2NlbnQtc29mdCk7CiAgICB9CiAgICAuZ2FtZS10b3Atcm93IHsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgZ2FwOiA4cHg7CiAgICB9CiAgICAuZ2FtZS1pY29uIHsKICAgICAgd2lkdGg6IDMycHg7CiAgICAgIGhlaWdodDogMzJweDsKICAgICAgYm9yZGVyLXJhZGl1czogMTJweDsKICAgICAgYmFja2dyb3VuZC1zaXplOiBjb3ZlcjsKICAgICAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyOwogICAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDMxLDQxLDU1LDAuOSk7CiAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgICBmb250LXNpemU6IDEuMXJlbTsKICAgIH0KICAgIC5nYW1lLWJvZHkgewogICAgICBkaXNwbGF5OiBncmlkOwogICAgICBnYXA6IDJweDsKICAgIH0KICAgIC5nYW1lLXRpdGxlIHsKICAgICAgZm9udC1zaXplOiAwLjlyZW07CiAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7CiAgICB9CiAgICAuZ2FtZS1kZXNjIHsKICAgICAgZm9udC1zaXplOiAwLjc1cmVtOwogICAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7CiAgICB9CiAgICAuZ2FtZS10aHVtYiB7CiAgICAgIGJvcmRlci1yYWRpdXM6IDEycHg7CiAgICAgIGhlaWdodDogOTZweDsKICAgICAgYmFja2dyb3VuZC1zaXplOiBjb3ZlcjsKICAgICAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyOwogICAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDE1LDIzLDQyLDAuOSk7CiAgICB9CiAgICAuZ2FtZS1hY3Rpb25zIHsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAganVzdGlmeS1jb250ZW50OiBmbGV4LWVuZDsKICAgIH0KICAgIC5nYW1lLWJ1dHRvbiB7CiAgICAgIHBhZGRpbmc6IDAuNHJlbSAwLjlyZW07CiAgICAgIGJvcmRlci1yYWRpdXM6IDk5OXB4OwogICAgICBib3JkZXI6IG5vbmU7CiAgICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsIHZhcigtLWFjY2VudCksIHZhcigtLWFjY2VudC0yKSk7CiAgICAgIGNvbG9yOiAjMDIwNjE3OwogICAgICBmb250LXNpemU6IDAuOHJlbTsKICAgICAgZm9udC13ZWlnaHQ6IDYwMDsKICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgfQogICAgLmdhbWUtYnV0dG9uOmhvdmVyIHsKICAgICAgZmlsdGVyOiBicmlnaHRuZXNzKDEuMDUpOwogICAgfQogICAgLyogU291bmRib2FyZCBwYW5lbCAqLwogICAgLnNvdW5kYm9hcmQtbm90ZSB7CiAgICAgIGZvbnQtc2l6ZTogMC44cmVtOwogICAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7CiAgICAgIG1hcmdpbi10b3A6IDRweDsKICAgIH0KICAgIC5zb3VuZGJvYXJkLXN0YXR1cyB7CiAgICAgIGZvbnQtc2l6ZTogMC44cmVtOwogICAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7CiAgICAgIG1pbi1oZWlnaHQ6IDFlbTsKICAgICAgbWFyZ2luLXRvcDogNnB4OwogICAgfQogICAgLnNvdW5kYm9hcmQtZ3JpZCB7CiAgICAgIG1hcmdpbi10b3A6IDE0cHg7CiAgICAgIGRpc3BsYXk6IGdyaWQ7CiAgICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogcmVwZWF0KGF1dG8tZml0LCBtaW5tYXgoMTYwcHgsIDFmcikpOwogICAgICBnYXA6IDEwcHg7CiAgICB9CiAgICAuc291bmQtcGFkIHsKICAgICAgYm9yZGVyLXJhZGl1czogMTRweDsKICAgICAgcGFkZGluZzogMTBweDsKICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgxNDgsMTYzLDE4NCwwLjMpOwogICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCByZ2JhKDE1LDIzLDQyLDAuOSksIHJnYmEoMTUsMjMsNDIsMC45OCkpOwogICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgIGRpc3BsYXk6IGdyaWQ7CiAgICAgIGdhcDogNHB4OwogICAgfQogICAgLnNvdW5kLXBhZCAudGFnIHsKICAgICAgZm9udC1zaXplOiAwLjdyZW07CiAgICAgIGNvbG9yOiB2YXIoLS1hY2NlbnQpOwogICAgICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlOwogICAgICBsZXR0ZXItc3BhY2luZzogMC4xMmVtOwogICAgfQogICAgLnNvdW5kLXBhZCAudGl0bGUgewogICAgICBmb250LXNpemU6IDAuOXJlbTsKICAgICAgZm9udC13ZWlnaHQ6IDYwMDsKICAgIH0KICAgIC5zb3VuZC1wYWQgLmhpbnQgewogICAgICBmb250LXNpemU6IDAuNzVyZW07CiAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsKICAgIH0KICAgIC5zb3VuZC1wYWQucGxheWluZyB7CiAgICAgIGJveC1zaGFkb3c6IDAgMCAwIDFweCB2YXIoLS1hY2NlbnQtc29mdCksIDAgMCAyMHB4IHJnYmEoNTYsMTg5LDI0OCwwLjQpOwogICAgfQogICAgLyogQWJvdXQgcGFuZWwgKi8KICAgIC5hYm91dC10ZXh0IHsKICAgICAgbWF4LXdpZHRoOiA1MjBweDsKICAgICAgZm9udC1zaXplOiAwLjlyZW07CiAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsKICAgICAgbGluZS1oZWlnaHQ6IDEuNzsKICAgIH0KICAgIC8qIE11c2ljIHRhYiAqLwogICAgLm11c2ljLWhlcm8gewogICAgICBkaXNwbGF5OiBncmlkOwogICAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IG1pbm1heCgwLCAxLjJmcikgbWlubWF4KDAsIDAuOGZyKTsKICAgICAgZ2FwOiAxNnB4OwogICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgfQogICAgLm11c2ljLWhlcm8gaDIgewogICAgICBtYXJnaW46IDA7CiAgICAgIGZvbnQtc2l6ZTogMS40cmVtOwogICAgICBsZXR0ZXItc3BhY2luZzogMC4wNWVtOwogICAgfQogICAgLm11c2ljLWhlcm8gcCB7CiAgICAgIG1hcmdpbjogNnB4IDAgMCAwOwogICAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7CiAgICAgIGZvbnQtc2l6ZTogMC45cmVtOwogICAgICBtYXgtd2lkdGg6IDUyMHB4OwogICAgfQogICAgLm11c2ljLXBpbGxzIHsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAgZ2FwOiA4cHg7CiAgICAgIGZsZXgtd3JhcDogd3JhcDsKICAgICAgbWFyZ2luLXRvcDogMTBweDsKICAgIH0KICAgIC5tdXNpYy1waWxsIHsKICAgICAgcGFkZGluZzogNnB4IDEwcHg7CiAgICAgIGJvcmRlci1yYWRpdXM6IDk5OXB4OwogICAgICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDE0OCwxNjMsMTg0LDAuMzUpOwogICAgICBiYWNrZ3JvdW5kOiByZ2JhKDE1LDIzLDQyLDAuNzgpOwogICAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7CiAgICAgIGZvbnQtc2l6ZTogMC43OHJlbTsKICAgIH0KICAgIC5tdXNpYy1ncmlkIHsKICAgICAgZGlzcGxheTogZ3JpZDsKICAgICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiByZXBlYXQoYXV0by1maWxsLCBtaW5tYXgoMjIwcHgsIDFmcikpOwogICAgICBnYXA6IDEycHg7CiAgICB9CiAgICAubXVzaWMtY2FyZCB7CiAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHJnYmEoMTQ4LDE2MywxODQsMC4yMik7CiAgICAgIGJvcmRlci1yYWRpdXM6IDE0cHg7CiAgICAgIGJhY2tncm91bmQ6IHJnYmEoMTUsMjMsNDIsMC45KTsKICAgICAgcGFkZGluZzogMTBweDsKICAgICAgZGlzcGxheTogZ3JpZDsKICAgICAgZ2FwOiA4cHg7CiAgICAgIGJveC1zaGFkb3c6IDAgMTBweCAyNnB4IHJnYmEoMiw2LDIzLDAuNTUpOwogICAgfQogICAgLm11c2ljLWNhcmQtaGVhZGVyIHsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAgZ2FwOiAxMHB4OwogICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgfQogICAgLm11c2ljLXRodW1iIHsKICAgICAgd2lkdGg6IDUycHg7CiAgICAgIGhlaWdodDogNTJweDsKICAgICAgYm9yZGVyLXJhZGl1czogMTJweDsKICAgICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgcmdiYSg1NiwxODksMjQ4LDAuMjgpLCByZ2JhKDE2OCw4NSwyNDcsMC4yOCkpOwogICAgICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDE0OCwxNjMsMTg0LDAuMyk7CiAgICAgIGZsZXg6IDAgMCBhdXRvOwogICAgICBvdmVyZmxvdzogaGlkZGVuOwogICAgICBkaXNwbGF5OiBncmlkOwogICAgICBwbGFjZS1pdGVtczogY2VudGVyOwogICAgICBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7CiAgICAgIGZvbnQtc2l6ZTogMC43NXJlbTsKICAgICAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTsKICAgICAgbGV0dGVyLXNwYWNpbmc6IDAuMDhlbTsKICAgIH0KICAgIC5tdXNpYy10aHVtYiBpbWcgewogICAgICB3aWR0aDogMTAwJTsKICAgICAgaGVpZ2h0OiAxMDAlOwogICAgICBvYmplY3QtZml0OiBjb3ZlcjsKICAgICAgZGlzcGxheTogYmxvY2s7CiAgICB9CiAgICAubXVzaWMtbWV0YSB7CiAgICAgIG1pbi13aWR0aDogMDsKICAgIH0KICAgIC5tdXNpYy10aXRsZSB7CiAgICAgIGZvbnQtd2VpZ2h0OiA3MDA7CiAgICAgIGZvbnQtc2l6ZTogMC45NXJlbTsKICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDsKICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7CiAgICB9CiAgICAubXVzaWMtYXJ0aXN0IHsKICAgICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOwogICAgICBmb250LXNpemU6IDAuOHJlbTsKICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDsKICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7CiAgICB9CiAgICAubXVzaWMtYWN0aW9ucyB7CiAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgIGdhcDogOHB4OwogICAgICBmbGV4LXdyYXA6IHdyYXA7CiAgICB9CiAgICAubXVzaWMtYnRuIHsKICAgICAgcGFkZGluZzogNnB4IDEwcHg7CiAgICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7CiAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHJnYmEoMTQ4LDE2MywxODQsMC4zNSk7CiAgICAgIGJhY2tncm91bmQ6IHJnYmEoMTUsMjMsNDIsMC44NSk7CiAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LW1haW4pOwogICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgIGZvbnQtc2l6ZTogMC44cmVtOwogICAgICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kIDAuMTVzIGVhc2UsIHRyYW5zZm9ybSAwLjEycyBlYXNlOwogICAgfQogICAgLm11c2ljLWJ0bjpob3ZlciB7CiAgICAgIGJhY2tncm91bmQ6IHJnYmEoNTYsMTg5LDI0OCwwLjEpOwogICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTFweCk7CiAgICB9CiAgICAubXVzaWMtYnRuLnByaW1hcnkgewogICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCB2YXIoLS1hY2NlbnQpLCB2YXIoLS1hY2NlbnQtMikpOwogICAgICBjb2xvcjogIzAyMDYxNzsKICAgICAgYm9yZGVyOiBub25lOwogICAgICBmb250LXdlaWdodDogNzAwOwogICAgfQogICAgLm11c2ljLWZpZWxkIHsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAgZ2FwOiAxMHB4OwogICAgICBmbGV4LXdyYXA6IHdyYXA7CiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICB9CiAgICAubXVzaWMtZmllbGQgaW5wdXQgewogICAgICBmbGV4OiAxOwogICAgICBtaW4td2lkdGg6IDIyMHB4OwogICAgICBwYWRkaW5nOiAwLjY1cmVtIDAuOXJlbTsKICAgICAgYm9yZGVyLXJhZGl1czogMTJweDsKICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgxNDgsMTYzLDE4NCwwLjM1KTsKICAgICAgYmFja2dyb3VuZDogcmdiYSgxNSwyMyw0MiwwLjg1KTsKICAgICAgY29sb3I6IHZhcigtLXRleHQtbWFpbik7CiAgICAgIGZvbnQtc2l6ZTogMC45cmVtOwogICAgfQogICAgLm11c2ljLXN1YiB7CiAgICAgIGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTsKICAgICAgZm9udC1zaXplOiAwLjgycmVtOwogICAgfQogICAgLm11c2ljLWVtcHR5IHsKICAgICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOwogICAgICBmb250LXNpemU6IDAuODVyZW07CiAgICAgIGJvcmRlcjogMXB4IGRhc2hlZCByZ2JhKDE0OCwxNjMsMTg0LDAuMyk7CiAgICAgIGJvcmRlci1yYWRpdXM6IDEycHg7CiAgICAgIHBhZGRpbmc6IDEycHg7CiAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgIH0KICAgIEBtZWRpYSAobWF4LXdpZHRoOiA3ODBweCkgewogICAgICAubXVzaWMtaGVybyB7IGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyOyB9CiAgICB9CiAgLyogR2xvYmFsIHRvcCBzZWFyY2ggKi8KLmdsb2JhbC1zZWFyY2ggewogIHBvc2l0aW9uOiByZWxhdGl2ZTsKICB3aWR0aDogbWluKDQyMHB4LCA0MHZ3KTsKICBtYXgtd2lkdGg6IDEwMCU7Cn0KLmdsb2JhbC1zZWFyY2ggaW5wdXQgewogIHdpZHRoOiAxMDAlOwogIHBhZGRpbmc6IDAuNnJlbSAyLjRyZW0gMC42cmVtIDAuOXJlbTsKICBib3JkZXItcmFkaXVzOiA5OTlweDsKICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDE0OCwxNjMsMTg0LDAuNCk7CiAgYmFja2dyb3VuZDogcmdiYSgxNSwyMyw0MiwwLjg1KTsKICBjb2xvcjogdmFyKC0tdGV4dC1tYWluKTsKICBmb250LXNpemU6IDAuODVyZW07CiAgb3V0bGluZTogbm9uZTsKfQouZ2xvYmFsLXNlYXJjaCBidXR0b24gewogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICByaWdodDogMC40cmVtOwogIHRvcDogNTAlOwogIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtNTAlKTsKICB3aWR0aDogMzRweDsKICBoZWlnaHQ6IDM0cHg7CiAgYm9yZGVyLXJhZGl1czogOTk5cHg7CiAgYm9yZGVyOiBub25lOwogIGN1cnNvcjogcG9pbnRlcjsKICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCB2YXIoLS1hY2NlbnQpLCB2YXIoLS1hY2NlbnQtMikpOwogIGNvbG9yOiAjMDIwNjE3OwogIGZvbnQtd2VpZ2h0OiA4MDA7CiAgZGlzcGxheTogZ3JpZDsKICBwbGFjZS1pdGVtczogY2VudGVyOwogIGJveC1zaGFkb3c6IDAgMTBweCAyNXB4IHJnYmEoNTYsMTg5LDI0OCwwLjI1KTsKfQpAbWVkaWEgKG1heC13aWR0aDogNzgwcHgpIHsKICAubWFpbi1oZWFkZXIgeyBmbGV4LXdyYXA6IHdyYXA7IH0KICAuZ2xvYmFsLXNlYXJjaCB7IHdpZHRoOiAxMDAlOyBvcmRlcjogMzsgfQp9CiAgPC9zdHlsZT4KCjxzdHlsZT4KLyogRW1iZWRkZWQgIk11c2ljLW9ubHkiIG1vZGUgZm9yIEdhbGF4eSBMb3VuZ2UgT1MgKi8KaHRtbC5hcHAtbW9kZSwgaHRtbC5hcHAtbW9kZSBib2R5e2hlaWdodDoxMDAlO3dpZHRoOjEwMCU7bWFyZ2luOjAgIWltcG9ydGFudDtwYWRkaW5nOjAgIWltcG9ydGFudDtiYWNrZ3JvdW5kOnRyYW5zcGFyZW50ICFpbXBvcnRhbnQ7b3ZlcmZsb3c6aGlkZGVuICFpbXBvcnRhbnQ7fQpodG1sLmFwcC1tb2RlIC5zaWRlYmFyLApodG1sLmFwcC1tb2RlIC5tYWluLWhlYWRlciwKaHRtbC5hcHAtbW9kZSAudG9wLXRhYnMsCmh0bWwuYXBwLW1vZGUgLmdsb2JhbC1zZWFyY2h7ZGlzcGxheTpub25lICFpbXBvcnRhbnQ7fQpodG1sLmFwcC1tb2RlIC5hcHAtc2hlbGx7Z3JpZC10ZW1wbGF0ZS1jb2x1bW5zOjFmciAhaW1wb3J0YW50O2dhcDowICFpbXBvcnRhbnQ7cGFkZGluZzowICFpbXBvcnRhbnQ7aGVpZ2h0OjEwMHZoICFpbXBvcnRhbnQ7bWluLWhlaWdodDoxMDB2aCAhaW1wb3J0YW50O30KaHRtbC5hcHAtbW9kZSAubWFpbntwYWRkaW5nOjE0cHggIWltcG9ydGFudDtoZWlnaHQ6MTAwdmggIWltcG9ydGFudDttaW4taGVpZ2h0OjEwMHZoICFpbXBvcnRhbnQ7b3ZlcmZsb3c6aGlkZGVuICFpbXBvcnRhbnQ7fQpodG1sLmFwcC1tb2RlIC5wYW5lbC1zaGVsbHtoZWlnaHQ6MTAwJSAhaW1wb3J0YW50O21pbi1oZWlnaHQ6MTAwJSAhaW1wb3J0YW50O21heC1oZWlnaHQ6bm9uZSAhaW1wb3J0YW50O2JvcmRlci1yYWRpdXM6MCAhaW1wb3J0YW50O292ZXJmbG93OmF1dG8gIWltcG9ydGFudDt9Cmh0bWwuYXBwLW1vZGUgLnRhYi1wYW5lbHtkaXNwbGF5Om5vbmUgIWltcG9ydGFudDt9Cmh0bWwuYXBwLW1vZGUgLnRhYi1wYW5lbFtkYXRhLXRhYj0ibXVzaWMiXXtkaXNwbGF5OmZsZXggIWltcG9ydGFudDtmbGV4LWRpcmVjdGlvbjpjb2x1bW4gIWltcG9ydGFudDtoZWlnaHQ6MTAwJSAhaW1wb3J0YW50O21heC1oZWlnaHQ6bm9uZSAhaW1wb3J0YW50O292ZXJmbG93OmF1dG8gIWltcG9ydGFudDt9Ci8qIHJlbW92ZSBhbnkgbGVmdG92ZXIgbWF4LWhlaWdodCBjb25zdHJhaW50cyBmcm9tIG9yaWdpbmFsIGZpbGUgKi8KaHRtbC5hcHAtbW9kZSAudGFiLXBhbmVsW2RhdGEtdGFiPSJtdXNpYyJde21heC1oZWlnaHQ6bm9uZSAhaW1wb3J0YW50O30KPC9zdHlsZT4KPHNjcmlwdD4KICAvLyBGb3JjZSBhcHAtbW9kZSBhbmQgYXV0by1mb2N1cyBNdXNpYyB3aGVuIGVtYmVkZGVkCiAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2FwcC1tb2RlJyk7CiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKSA9PiB7CiAgICBjb25zdCBidG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS10YWItdGFyZ2V0PSJtdXNpYyJdJyk7CiAgICBpZiAoYnRuKSBidG4uY2xpY2soKTsKICB9KTsKPC9zY3JpcHQ+Cgo8L2hlYWQ+Cjxib2R5PgogIDxkaXYgY2xhc3M9ImFwcC1zaGVsbCI+CiAgICA8YXNpZGUgY2xhc3M9InNpZGViYXIiPgogICAgICA8ZGl2IGNsYXNzPSJsb2dvLWNpcmNsZSI+R1g8L2Rpdj4KICAgICAgPG5hdiBjbGFzcz0ic2lkZS1uYXYiPgogICAgICAgIDxidXR0b24gY2xhc3M9ImFjdGl2ZSIgZGF0YS10YWItdGFyZ2V0PSJob21lIiB0aXRsZT0iSG9tZSI+8J+PoDwvYnV0dG9uPgogICAgICAgIDxidXR0b24gZGF0YS10YWItdGFyZ2V0PSJnYW1lcyIgdGl0bGU9IkdhbWVzIj7wn46uPC9idXR0b24+CiAgICAgICAgPGJ1dHRvbiBkYXRhLXRhYi10YXJnZXQ9InNvdW5kYm9hcmQiIHRpdGxlPSJTb3VuZCBCb2FyZCI+8J+UijwvYnV0dG9uPgogICAgICAgIDxidXR0b24gZGF0YS10YWItdGFyZ2V0PSJtdXNpYyIgdGl0bGU9Ik11c2ljIj7wn461PC9idXR0b24+CiAgICAgICAgPGJ1dHRvbiBkYXRhLXRhYi10YXJnZXQ9InRlbGV2aXNpb24iIHRpdGxlPSJUViI+8J+TujwvYnV0dG9uPgogICAgICAgIDxidXR0b24gZGF0YS10YWItdGFyZ2V0PSJhYm91dCIgdGl0bGU9IkFib3V0Ij7ihLnvuI88L2J1dHRvbj4KICAgICAgPC9uYXY+CiAgICAgIDxkaXYgY2xhc3M9InNpZGUtY2xvY2siPgogICAgICAgIDxkaXYgaWQ9InN5c3RlbS1jbG9jay10aW1lIiBjbGFzcz0ic2lkZS1jbG9jay10aW1lIj48L2Rpdj4KICAgICAgICA8ZGl2IGlkPSJzeXN0ZW0tY2xvY2stZGF0ZSIgY2xhc3M9InNpZGUtY2xvY2stZGF0ZSI+PC9kaXY+CiAgICAgIDwvZGl2PgogICAgPC9hc2lkZT4KICAgIDxtYWluIGNsYXNzPSJtYWluIj4KICAgICAgPGRpdiBjbGFzcz0ibWFpbi1oZWFkZXIiPgogICAgICAgIDxkaXYgY2xhc3M9ImJyYW5kLWJsb2NrIj4KICAgICAgICAgIDxkaXYgY2xhc3M9ImJyYW5kLXRpdGxlIj5HYWxheHkgR2FtZXM8L2Rpdj4KICAgICAgICAgIDxkaXYgY2xhc3M9ImJyYW5kLXN1YnRpdGxlIj5MYXVuY2ggdW5ibG9ja2VkIGdhbWVzIGluIGEgc2luZ2xlIGNsZWFuIGRhc2hib2FyZC48L2Rpdj4KICAgICAgICAgIDxkaXYgY2xhc3M9InBpbGwtcm93Ij4KICAgICAgICAgICAgPGRpdiBjbGFzcz0icGlsbCI+RmFzdCBsYXVuY2g8L2Rpdj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0icGlsbCI+RnVsbC1zY3JlZW4gb3ZlcmxheTwvZGl2PgogICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPGRpdiBjbGFzcz0idG9wLXRhYnMiPgogICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYWN0aXZlIiBkYXRhLXRhYi10YXJnZXQ9ImhvbWUiPvCfj6AgSG9tZTwvYnV0dG9uPgogICAgICAgICAgPGJ1dHRvbiBkYXRhLXRhYi10YXJnZXQ9ImdhbWVzIj7wn46uIEdhbWVzPC9idXR0b24+CiAgICAgICAgICA8YnV0dG9uIGRhdGEtdGFiLXRhcmdldD0ic291bmRib2FyZCI+8J+UiiBTb3VuZDwvYnV0dG9uPgogICAgICAgICAgPGJ1dHRvbiBkYXRhLXRhYi10YXJnZXQ9Im11c2ljIj7wn461IE11c2ljPC9idXR0b24+CiAgICAgICAgICA8YnV0dG9uIGRhdGEtdGFiLXRhcmdldD0idGVsZXZpc2lvbiI+8J+TuiBUVjwvYnV0dG9uPgogICAgICAgICAgPGJ1dHRvbiBkYXRhLXRhYi10YXJnZXQ9ImFib3V0Ij7ihLnvuI8gQWJvdXQ8L2J1dHRvbj4KICAgICAgICA8L2Rpdj4KCjxkaXYgY2xhc3M9Imdsb2JhbC1zZWFyY2giIHRpdGxlPSJTZWFyY2ggdGhlIGN1cnJlbnQgdGFiIj4KICA8aW5wdXQgaWQ9Imdsb2JhbC1zZWFyY2giIHR5cGU9InRleHQiIHBsYWNlaG9sZGVyPSJTZWFyY2ggZ2FtZXMgb3IgbXVzaWMuLi4iIC8+CiAgPGJ1dHRvbiBpZD0iZ2xvYmFsLXNlYXJjaC1idG4iIGFyaWEtbGFiZWw9IlNlYXJjaCI+8J+UjjwvYnV0dG9uPgo8L2Rpdj4KICAgICAgPC9kaXY+CiAgICAgIDxkaXYgY2xhc3M9InBhbmVsLXNoZWxsIj4KICAgICAgICA8IS0tIEhvbWUgLS0+CiAgICAgICAgPHNlY3Rpb24gY2xhc3M9InRhYi1wYW5lbCBhY3RpdmUiIGRhdGEtdGFiPSJob21lIj4KICAgICAgICAgIDxkaXYgY2xhc3M9Imhlcm8iPgogICAgICAgICAgICA8ZGl2PgogICAgICAgICAgICAgIDxkaXYgY2xhc3M9Imhlcm8tdGl0bGUiPldlbGNvbWUgdG8gPHNwYW4gY2xhc3M9ImFjY2VudCI+R2FsYXh5IEdhbWVzPC9zcGFuPjwvZGl2PgogICAgICAgICAgICAgIDxkaXYgY2xhc3M9Imhlcm8tc3ViIj5Ccm93c2UgYSBjdXJhdGVkIGxpc3Qgb2Ygd2ViIGdhbWVzIGFuZCBsYXVuY2ggdGhlbSBpbiBhIGRpc3RyYWN0aW9uLWZyZWUgb3ZlcmxheS48L2Rpdj4KICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJoZXJvLWFjdGlvbnMiPgogICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuLXByaW1hcnkiIGlkPSJob21lLXN0YXJ0LWJ0biI+U3RhcnQgcGxheWluZzwvYnV0dG9uPgogICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuLWdob3N0IiBkYXRhLXRhYi1qdW1wPSJnYW1lcyI+VmlldyBhbGwgZ2FtZXM8L2J1dHRvbj4KICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9Imhlcm8tY2FyZCI+CiAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iaGVyby1jYXJkLXRodW1iIj48L2Rpdj4KICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJoZXJvLWNhcmQtdGl0bGUiPkZlYXR1cmVkOiBMYW1ib3JnaGluaSBTcHJpbnQ8L2Rpdj4KICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJoZXJvLWNhcmQtbWV0YSI+CiAgICAgICAgICAgICAgICA8c3Bhbj5BcmNhZGUg4oCiIEhpZ2ggc2NvcmUgY2hhc2U8L3NwYW4+CiAgICAgICAgICAgICAgICA8c3Bhbj5JbnN0YW50IGxvYWQgdmlhIG92ZXJsYXk8L3NwYW4+CiAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9zZWN0aW9uPgoKICAgICAgICAKPCEtLSBHbG9iYWwgU2VhcmNoIC0tPgo8c2NyaXB0PgogIChmdW5jdGlvbigpIHsKICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImdsb2JhbC1zZWFyY2giKTsKICAgIGNvbnN0IGJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJnbG9iYWwtc2VhcmNoLWJ0biIpOwoKICAgIGZ1bmN0aW9uIGdldEFjdGl2ZVRhYigpIHsKICAgICAgcmV0dXJuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXRhYl0uYWN0aXZlJyk/LmRhdGFzZXQudGFiIHx8ICJob21lIjsKICAgIH0KCiAgICBmdW5jdGlvbiBydW4oKSB7CiAgICAgIGNvbnN0IHEgPSAoaW5wdXQ/LnZhbHVlIHx8ICIiKS50cmltKCk7CiAgICAgIGlmICghcSkgcmV0dXJuOwoKICAgICAgY29uc3QgdGFiID0gZ2V0QWN0aXZlVGFiKCk7CgogICAgICBpZiAodGFiID09PSAiZ2FtZXMiKSB7CiAgICAgICAgY29uc3QgZ2FtZVNlYXJjaCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJnYW1lLXNlYXJjaCIpOwogICAgICAgIGlmIChnYW1lU2VhcmNoKSB7CiAgICAgICAgICBnYW1lU2VhcmNoLnZhbHVlID0gcTsKICAgICAgICAgIGdhbWVTZWFyY2guZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoImlucHV0IiwgeyBidWJibGVzOiB0cnVlIH0pKTsKICAgICAgICAgIGdhbWVTZWFyY2guZm9jdXMoKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAodGFiID09PSAibXVzaWMiKSB7CiAgICAgICAgY29uc3QgbXVzaWNTZWFyY2ggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibXVzaWMtc2VhcmNoIik7CiAgICAgICAgY29uc3QgbXVzaWNCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibXVzaWMtc2VhcmNoLWJ0biIpOwogICAgICAgIGlmIChtdXNpY1NlYXJjaCkgbXVzaWNTZWFyY2gudmFsdWUgPSBxOwogICAgICAgIG11c2ljQnRuPy5jbGljaygpOwogICAgICAgIG11c2ljU2VhcmNoPy5mb2N1cygpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgLy8gQ29udmVuaWVuY2U6IGlmIHlvdSdyZSBub3Qgb24gR2FtZXMvTXVzaWMsIGp1bXAgdG8gTXVzaWMgYnkgZGVmYXVsdC4KICAgICAgY29uc3QganVtcE11c2ljID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtdGFiLXRhcmdldD0ibXVzaWMiXScpOwogICAgICBqdW1wTXVzaWM/LmNsaWNrKCk7CiAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIGNvbnN0IG11c2ljU2VhcmNoID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm11c2ljLXNlYXJjaCIpOwogICAgICAgIGNvbnN0IG11c2ljQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm11c2ljLXNlYXJjaC1idG4iKTsKICAgICAgICBpZiAobXVzaWNTZWFyY2gpIG11c2ljU2VhcmNoLnZhbHVlID0gcTsKICAgICAgICBtdXNpY0J0bj8uY2xpY2soKTsKICAgICAgICBtdXNpY1NlYXJjaD8uZm9jdXMoKTsKICAgICAgfSwgMCk7CiAgICB9CgogICAgYnRuPy5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIHJ1bik7CiAgICBpbnB1dD8uYWRkRXZlbnRMaXN0ZW5lcigia2V5ZG93biIsIChlKSA9PiB7IGlmIChlLmtleSA9PT0gIkVudGVyIikgcnVuKCk7IH0pOwoKICAgIC8vIEtlZXAgcGxhY2Vob2xkZXIgYWxpZ25lZCB3aXRoIHRoZSBhY3RpdmUgdGFiLgogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCAoZSkgPT4gewogICAgICBjb25zdCB0YWJCdG4gPSBlLnRhcmdldC5jbG9zZXN0KCJbZGF0YS10YWItdGFyZ2V0XSIpOwogICAgICBpZiAoIXRhYkJ0biB8fCAhaW5wdXQpIHJldHVybjsKICAgICAgY29uc3QgdCA9IHRhYkJ0bi5kYXRhc2V0LnRhYlRhcmdldDsKICAgICAgaW5wdXQucGxhY2Vob2xkZXIgPSB0ID09PSAiZ2FtZXMiCiAgICAgICAgPyAiU2VhcmNoIGdhbWVzLi4uIgogICAgICAgIDogdCA9PT0gIm11c2ljIgogICAgICAgICAgPyAiU2VhcmNoIGlUdW5lcy4uLiIKICAgICAgICAgIDogIlNlYXJjaCBnYW1lcyBvciBtdXNpYy4uLiI7CiAgICB9KTsKICB9KSgpOwo8L3NjcmlwdD4KCiAgPCEtLSBHYW1lcyAtLT4KICAgICAgICA8c2VjdGlvbiBjbGFzcz0idGFiLXBhbmVsIiBkYXRhLXRhYj0iZ2FtZXMiPgogICAgICAgICAgPGRpdiBjbGFzcz0iZ2FtZXMtaGVhZGVyLXJvdyI+CiAgICAgICAgICAgIDxkaXY+CiAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZ2FtZXMtdGl0bGUiPkFsbCBnYW1lczwvZGl2PgogICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImZvbnQtc2l6ZTogMC44cmVtOyBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7Ij5TZWFyY2ggdGhlIGZlZWQgYW5kIGNsaWNrIGFueSB0aWxlIHRvIGxhdW5jaC48L2Rpdj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9InNlYXJjaC1iYXIiPgogICAgICAgICAgICAgIDxpbnB1dCBpZD0iZ2FtZS1zZWFyY2giIHR5cGU9InRleHQiIHBsYWNlaG9sZGVyPSJTZWFyY2ggZ2FtZXMuLi4iIC8+CiAgICAgICAgICAgICAgPHNwYW4+8J+UjTwvc3Bhbj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIDxkaXYgY2xhc3M9ImdhbWUtbGlzdCIgaWQ9ImdhbWUtbGlzdCI+PC9kaXY+CiAgICAgICAgPC9zZWN0aW9uPgoKICAgICAgICA8IS0tIFNvdW5kYm9hcmQgLS0+CiAgICAgICAgPHNlY3Rpb24gY2xhc3M9InRhYi1wYW5lbCIgZGF0YS10YWI9InNvdW5kYm9hcmQiPgogICAgICAgICAgPGRpdiBjbGFzcz0iZ2FtZXMtdGl0bGUiPlNvdW5kIEJvYXJkPC9kaXY+CiAgICAgICAgICA8ZGl2IHN0eWxlPSJmb250LXNpemU6IDAuOHJlbTsgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyBtYXJnaW4tYm90dG9tOiA2cHg7Ij5UYXAgYSBwYWQgZm9yIGluc3RhbnQgYXJjYWRlIHNvdW5kcy48L2Rpdj4KICAgICAgICAgIDxkaXYgaWQ9InNvdW5kYm9hcmQtZ3JpZCIgY2xhc3M9InNvdW5kYm9hcmQtZ3JpZCI+PC9kaXY+CiAgICAgICAgPC9zZWN0aW9uPgoKICAgICAgICA8IS0tIE11c2ljIC0tPgogICAgICAgIDxzZWN0aW9uIGNsYXNzPSJ0YWItcGFuZWwiIGRhdGEtdGFiPSJtdXNpYyI+CiAgICAgICAgICA8ZGl2IGNsYXNzPSJtdXNpYy1oZXJvIj4KICAgICAgICAgICAgPGRpdj4KICAgICAgICAgICAgICA8aDI+R2FsYXh5IE11c2ljIEh1YjwvaDI+CiAgICAgICAgICAgICAgPHA+U3RyZWFtIDMwLXNlY29uZCBwcmV2aWV3cyBmcm9tIGlUdW5lcy4gTW9udGhseSBwaWNrcyBhbmQgc2VhcmNoIGluIG9uZSBwbGFjZS48L3A+CiAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibXVzaWMtcGlsbHMiPgogICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9Im11c2ljLXBpbGwiPmlUdW5lcyBzZWFyY2g8L3NwYW4+CiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ibXVzaWMtcGlsbCI+UHJldmlldyBzbmlwcGV0czwvc3Bhbj4KICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJtdXNpYy1waWxsIj5Nb250aGx5IHNwb3RsaWdodDwvc3Bhbj4KICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9Im11c2ljLWNhcmQiPgogICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im11c2ljLWNhcmQtaGVhZGVyIj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im11c2ljLXRodW1iIj5OT1c8L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im11c2ljLW1ldGEiPgogICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJtdXNpYy10aXRsZSI+TW9udGhseSBTcG90bGlnaHQ8L2Rpdj4KICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibXVzaWMtYXJ0aXN0Ij5IYW5kLXBpY2tlZCBkcm9wcyBmb3IgdGhpcyBtb250aDwvZGl2PgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibXVzaWMtYWN0aW9ucyI+CiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJtdXNpYy1idG4gcHJpbWFyeSIgaWQ9Im11c2ljLXJlZnJlc2giPlJlZnJlc2ggcGlja3M8L2J1dHRvbj4KICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIDxkaXYgc3R5bGU9ImRpc3BsYXk6ZmxleDsganVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47IGFsaWduLWl0ZW1zOmNlbnRlcjsgZ2FwOjEwcHg7IGZsZXgtd3JhcDp3cmFwOyBtYXJnaW4tdG9wOjEycHg7Ij4KICAgICAgICAgICAgPGRpdiBjbGFzcz0iZ2FtZXMtdGl0bGUiPk1vbnRobHkgc29uZ3M8L2Rpdj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0ibXVzaWMtc3ViIj5EYXJrIFRob3VnaHRzIMK3IE1vbnRhZ2VtIFJlYm9sYSDCtyBSYW5zb20gwrcgSGVhZHNob3Q8L2Rpdj4KICAgICAgICAgIDwvZGl2PgogICAgICAgICAgPGRpdiBjbGFzcz0ibXVzaWMtZ3JpZCIgaWQ9Im11c2ljLW1vbnRobHkiPjwvZGl2PgogICAgICAgICAgPGRpdiBzdHlsZT0ibWFyZ2luLXRvcDoxOHB4OyI+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImdhbWVzLXRpdGxlIj5TZWFyY2ggaVR1bmVzPC9kaXY+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9Im11c2ljLWZpZWxkIiBzdHlsZT0ibWFyZ2luLXRvcDo2cHg7Ij4KICAgICAgICAgICAgICA8aW5wdXQgaWQ9Im11c2ljLXNlYXJjaCIgdHlwZT0idGV4dCIgcGxhY2Vob2xkZXI9IlNlYXJjaCBpVHVuZXMgKGUuZy4sIExpbCBUZWNjYSkiIC8+CiAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0ibXVzaWMtYnRuIHByaW1hcnkiIGlkPSJtdXNpYy1zZWFyY2gtYnRuIj5TZWFyY2g8L2J1dHRvbj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIDxkaXYgY2xhc3M9Im11c2ljLWdyaWQiIGlkPSJtdXNpYy1yZXN1bHRzIiBzdHlsZT0ibWFyZ2luLXRvcDoxMnB4OyI+PC9kaXY+CiAgICAgICAgICA8ZGl2IGNsYXNzPSJtdXNpYy1lbXB0eSIgaWQ9Im11c2ljLWVtcHR5IiBzdHlsZT0iZGlzcGxheTpub25lOyI+Tm8gc29uZ3MgeWV0LiBUcnkgYSBzZWFyY2guPC9kaXY+CiAgICAgICAgPC9zZWN0aW9uPgoKICAgICAgICA8IS0tIFRWIC0tPgogICAgICAgIDxzZWN0aW9uIGNsYXNzPSJ0YWItcGFuZWwiIGRhdGEtdGFiPSJ0ZWxldmlzaW9uIj4KICAgICAgICAgIDxkaXYgY2xhc3M9ImdhbWVzLXRpdGxlIj5UZWxldmlzaW9uPC9kaXY+CiAgICAgICAgICA8ZGl2IHN0eWxlPSJkaXNwbGF5OmdyaWQ7Z3JpZC10ZW1wbGF0ZS1jb2x1bW5zOnJlcGVhdChhdXRvLWZpdCxtaW5tYXgoNDIwcHgsMWZyKSk7Z2FwOjE2cHg7Ij4KICAgICAgICAgICAgPGRpdj4KICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJmb250LXdlaWdodDo2MDA7bWFyZ2luLWJvdHRvbTo2cHg7Ij5EaXNuZXk8L2Rpdj4KICAgICAgICAgICAgICA8aWZyYW1lIHNyYz0iaHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vcHJlc2VudGF0aW9uL2QvMWNxTW9TN3JOdk9YNzc5MzhHdXNkV05pNm1ZVlBPZkVUQ1ZzQVZXOUk5cHMvcHJldmlldz9zbGlkZT1pZC5nMmNhYTE4MDRmMWZfMF83MSIgc3R5bGU9IndpZHRoOjEwMCU7aGVpZ2h0OjMyMHB4O2JvcmRlci1yYWRpdXM6MTRweDtib3JkZXI6MXB4IHNvbGlkIHJnYmEoMTQ4LDE2MywxODQsMC4yKTsiIGFsbG93ZnVsbHNjcmVlbj48L2lmcmFtZT4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDxkaXY+CiAgICAgICAgICAgICAgPGRpdiBzdHlsZT0iZm9udC13ZWlnaHQ6NjAwO21hcmdpbi1ib3R0b206NnB4OyI+UGFyYW1vdW50PC9kaXY+CiAgICAgICAgICAgICAgPGlmcmFtZSBzcmM9Imh0dHBzOi8vZG9jcy5nb29nbGUuY29tL3ByZXNlbnRhdGlvbi9kLzFDaVpNZEJtNjc3TTdFSXVzN2dUODlXUHh3WVB6WEpRZ3dtWEd2M3NMQWF3L3ByZXZpZXc/c2xpZGU9aWQuZzFiNzFmOGJkYjNjXzJfNzciIHN0eWxlPSJ3aWR0aDoxMDAlO2hlaWdodDozMjBweDtib3JkZXItcmFkaXVzOjE0cHg7Ym9yZGVyOjFweCBzb2xpZCByZ2JhKDE0OCwxNjMsMTg0LDAuMik7IiBhbGxvd2Z1bGxzY3JlZW4+PC9pZnJhbWU+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9zZWN0aW9uPgoKICAgICAgICA8IS0tIEFib3V0IC0tPgogICAgICAgIDxzZWN0aW9uIGNsYXNzPSJ0YWItcGFuZWwiIGRhdGEtdGFiPSJhYm91dCI+CiAgICAgICAgICA8ZGl2IGNsYXNzPSJnYW1lcy10aXRsZSI+QWJvdXQgdGhpcyBsYXVuY2hlcjwvZGl2PgogICAgICAgICAgPGRpdiBjbGFzcz0iYWJvdXQtdGV4dCI+CiAgICAgICAgICAgIEdhbGF4eSBHYW1lcyBsb2FkcyBnYW1lcyBmcm9tIGEgcHVibGljIEpTT04gZmVlZCBhbmQgcGxheXMgaVR1bmVzIHByZXZpZXdzLiBFdmVyeXRoaW5nIHJ1bnMgaW4geW91ciBicm93c2VyIOKAlCBubyBhY2NvdW50cywgbm8gdHJhY2tpbmcuCiAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L3NlY3Rpb24+CiAgICAgIDwvZGl2PgogICAgPC9tYWluPgogIDwvZGl2PgoKICA8IS0tIFRhYiBTeXN0ZW0gLS0+CiAgPHNjcmlwdD4KICAgIChmdW5jdGlvbigpIHsKICAgICAgZnVuY3Rpb24gc2V0QWN0aXZlKHRhYikgewogICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLXRhYl0nKS5mb3JFYWNoKHAgPT4gcC5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnLCBwLmRhdGFzZXQudGFiID09PSB0YWIpKTsKICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS10YWItdGFyZ2V0XScpLmZvckVhY2goYiA9PiBiLmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScsIGIuZGF0YXNldC50YWJUYXJnZXQgPT09IHRhYikpOwogICAgICB9CiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiB7CiAgICAgICAgY29uc3QgYnRuID0gZS50YXJnZXQuY2xvc2VzdCgnW2RhdGEtdGFiLXRhcmdldF0nKTsKICAgICAgICBpZiAoYnRuKSBzZXRBY3RpdmUoYnRuLmRhdGFzZXQudGFiVGFyZ2V0KTsKICAgICAgICBjb25zdCBqdW1wID0gZS50YXJnZXQuY2xvc2VzdCgnW2RhdGEtdGFiLWp1bXBdJyk7CiAgICAgICAgaWYgKGp1bXApIHNldEFjdGl2ZShqdW1wLmRhdGFzZXQudGFiSnVtcCk7CiAgICAgIH0pOwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaG9tZS1zdGFydC1idG4nKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgICAgICAgc2V0QWN0aXZlKCdnYW1lcycpOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdnYW1lLXNlYXJjaCcpPy5mb2N1cygpOwogICAgICB9KTsKICAgIH0pKCk7CiAgPC9zY3JpcHQ+CgogIDwhLS0gR2FtZXMgLS0+CiAgPHNjcmlwdD4KICAgIChmdW5jdGlvbigpIHsKICAgICAgY29uc3QgWk9ORVNfVVJMID0gImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9Ob3RyZXhlZC9hc3NldHNAbGF0ZXN0L2FsbHpvbmUuanNvbiI7CiAgICAgIGNvbnN0IENPVkVSX1VSTCA9ICJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvTm90cmV4ZWQvY292ZXJzQG1haW4iOwogICAgICBjb25zdCBIVE1MX1VSTCA9ICJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvTm90cmV4ZWQvaHRtbEBsYXRlc3QiOwogICAgICBjb25zdCBnYW1lTGlzdEVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImdhbWUtbGlzdCIpOwogICAgICBjb25zdCBzZWFyY2hJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJnYW1lLXNlYXJjaCIpOwogICAgICBsZXQgem9uZXMgPSBbXTsKICAgICAgbGV0IGZpbHRlcmVkID0gW107CgogICAgICBmdW5jdGlvbiBjcmVhdGVPdmVybGF5KCkgewogICAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZ2FtZS1vdmVybGF5IikpIHJldHVybjsKICAgICAgICBjb25zdCBvdmVybGF5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgICAgb3ZlcmxheS5pZCA9ICJnYW1lLW92ZXJsYXkiOwogICAgICAgIG92ZXJsYXkuc3R5bGUuY3NzVGV4dCA9IGBwb3NpdGlvbjpmaXhlZDtpbnNldDowO2JhY2tncm91bmQ6cmdiYSgwLDAsMCwwLjk0KTtiYWNrZHJvcC1maWx0ZXI6Ymx1cigxMHB4KTtkaXNwbGF5Om5vbmU7YWxpZ24taXRlbXM6c3RyZXRjaDtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO3otaW5kZXg6OTk5OTtgOwogICAgICAgIGNvbnN0IGlmcmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImlmcmFtZSIpOwogICAgICAgIGlmcmFtZS5pZCA9ICJnYW1lLWZyYW1lIjsKICAgICAgICBpZnJhbWUuc3R5bGUuY3NzVGV4dCA9ICJib3JkZXI6bm9uZTt3aWR0aDoxMDAlO2hlaWdodDoxMDAlO2JhY2tncm91bmQ6IzAwMDsiOwogICAgICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoImFsbG93IiwgImFjY2VsZXJvbWV0ZXI7IGF1dG9wbGF5OyBmdWxsc2NyZWVuOyBjbGlwYm9hcmQtcmVhZDsgY2xpcGJvYXJkLXdyaXRlOyBnYW1lcGFkOyIpOwogICAgICAgIGlmcmFtZS5yZWZlcnJlclBvbGljeSA9ICJuby1yZWZlcnJlciI7CiAgICAgICAgY29uc3QgY2xvc2VCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJidXR0b24iKTsKICAgICAgICBjbG9zZUJ0bi50ZXh0Q29udGVudCA9ICLDlyI7CiAgICAgICAgY2xvc2VCdG4uc3R5bGUuY3NzVGV4dCA9IGBwb3NpdGlvbjpmaXhlZDt0b3A6MThweDtyaWdodDoyNHB4O3dpZHRoOjM2cHg7aGVpZ2h0OjM2cHg7Ym9yZGVyLXJhZGl1czo5OTlweDtib3JkZXI6bm9uZTtiYWNrZ3JvdW5kOnJnYmEoMTUsMjMsNDIsMC44NSk7Y29sb3I6I2U1ZTdlYjtmb250LXNpemU6MjJweDtjdXJzb3I6cG9pbnRlcjt6LWluZGV4OjEwMDAwO2A7CiAgICAgICAgY2xvc2VCdG4ub25jbGljayA9ICgpID0+IG92ZXJsYXkuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICBvdmVybGF5LmFwcGVuZENoaWxkKGlmcmFtZSk7CiAgICAgICAgb3ZlcmxheS5hcHBlbmRDaGlsZChjbG9zZUJ0bik7CgogICAgICAgIC8vIEZhbGxiYWNrIC8gRG93bmxvYWQgcGFuZWwgKHNob3duIGlmIGEgZ2FtZSBmYWlscyB0byBsb2FkIG9yIHVzZXIgd2FudHMgYW4gb2ZmbGluZSBjb3B5KQogICAgICAgIGNvbnN0IGZhbGxiYWNrID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgICAgZmFsbGJhY2suaWQgPSAiZ2FtZS1mYWxsYmFjayI7CiAgICAgICAgZmFsbGJhY2suc3R5bGUuY3NzVGV4dCA9IGAKICAgICAgICAgIHBvc2l0aW9uOmZpeGVkOwogICAgICAgICAgbGVmdDo1MCU7CiAgICAgICAgICBib3R0b206MThweDsKICAgICAgICAgIHRyYW5zZm9ybTp0cmFuc2xhdGVYKC01MCUpOwogICAgICAgICAgbWF4LXdpZHRoOm1pbig3MjBweCwgY2FsYygxMDB2dyAtIDI0cHgpKTsKICAgICAgICAgIHdpZHRoOmZpdC1jb250ZW50OwogICAgICAgICAgcGFkZGluZzoxMnB4IDE0cHg7CiAgICAgICAgICBib3JkZXItcmFkaXVzOjE0cHg7CiAgICAgICAgICBib3JkZXI6MXB4IHNvbGlkIHJnYmEoMTQ4LDE2MywxODQsMC4zNSk7CiAgICAgICAgICBiYWNrZ3JvdW5kOnJnYmEoMTUsMjMsNDIsMC45Mik7CiAgICAgICAgICBib3gtc2hhZG93OjAgMThweCA2MHB4IHJnYmEoMCwwLDAsMC41NSk7CiAgICAgICAgICBkaXNwbGF5Om5vbmU7CiAgICAgICAgICB6LWluZGV4OjEwMDAxOwogICAgICAgIGA7CiAgICAgICAgZmFsbGJhY2suaW5uZXJIVE1MID0gYAogICAgICAgICAgPGRpdiBzdHlsZT0iZGlzcGxheTpmbGV4O2dhcDoxMnB4O2FsaWduLWl0ZW1zOmNlbnRlcjtmbGV4LXdyYXA6d3JhcDsiPgogICAgICAgICAgICA8ZGl2IHN0eWxlPSJtaW4td2lkdGg6MjIwcHg7Ij4KICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJmb250LXdlaWdodDo3MDA7Zm9udC1zaXplOjAuOTJyZW07Ij5IYXZpbmcgdHJvdWJsZSBsb2FkaW5nIHRoaXMgZ2FtZT88L2Rpdj4KICAgICAgICAgICAgICA8ZGl2IGlkPSJnYW1lLWZhbGxiYWNrLW1zZyIgc3R5bGU9ImNvbG9yOnJnYmEoMTU2LDE2MywxNzUsMC45NSk7Zm9udC1zaXplOjAuODJyZW07bWFyZ2luLXRvcDoycHg7Ij4KICAgICAgICAgICAgICAgIElmIGl0IGRvZXNu4oCZdCB3b3JrLCBkb3dubG9hZCB0aGUgSFRNTCBhbmQgb3BlbiBpdCBsb2NhbGx5LgogICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPGRpdiBzdHlsZT0iZGlzcGxheTpmbGV4O2dhcDo4cHg7ZmxleC13cmFwOndyYXA7YWxpZ24taXRlbXM6Y2VudGVyO21hcmdpbi1sZWZ0OmF1dG87Ij4KICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJnYW1lLWRvd25sb2FkLWJ0biIgc3R5bGU9InBhZGRpbmc6OHB4IDEwcHg7Ym9yZGVyLXJhZGl1czoxMnB4O2JvcmRlcjpub25lO2N1cnNvcjpwb2ludGVyO2ZvbnQtd2VpZ2h0OjcwMDtiYWNrZ3JvdW5kOmxpbmVhci1ncmFkaWVudCgxMzVkZWcsIHZhcigtLWFjY2VudCksIHZhcigtLWFjY2VudC0yKSk7Y29sb3I6IzAyMDYxNzsiPgogICAgICAgICAgICAgICAgRG93bmxvYWQgSFRNTAogICAgICAgICAgICAgIDwvYnV0dG9uPgogICAgICAgICAgICAgIDxhIGlkPSJnYW1lLW9wZW4tc291cmNlIiBocmVmPSIjIiB0YXJnZXQ9Il9ibGFuayIgcmVsPSJub29wZW5lciIgc3R5bGU9InBhZGRpbmc6OHB4IDEwcHg7Ym9yZGVyLXJhZGl1czoxMnB4O2JvcmRlcjoxcHggc29saWQgcmdiYSgxNDgsMTYzLDE4NCwwLjM1KTtiYWNrZ3JvdW5kOnJnYmEoMTUsMjMsNDIsMC44NSk7Y29sb3I6dmFyKC0tdGV4dC1tYWluKTt0ZXh0LWRlY29yYXRpb246bm9uZTsiPgogICAgICAgICAgICAgICAgT3BlbiBzb3VyY2UKICAgICAgICAgICAgICA8L2E+CiAgICAgICAgICAgICAgPGJ1dHRvbiBpZD0iZ2FtZS1jbG9zZS1mYWxsYmFjayIgc3R5bGU9InBhZGRpbmc6OHB4IDEwcHg7Ym9yZGVyLXJhZGl1czoxMnB4O2JvcmRlcjoxcHggc29saWQgcmdiYSgxNDgsMTYzLDE4NCwwLjM1KTtiYWNrZ3JvdW5kOnJnYmEoMTUsMjMsNDIsMC44NSk7Y29sb3I6dmFyKC0tdGV4dC1tYWluKTtjdXJzb3I6cG9pbnRlcjsiPgogICAgICAgICAgICAgICAgRGlzbWlzcwogICAgICAgICAgICAgIDwvYnV0dG9uPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIDwvZGl2PgogICAgICAgIGA7CiAgICAgICAgZmFsbGJhY2sucXVlcnlTZWxlY3RvcigiI2dhbWUtY2xvc2UtZmFsbGJhY2siKS5vbmNsaWNrID0gKCkgPT4gKGZhbGxiYWNrLnN0eWxlLmRpc3BsYXkgPSAibm9uZSIpOwogICAgICAgIG92ZXJsYXkuYXBwZW5kQ2hpbGQoZmFsbGJhY2spOwogICAgICAgIG92ZXJsYXkub25jbGljayA9IGUgPT4geyBpZiAoZS50YXJnZXQgPT09IG92ZXJsYXkpIG92ZXJsYXkuc3R5bGUuZGlzcGxheSA9ICJub25lIjsgfTsKICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJrZXlkb3duIiwgZSA9PiB7IGlmIChlLmtleSA9PT0gIkVzY2FwZSIpIG92ZXJsYXkuc3R5bGUuZGlzcGxheSA9ICJub25lIjsgfSk7CiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChvdmVybGF5KTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gb3BlbkdhbWUoem9uZSkgewogICAgICAgIGlmICghem9uZSkgcmV0dXJuOwogICAgICAgIGNyZWF0ZU92ZXJsYXkoKTsKICAgICAgICBjb25zdCBvdmVybGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImdhbWUtb3ZlcmxheSIpOwogICAgICAgIGNvbnN0IGlmcmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJnYW1lLWZyYW1lIik7CiAgICAgICAgY29uc3QgZmFsbGJhY2sgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZ2FtZS1mYWxsYmFjayIpOwogICAgICAgIGNvbnN0IGRvd25sb2FkQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImdhbWUtZG93bmxvYWQtYnRuIik7CiAgICAgICAgY29uc3Qgb3BlblNvdXJjZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJnYW1lLW9wZW4tc291cmNlIik7CiAgICAgICAgY29uc3QgbXNnID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImdhbWUtZmFsbGJhY2stbXNnIik7CgogICAgICAgIG92ZXJsYXkuc3R5bGUuZGlzcGxheSA9ICJmbGV4IjsKICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gImhpZGRlbiI7CgogICAgICAgIC8vIFJlc2V0IGZhbGxiYWNrIFVJCiAgICAgICAgaWYgKGZhbGxiYWNrKSBmYWxsYmFjay5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICAgIGlmIChtc2cpIG1zZy50ZXh0Q29udGVudCA9ICJJZiBpdCBkb2VzbuKAmXQgd29yaywgZG93bmxvYWQgdGhlIEhUTUwgYW5kIG9wZW4gaXQgbG9jYWxseS4iOwoKICAgICAgICBjb25zdCB1cmwgPSAoem9uZS51cmwgfHwgIiIpLnJlcGxhY2UoIntIVE1MX1VSTH0iLCBIVE1MX1VSTCkucmVwbGFjZSgie0NPVkVSX1VSTH0iLCBDT1ZFUl9VUkwpOwogICAgICAgIGxldCBsYXN0SHRtbCA9ICIiOwogICAgICAgIGxldCBsYXN0RmlsZW5hbWUgPSAoem9uZS5uYW1lIHx8ICJnYW1lIikudG9TdHJpbmcoKS50cmltKCkgfHwgImdhbWUiOwoKICAgICAgICAvLyBTYWZlciBmaWxlbmFtZQogICAgICAgIGxhc3RGaWxlbmFtZSA9IGxhc3RGaWxlbmFtZQogICAgICAgICAgLnJlcGxhY2UoL1teYS16MC05XC1cXyBdL2dpLCAiIikKICAgICAgICAgIC5yZXBsYWNlKC9ccysvZywgIl8iKQogICAgICAgICAgLnNsaWNlKDAsIDYwKSB8fCAiZ2FtZSI7CgogICAgICAgIGZ1bmN0aW9uIGRvd25sb2FkSHRtbChmaWxlbmFtZSwgaHRtbFRleHQpIHsKICAgICAgICAgIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbaHRtbFRleHRdLCB7IHR5cGU6ICJ0ZXh0L2h0bWw7Y2hhcnNldD11dGYtOCIgfSk7CiAgICAgICAgICBjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYSIpOwogICAgICAgICAgYS5ocmVmID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTsKICAgICAgICAgIGEuZG93bmxvYWQgPSBmaWxlbmFtZSArICIuaHRtbCI7CiAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGEpOwogICAgICAgICAgYS5jbGljaygpOwogICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwoYS5ocmVmKTsKICAgICAgICAgICAgYS5yZW1vdmUoKTsKICAgICAgICAgIH0sIDApOwogICAgICAgIH0KCiAgICAgICAgaWYgKG9wZW5Tb3VyY2UpIG9wZW5Tb3VyY2UuaHJlZiA9IHVybDsKCiAgICAgICAgLy8gRG93bmxvYWQgYnV0dG9uIGJlaGF2aW9yOgogICAgICAgIC8vIC0gSWYgd2UgYWxyZWFkeSBoYXZlIHRoZSBIVE1MLCBkb3dubG9hZCBpbW1lZGlhdGVseS4KICAgICAgICAvLyAtIE90aGVyd2lzZSwgdHJ5IHRvIGZldGNoIGFuZCB0aGVuIGRvd25sb2FkLgogICAgICAgIGlmIChkb3dubG9hZEJ0bikgewogICAgICAgICAgZG93bmxvYWRCdG4ub25jbGljayA9IGFzeW5jICgpID0+IHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBpZiAobGFzdEh0bWwpIHsKICAgICAgICAgICAgICAgIGRvd25sb2FkSHRtbChsYXN0RmlsZW5hbWUsIGxhc3RIdG1sKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2godXJsLCB7IGNhY2hlOiAibm8tc3RvcmUiIH0pOwogICAgICAgICAgICAgIGNvbnN0IGh0bWwgPSBhd2FpdCByZXMudGV4dCgpOwogICAgICAgICAgICAgIGxhc3RIdG1sID0gaHRtbDsKICAgICAgICAgICAgICBkb3dubG9hZEh0bWwobGFzdEZpbGVuYW1lLCBsYXN0SHRtbCk7CiAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICAgIGlmIChmYWxsYmFjaykgZmFsbGJhY2suc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CiAgICAgICAgICAgICAgaWYgKG1zZykgbXNnLnRleHRDb250ZW50ID0gIkRvd25sb2FkIGZhaWxlZC4gVHJ5IG9wZW5pbmcgdGhlIHNvdXJjZSBpbnN0ZWFkLiI7CiAgICAgICAgICAgIH0KICAgICAgICAgIH07CiAgICAgICAgfQoKICAgICAgICAvLyBMb2FkIGludG8gaWZyYW1lICh0aW1lb3V0IGhlbHBzIGRldGVjdCBibG9ja2VkIGZldGNoZXMgLyBzbG93IG5ldHdvcmtzKQogICAgICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7CiAgICAgICAgY29uc3QgdGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4gY29udHJvbGxlci5hYm9ydCgpLCAxMjAwMCk7CgogICAgICAgIGZldGNoKHVybCwgeyBzaWduYWw6IGNvbnRyb2xsZXIuc2lnbmFsLCBjYWNoZTogIm5vLXN0b3JlIiB9KQogICAgICAgICAgLnRoZW4ocmVzID0+IHJlcy50ZXh0KCkpCiAgICAgICAgICAudGhlbihodG1sID0+IHsKICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpOwogICAgICAgICAgICBsYXN0SHRtbCA9IGh0bWw7CgogICAgICAgICAgICBjb25zdCBkb2MgPSBpZnJhbWUuY29udGVudFdpbmRvdy5kb2N1bWVudDsKICAgICAgICAgICAgZG9jLm9wZW4oKTsKICAgICAgICAgICAgZG9jLndyaXRlKGh0bWwpOwogICAgICAgICAgICBkb2MuY2xvc2UoKTsKCiAgICAgICAgICAgIC8vIEFsd2F5cyBhbGxvdyB0aGUgdXNlciB0byBkb3dubG9hZCBhIGxvY2FsIGNvcHksIGV2ZW4gaWYgaXQgbG9hZGVkLgogICAgICAgICAgICBpZiAoZmFsbGJhY2spIGZhbGxiYWNrLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgICAgICAgfSkKICAgICAgICAgIC5jYXRjaCgoKSA9PiB7CiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBpZnJhbWUuY29udGVudFdpbmRvdy5kb2N1bWVudC5ib2R5LmlubmVySFRNTCA9ICI8ZGl2IHN0eWxlPSdjb2xvcjojZTVlN2ViO2ZvbnQtZmFtaWx5OnN5c3RlbS11aTtwYWRkaW5nOjE4cHg7Jz5GYWlsZWQgdG8gbG9hZCBnYW1lLjwvZGl2PiI7CiAgICAgICAgICAgIH0gY2F0Y2gge30KICAgICAgICAgICAgaWYgKGZhbGxiYWNrKSBmYWxsYmFjay5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgICAgICAgaWYgKG1zZykgbXNnLnRleHRDb250ZW50ID0gIlRoaXMgZ2FtZSBkaWQgbm90IGxvYWQgaW4geW91ciBicm93c2VyLiBVc2UgRG93bmxvYWQgSFRNTCBvciBPcGVuIHNvdXJjZS4iOwogICAgICAgICAgfSk7CiAgICAgIH0KCgogICAgICBmdW5jdGlvbiByZW5kZXIobGlzdCkgewogICAgICAgIGdhbWVMaXN0RWwuaW5uZXJIVE1MID0gIiI7CiAgICAgICAgbGlzdC5mb3JFYWNoKHogPT4gewogICAgICAgICAgaWYgKCh6Lm5hbWUgfHwgIiIpLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoIm92byIpIHx8IHouaWQgPT09IC0xKSByZXR1cm47CiAgICAgICAgICBjb25zdCBjYXJkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgICAgICBjYXJkLmNsYXNzTmFtZSA9ICJnYW1lLWNhcmQiOwogICAgICAgICAgY29uc3QgY292ZXIgPSAoei5jb3ZlciB8fCAiIikucmVwbGFjZSgie0NPVkVSX1VSTH0iLCBDT1ZFUl9VUkwpLnJlcGxhY2UoIntIVE1MX1VSTH0iLCBIVE1MX1VSTCk7CiAgICAgICAgICBjYXJkLmlubmVySFRNTCA9IGAKICAgICAgICAgICAgPGRpdiBjbGFzcz0iZ2FtZS10b3Atcm93Ij4KICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJnYW1lLWljb24iICR7Y292ZXIgPyBgc3R5bGU9ImJhY2tncm91bmQtaW1hZ2U6dXJsKCR7Y292ZXJ9KSJgIDogIiJ9PiR7Y292ZXIgPyAiIiA6ICI/PyJ9PC9kaXY+CiAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZ2FtZS1ib2R5Ij4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImdhbWUtdGl0bGUiPiR7ei5uYW1lIHx8ICJVbnRpdGxlZCJ9PC9kaXY+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJnYW1lLWRlc2MiPiR7ei5hdXRob3IgfHwgIkNsaWNrIHRvIHBsYXkifTwvZGl2PgogICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0iZ2FtZS1hY3Rpb25zIj48YnV0dG9uIGNsYXNzPSJnYW1lLWJ1dHRvbiI+UGxheTwvYnV0dG9uPjwvZGl2PgogICAgICAgICAgYDsKICAgICAgICAgIGNhcmQub25jbGljayA9ICgpID0+IG9wZW5HYW1lKHopOwogICAgICAgICAgY2FyZC5xdWVyeVNlbGVjdG9yKCIuZ2FtZS1idXR0b24iKS5vbmNsaWNrID0gZSA9PiB7IGUuc3RvcFByb3BhZ2F0aW9uKCk7IG9wZW5HYW1lKHopOyB9OwogICAgICAgICAgZ2FtZUxpc3RFbC5hcHBlbmRDaGlsZChjYXJkKTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gZmlsdGVyKHEpIHsKICAgICAgICBpZiAoIXpvbmVzIHx8IHpvbmVzLmxlbmd0aCA9PT0gMCkgcmV0dXJuOwogICAgICAgIHEgPSBxLnRyaW0oKS50b0xvd2VyQ2FzZSgpOwogICAgICAgIGZpbHRlcmVkID0gcSA/IHpvbmVzLmZpbHRlcih6ID0+ICh6Lm5hbWUgfHwgIiIpLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMocSkpIDogem9uZXM7CiAgICAgICAgcmVuZGVyKGZpbHRlcmVkKTsKICAgICAgfQoKICAgICAgYXN5bmMgZnVuY3Rpb24gaW5pdCgpIHsKICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChaT05FU19VUkwgKyAiP3Q9IiArIERhdGUubm93KCkpOwogICAgICAgIHpvbmVzID0gYXdhaXQgcmVzLmpzb24oKTsKICAgICAgICByZW5kZXIoem9uZXMpOwogICAgICAgIHNlYXJjaElucHV0Py5hZGRFdmVudExpc3RlbmVyKCJpbnB1dCIsIGUgPT4gZmlsdGVyKGUudGFyZ2V0LnZhbHVlKSk7CiAgICAgIH0KCiAgICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlID09PSAibG9hZGluZyIpIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLCBpbml0KTsKICAgICAgZWxzZSBpbml0KCk7CiAgICB9KSgpOwogIDwvc2NyaXB0PgoKICA8IS0tIFNvdW5kYm9hcmQgLS0+CiAgPHNjcmlwdD4KICAgIChmdW5jdGlvbiAoKSB7CiAgICAgIGNvbnN0IHBhZHMgPSBbCiAgICAgICAgeyBsYWJlbDogIkxhc2VyIFN3ZWVwIiwgdGFnOiAiQXJjYWRlIiwgdG9uZXM6IFt7IGZyZXE6IDc2MCwgZHVyYXRpb246IDAuMTggfSwgeyBmcmVxOiAyODAsIGR1cmF0aW9uOiAwLjIyLCBkZWxheTogMC4wMiB9XSB9LAogICAgICAgIHsgbGFiZWw6ICJDb2luIFBpY2t1cCIsIHRhZzogIlJldHJvIiwgdG9uZXM6IFt7IGZyZXE6IDk4MCwgZHVyYXRpb246IDAuMTIgfSwgeyBmcmVxOiAxMjgwLCBkdXJhdGlvbjogMC4xNiwgZGVsYXk6IDAuMDIgfV0gfSwKICAgICAgICB7IGxhYmVsOiAiQWlyIEhvcm4iLCB0YWc6ICJIeXBlIiwgdG9uZXM6IFt7IGZyZXE6IDIyMCwgZHVyYXRpb246IDAuNDUgfV0gfSwKICAgICAgICB7IGxhYmVsOiAiUGluZyIsIHRhZzogIkFsZXJ0IiwgdG9uZXM6IFt7IGZyZXE6IDY2MCwgZHVyYXRpb246IDAuMTIgfSwgeyBmcmVxOiA4ODAsIGR1cmF0aW9uOiAwLjE2LCBkZWxheTogMC4wNSB9XSB9LAogICAgICBdOwogICAgICBjb25zdCBncmlkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInNvdW5kYm9hcmQtZ3JpZCIpOwogICAgICBsZXQgYXVkaW9DdHggPSBudWxsOwoKICAgICAgZnVuY3Rpb24gcGxheSh0b25lcykgewogICAgICAgIGlmICghYXVkaW9DdHgpIHsKICAgICAgICAgIGNvbnN0IEN0eCA9IHdpbmRvdy5BdWRpb0NvbnRleHQgfHwgd2luZG93LndlYmtpdEF1ZGlvQ29udGV4dDsKICAgICAgICAgIGlmICghQ3R4KSByZXR1cm47CiAgICAgICAgICBhdWRpb0N0eCA9IG5ldyBDdHgoKTsKICAgICAgICB9CiAgICAgICAgaWYgKGF1ZGlvQ3R4LnN0YXRlID09PSAic3VzcGVuZGVkIikgYXVkaW9DdHgucmVzdW1lKCk7CiAgICAgICAgbGV0IHQgPSBhdWRpb0N0eC5jdXJyZW50VGltZTsKICAgICAgICB0b25lcy5mb3JFYWNoKCh7IGZyZXEsIGR1cmF0aW9uLCBkZWxheSA9IDAgfSkgPT4gewogICAgICAgICAgY29uc3QgbyA9IGF1ZGlvQ3R4LmNyZWF0ZU9zY2lsbGF0b3IoKTsKICAgICAgICAgIGNvbnN0IGcgPSBhdWRpb0N0eC5jcmVhdGVHYWluKCk7CiAgICAgICAgICBvLnR5cGUgPSAic2luZSI7CiAgICAgICAgICBvLmZyZXF1ZW5jeS5zZXRWYWx1ZUF0VGltZShmcmVxLCB0KTsKICAgICAgICAgIGcuZ2Fpbi5zZXRWYWx1ZUF0VGltZSgwLjAwMSwgdCk7CiAgICAgICAgICBnLmdhaW4uZXhwb25lbnRpYWxSYW1wVG9WYWx1ZUF0VGltZSgwLjM1LCB0ICsgMC4wMik7CiAgICAgICAgICBnLmdhaW4uZXhwb25lbnRpYWxSYW1wVG9WYWx1ZUF0VGltZSgwLjAwMSwgdCArIGR1cmF0aW9uKTsKICAgICAgICAgIG8uY29ubmVjdChnKS5jb25uZWN0KGF1ZGlvQ3R4LmRlc3RpbmF0aW9uKTsKICAgICAgICAgIG8uc3RhcnQodCk7IG8uc3RvcCh0ICsgZHVyYXRpb24gKyAwLjA1KTsKICAgICAgICAgIHQgKz0gZHVyYXRpb24gKyBkZWxheTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgaWYgKGdyaWQpIHsKICAgICAgICBncmlkLmlubmVySFRNTCA9ICIiOwogICAgICAgIHBhZHMuZm9yRWFjaChwYWQgPT4gewogICAgICAgICAgY29uc3QgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgICAgIGVsLmNsYXNzTmFtZSA9ICJzb3VuZC1wYWQiOwogICAgICAgICAgZWwuaW5uZXJIVE1MID0gYDxkaXYgY2xhc3M9InRhZyI+JHtwYWQudGFnfTwvZGl2PjxkaXYgY2xhc3M9InRpdGxlIj4ke3BhZC5sYWJlbH08L2Rpdj5gOwogICAgICAgICAgZWwub25jbGljayA9ICgpID0+IHBsYXkocGFkLnRvbmVzKTsKICAgICAgICAgIGdyaWQuYXBwZW5kQ2hpbGQoZWwpOwogICAgICAgIH0pOwogICAgICB9CiAgICB9KSgpOwogIDwvc2NyaXB0PgoKICA8IS0tIE11c2ljIC0tPgogIDxzY3JpcHQ+CiAgICAoZnVuY3Rpb24gKCkgewogICAgICBjb25zdCBtb250aGx5RWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibXVzaWMtbW9udGhseSIpOwogICAgICBjb25zdCByZXN1bHRzRWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibXVzaWMtcmVzdWx0cyIpOwogICAgICBjb25zdCBzZWFyY2hJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtdXNpYy1zZWFyY2giKTsKICAgICAgY29uc3Qgc2VhcmNoQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm11c2ljLXNlYXJjaC1idG4iKTsKICAgICAgY29uc3QgcmVmcmVzaEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtdXNpYy1yZWZyZXNoIik7CiAgICAgIGNvbnN0IGVtcHR5RWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibXVzaWMtZW1wdHkiKTsKCiAgICAgIGNvbnN0IE1PTlRITFlfUElDS1MgPSBbCiAgICAgICAgeyB0aXRsZTogIkRhcmsgVGhvdWdodHMiLCBhcnRpc3Q6ICJMaWwgVGVjY2EiIH0sCiAgICAgICAgeyB0aXRsZTogIk1vbnRhZ2VtIFJlYm9sYSIsIGFydGlzdDogIiIgfSwKICAgICAgICB7IHRpdGxlOiAiUmFuc29tIiwgYXJ0aXN0OiAiTGlsIFRlY2NhIiB9LAogICAgICAgIHsgdGl0bGU6ICJIZWFkc2hvdCAyMjMiLCBhcnRpc3Q6ICJJU2hvd1NwZWVkIiB9LAogICAgICBdOwoKICAgICAgbGV0IGF1ZGlvID0gbmV3IEF1ZGlvKCk7CiAgICAgIGxldCBjdXJyZW50QnRuID0gbnVsbDsKCiAgICAgIGF1ZGlvLmFkZEV2ZW50TGlzdGVuZXIoImVuZGVkIiwgKCkgPT4gewogICAgICAgIGlmIChjdXJyZW50QnRuKSB7CiAgICAgICAgICBzZXRCdG5TdGF0ZShjdXJyZW50QnRuLCBmYWxzZSk7CiAgICAgICAgICBjdXJyZW50QnRuID0gbnVsbDsKICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgZnVuY3Rpb24gZXNjYXBlSFRNTChzKSB7CiAgICAgICAgcmV0dXJuIFN0cmluZyhzIHx8ICIiKS5yZXBsYWNlKC8mL2csICImYW1wOyIpLnJlcGxhY2UoLzwvZywgIiZsdDsiKS5yZXBsYWNlKC8+L2csICImZ3Q7IikucmVwbGFjZSgvIi9nLCAiJnF1b3Q7IikucmVwbGFjZSgvJy9nLCAiJiMwMzk7Iik7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGluaXRpYWxzKHRpdGxlKSB7CiAgICAgICAgcmV0dXJuICh0aXRsZSB8fCAiTlciKS5zcGxpdCgiICIpLm1hcChwID0+IHAudHJpbSgpWzBdIHx8ICIiKS5qb2luKCIiKS5zbGljZSgwLCAyKS50b1VwcGVyQ2FzZSgpOwogICAgICB9CgogICAgICBmdW5jdGlvbiBzZXRCdG5TdGF0ZShidG4sIHBsYXlpbmcpIHsKICBpZiAoIWJ0bikgcmV0dXJuOwogIGJ0bi50ZXh0Q29udGVudCA9IHBsYXlpbmcgPyAiUGF1c2UgcHJldmlldyIgOiAiUGxheSBwcmV2aWV3IjsKICBidG4uZGlzYWJsZWQgPSBmYWxzZTsKICBidG4uc2V0QXR0cmlidXRlKCJhcmlhLXByZXNzZWQiLCBwbGF5aW5nID8gInRydWUiIDogImZhbHNlIik7Cn0KCiAgICAgIGZ1bmN0aW9uIGJpbmRQcmV2aWV3KGJ0biwgdHJhY2spIHsKICAgICAgICBpZiAoIWJ0biB8fCAhdHJhY2sucHJldmlld1VybCkgewogICAgICAgICAgaWYgKGJ0bikgewogICAgICAgICAgICBidG4udGV4dENvbnRlbnQgPSAiTm8gcHJldmlldyI7CiAgICAgICAgICAgIGJ0bi5kaXNhYmxlZCA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsICgpID0+IHsKICAgICAgICAgIGlmIChjdXJyZW50QnRuICYmIGN1cnJlbnRCdG4gIT09IGJ0bikgewogICAgICAgICAgICBzZXRCdG5TdGF0ZShjdXJyZW50QnRuLCBmYWxzZSk7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoY3VycmVudEJ0biA9PT0gYnRuICYmICFhdWRpby5wYXVzZWQpIHsKICAgICAgICAgICAgYXVkaW8ucGF1c2UoKTsKICAgICAgICAgICAgc2V0QnRuU3RhdGUoYnRuLCBmYWxzZSk7CiAgICAgICAgICAgIGN1cnJlbnRCdG4gPSBudWxsOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICBhdWRpby5zcmMgPSB0cmFjay5wcmV2aWV3VXJsOwogICAgICAgICAgYXVkaW8ucGxheSgpLnRoZW4oKCkgPT4gewogICAgICAgICAgICBjdXJyZW50QnRuID0gYnRuOwogICAgICAgICAgICBzZXRCdG5TdGF0ZShidG4sIHRydWUpOwogICAgICAgICAgfSkuY2F0Y2goKCkgPT4gewogICAgICAgICAgICBidG4udGV4dENvbnRlbnQgPSAiUHJldmlldyBibG9ja2VkIjsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9CgogICAgICBmdW5jdGlvbiBjYXJkRnJvbVRyYWNrKHRyYWNrKSB7CiAgICAgICAgY29uc3QgY2FyZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICAgIGNhcmQuY2xhc3NOYW1lID0gIm11c2ljLWNhcmQiOwogICAgICAgIGNvbnN0IGFydEhUTUwgPSB0cmFjay5hcnQKICAgICAgICAgID8gYDxpbWcgc3JjPSIke2VzY2FwZUhUTUwodHJhY2suYXJ0KX0iPmAKICAgICAgICAgIDogaW5pdGlhbHModHJhY2sudGl0bGUpOwogICAgICAgIGNhcmQuaW5uZXJIVE1MID0gYAogICAgICAgICAgPGRpdiBjbGFzcz0ibXVzaWMtY2FyZC1oZWFkZXIiPgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJtdXNpYy10aHVtYiI+JHthcnRIVE1MfTwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJtdXNpYy1tZXRhIj4KICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJtdXNpYy10aXRsZSI+JHtlc2NhcGVIVE1MKHRyYWNrLnRpdGxlKX08L2Rpdj4KICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJtdXNpYy1hcnRpc3QiPiR7ZXNjYXBlSFRNTCh0cmFjay5hcnRpc3QpfSR7dHJhY2suYWxidW0gPyAiIMK3ICIgKyBlc2NhcGVIVE1MKHRyYWNrLmFsYnVtKSA6ICIifTwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIDwvZGl2PgogICAgICAgICAgPGRpdiBjbGFzcz0ibXVzaWMtYWN0aW9ucyI+CiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9Im11c2ljLWJ0biBwcmltYXJ5Ij5QbGF5IHByZXZpZXc8L2J1dHRvbj4KICAgICAgICAgICAgJHt0cmFjay5pdHVuZXNVcmwgPyBgPGEgY2xhc3M9Im11c2ljLWJ0biIgaHJlZj0iJHtlc2NhcGVIVE1MKHRyYWNrLml0dW5lc1VybCl9IiB0YXJnZXQ9Il9ibGFuayI+aVR1bmVzPC9hPmAgOiAiIn0KICAgICAgICAgIDwvZGl2PgogICAgICAgIGA7CiAgICAgICAgY29uc3QgcHJldmlld0J0biA9IGNhcmQucXVlcnlTZWxlY3RvcigiLm11c2ljLWJ0bi5wcmltYXJ5Iik7CiAgICAgICAgYmluZFByZXZpZXcocHJldmlld0J0biwgdHJhY2spOwogICAgICAgIHJldHVybiBjYXJkOwogICAgICB9CgogICAgICBmdW5jdGlvbiBqc29ucCh1cmwsIHRpbWVvdXRNcyA9IDEyMDAwKSB7CiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKICAgIGNvbnN0IGNiID0gIml0dW5lc19qc29ucF8iICsgTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc2xpY2UoMik7CiAgICBjb25zdCBzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzY3JpcHQiKTsKICAgIGNvbnN0IHNlcCA9IHVybC5pbmNsdWRlcygiPyIpID8gIiYiIDogIj8iOwogICAgY29uc3QgdGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4gewogICAgICBjbGVhbnVwKCk7CiAgICAgIHJlamVjdChuZXcgRXJyb3IoIkpTT05QIHRpbWVvdXQiKSk7CiAgICB9LCB0aW1lb3V0TXMpOwoKICAgIGZ1bmN0aW9uIGNsZWFudXAoKSB7CiAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTsKICAgICAgZGVsZXRlIHdpbmRvd1tjYl07CiAgICAgIHNjcmlwdC5yZW1vdmUoKTsKICAgIH0KCiAgICB3aW5kb3dbY2JdID0gKHBheWxvYWQpID0+IHsKICAgICAgY2xlYW51cCgpOwogICAgICByZXNvbHZlKHBheWxvYWQpOwogICAgfTsKCiAgICBzY3JpcHQuc3JjID0gdXJsICsgc2VwICsgImNhbGxiYWNrPSIgKyBjYjsKICAgIHNjcmlwdC5vbmVycm9yID0gKCkgPT4gewogICAgICBjbGVhbnVwKCk7CiAgICAgIHJlamVjdChuZXcgRXJyb3IoIkpTT05QIGVycm9yIikpOwogICAgfTsKICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc2NyaXB0KTsKICB9KTsKfQoKYXN5bmMgZnVuY3Rpb24gZmV0Y2hJdHVuZXModGVybSwgbGltaXQgPSA2KSB7CiAgY29uc3QgYmFzZSA9ICJodHRwczovL2l0dW5lcy5hcHBsZS5jb20vc2VhcmNoIjsKICBjb25zdCB1cmwgPSBgJHtiYXNlfT90ZXJtPSR7ZW5jb2RlVVJJQ29tcG9uZW50KHRlcm0pfSZtZWRpYT1tdXNpYyZlbnRpdHk9bXVzaWNUcmFjayZsaW1pdD0ke2xpbWl0fWA7CiAgLy8gaVR1bmVzIFNlYXJjaCBpcyBvZnRlbiBibG9ja2VkIGJ5IENPUlMgZnJvbSBzdGF0aWMgcGFnZXM7IEpTT05QIGlzIHRoZSBtb3N0IHJlbGlhYmxlIG9wdGlvbi4KICBjb25zdCBkYXRhID0gYXdhaXQganNvbnAodXJsKTsKICByZXR1cm4gKGRhdGEucmVzdWx0cyB8fCBbXSkubWFwKHIgPT4gKHsKICAgIHRpdGxlOiByLnRyYWNrTmFtZSB8fCAiVW5rbm93biIsCiAgICBhcnRpc3Q6IHIuYXJ0aXN0TmFtZSB8fCAiVW5rbm93biBBcnRpc3QiLAogICAgYWxidW06IHIuY29sbGVjdGlvbk5hbWUsCiAgICBhcnQ6IHIuYXJ0d29ya1VybDEwMCwKICAgIHByZXZpZXdVcmw6IHIucHJldmlld1VybCwKICAgIGl0dW5lc1VybDogci50cmFja1ZpZXdVcmwKICB9KSkuZmlsdGVyKHIgPT4gci50aXRsZSk7Cn0KCiAgICAgIGFzeW5jIGZ1bmN0aW9uIGxvYWRNb250aGx5KCkgewogICAgICAgIG1vbnRobHlFbC5pbm5lckhUTUwgPSAnPGRpdiBzdHlsZT0iY29sb3I6dmFyKC0tdGV4dC1tdXRlZCk7Ij5Mb2FkaW5nLi4uPC9kaXY+JzsKICAgICAgICBjb25zdCB0cmFja3MgPSBhd2FpdCBQcm9taXNlLmFsbChNT05USExZX1BJQ0tTLm1hcChhc3luYyBwaWNrID0+IHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGNvbnN0IGhpdHMgPSBhd2FpdCBmZXRjaEl0dW5lcyhgJHtwaWNrLnRpdGxlfSAke3BpY2suYXJ0aXN0fWAsIDEpOwogICAgICAgICAgICByZXR1cm4gaGl0c1swXSB8fCBwaWNrOwogICAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICAgIHJldHVybiB7IC4uLnBpY2ssIHByZXZpZXdVcmw6ICIiLCBpdHVuZXNVcmw6ICIiLCBhcnQ6ICIiIH07CiAgICAgICAgICB9CiAgICAgICAgfSkpOwogICAgICAgIG1vbnRobHlFbC5pbm5lckhUTUwgPSAiIjsKICAgICAgICB0cmFja3MuZm9yRWFjaCh0ID0+IG1vbnRobHlFbC5hcHBlbmRDaGlsZChjYXJkRnJvbVRyYWNrKHQpKSk7CiAgICAgIH0KCiAgICAgIGFzeW5jIGZ1bmN0aW9uIHJ1blNlYXJjaCgpIHsKICAgICAgICBjb25zdCB0ZXJtID0gc2VhcmNoSW5wdXQudmFsdWUudHJpbSgpOwogICAgICAgIGlmICghdGVybSkgcmV0dXJuOwogICAgICAgIHJlc3VsdHNFbC5pbm5lckhUTUwgPSAnPGRpdiBzdHlsZT0iY29sb3I6dmFyKC0tdGV4dC1tdXRlZCk7Ij5TZWFyY2hpbmcuLi48L2Rpdj4nOwogICAgICAgIGVtcHR5RWwuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICB0cnkgewogICAgICAgICAgY29uc3QgaGl0cyA9IGF3YWl0IGZldGNoSXR1bmVzKHRlcm0sIDkpOwogICAgICAgICAgcmVzdWx0c0VsLmlubmVySFRNTCA9ICIiOwogICAgICAgICAgaWYgKGhpdHMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgIGVtcHR5RWwudGV4dENvbnRlbnQgPSAiTm8gcmVzdWx0cy4iOwogICAgICAgICAgICBlbXB0eUVsLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaGl0cy5mb3JFYWNoKHQgPT4gcmVzdWx0c0VsLmFwcGVuZENoaWxkKGNhcmRGcm9tVHJhY2sodCkpKTsKICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICByZXN1bHRzRWwuaW5uZXJIVE1MID0gIiI7CiAgICAgICAgICBlbXB0eUVsLnRleHRDb250ZW50ID0gIlNlYXJjaCBmYWlsZWQuIjsKICAgICAgICAgIGVtcHR5RWwuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CiAgICAgICAgfQogICAgICB9CgogICAgICByZWZyZXNoQnRuPy5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIGxvYWRNb250aGx5KTsKICAgICAgc2VhcmNoQnRuPy5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIHJ1blNlYXJjaCk7CiAgICAgIHNlYXJjaElucHV0Py5hZGRFdmVudExpc3RlbmVyKCJrZXlwcmVzcyIsIGUgPT4geyBpZiAoZS5rZXkgPT09ICJFbnRlciIpIHJ1blNlYXJjaCgpOyB9KTsKICAgICAgbG9hZE1vbnRobHkoKTsKICAgIH0pKCk7CiAgPC9zY3JpcHQ+CgogIDwhLS0gQ2xvY2sgLS0+CiAgPHNjcmlwdD4KICAgIGZ1bmN0aW9uIHVwZGF0ZUNsb2NrKCkgewogICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpOwogICAgICBsZXQgaCA9IG5vdy5nZXRIb3VycygpLCBtID0gbm93LmdldE1pbnV0ZXMoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyksIGFtID0gaCA+PSAxMiA/ICdQTScgOiAnQU0nOwogICAgICBoID0gaCAlIDEyIHx8IDEyOwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3lzdGVtLWNsb2NrLXRpbWUnKS50ZXh0Q29udGVudCA9IGAke2h9OiR7bX0gJHthbX1gOwogICAgICBjb25zdCBtbyA9IChub3cuZ2V0TW9udGgoKSArIDEpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKTsKICAgICAgY29uc3QgZCA9IG5vdy5nZXREYXRlKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpOwogICAgICBjb25zdCB5ID0gbm93LmdldEZ1bGxZZWFyKCk7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzeXN0ZW0tY2xvY2stZGF0ZScpLnRleHRDb250ZW50ID0gYCR7bW99LyR7ZH0vJHt5fWA7CiAgICB9CiAgICB1cGRhdGVDbG9jaygpOwogICAgc2V0SW50ZXJ2YWwodXBkYXRlQ2xvY2ssIDMwMDAwKTsKICA8L3NjcmlwdD4KPC9ib2R5Pgo8L2h0bWw+" onload="try{this.contentDocument.documentElement.classList.add('app-mode')}catch(e){}"></iframe></div>
</div>


<div id="browser" class="window">
  <div class="titlebar"><div class="name">Browser</div><div class="win-actions">
    <button title="Maximize" onclick="toggleMax('browser')">‚ñ¢</button>
    <button title="Minimize" onclick="minWin('browser')">‚Äì</button>
    <button class="close" title="Close" onclick="closeWin('browser')">√ó</button>
  </div></div>
  <div class="content" style="display:flex;flex-direction:column;height:100%;padding:0;">
    <div style="display:flex;gap:8px;align-items:center;padding:10px 12px;border-bottom:1px solid rgba(255,255,255,.08);background:rgba(0,0,0,.18);">
      <button class="btn" onclick="browserBack()" title="Back">‚Üê</button>
      <button class="btn" onclick="browserForward()" title="Forward">‚Üí</button>
      <button class="btn" onclick="browserReload()" title="Reload">‚ü≥</button>
      <input id="browser-url" style="flex:1;min-width:120px;padding:10px 12px;border-radius:12px;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.06);color:var(--text);" placeholder="Enter URL (https://...)" />
      <button class="btn primary" onclick="browserGo()">Go</button>
    </div>
    <div id="browser-stage" style="flex:1;min-height:0;position:relative;background:rgba(0,0,0,.15);">
      <div id="browser-loading" style="position:absolute;inset:0;display:grid;place-items:center;color:var(--muted);font-size:.95rem;">
        Loading proxy‚Ä¶
      </div>
    </div>
  </div>
</div>


<div id="settings" class="window">
  <div class="titlebar"><div class="name">Settings</div><div class="win-actions">
    <button title="Maximize" onclick="toggleMax('settings')">‚ñ¢</button>
    <button title="Minimize" onclick="minWin('settings')">‚Äì</button>
    <button class="close" title="Close" onclick="closeWin('settings')">√ó</button>
  </div></div>
  <div class="content" style="padding:18px;overflow:auto;">
    <div style="max-width:760px;margin:0 auto;display:grid;gap:14px;">
      <div style="background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:16px;">
        <strong>Theme</strong>
        <div style="color:var(--muted);font-size:.9rem;margin-top:6px;">Pick a look.</div>
        <div style="display:grid;gap:8px;margin-top:10px;">
          <label><input type="radio" name="themePreset" value="midnight"> Midnight</label>
          <label><input type="radio" name="themePreset" value="aurora"> Aurora</label>
          <label><input type="radio" name="themePreset" value="sunset"> Sunset</label>
          <label><input type="radio" name="themePreset" value="cyberpunk"> Cyberpunk</label>
          <label><input type="radio" name="themePreset" value="nebula"> Nebula</label>
          <label><input type="radio" name="themePreset" value="mono"> Mono</label>
        </div>
      </div>

      <div style="background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:16px;">
        <strong>Panic Button</strong>
        <div style="color:var(--muted);font-size:.9rem;margin-top:6px;">Choose where Panic sends you.</div>
        <div style="display:grid;gap:8px;margin-top:10px;">
          <label><input type="radio" name="panicPreset" value="sora"> Sora</label>
          <label><input type="radio" name="panicPreset" value="canvas"> Canvas</label>
          <label><input type="radio" name="panicPreset" value="skyward"> Skyward</label>
          <label><input type="radio" name="panicPreset" value="outlook"> Outlook</label>
          <label style="opacity:.55"><input type="radio" disabled> ALEKS (soon)</label>
        </div>
      </div>

      <div style="background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:16px;">
        <strong>Login</strong>
        <div style="color:var(--muted);font-size:.9rem;margin-top:6px;">Auto-login and lock screen.</div>
        <div class="toggle" style="justify-content:flex-start;margin-top:10px;">
          <input id="autoLogin2" type="checkbox" /> <label for="autoLogin2">Enable auto-login</label>
        </div>
        <button style="margin-top:10px;width:auto;padding:10px 14px;border-radius:999px;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.06);color:var(--text);font-weight:800;cursor:pointer" onclick="logout()">Sign out</button>
      </div>
    </div>
  </div>
</div>

<script>
const panicUrls={
  sora:"https://soraapp.com/library/lwsdwa",
  canvas:"https://lwsd414.instructure.com/",
  skyward:"https://www.q.wa-k12.net/lkwash/Home/StudentAccess/Home",
  outlook:"https://outlook.office.com/mail/inbox/id/AAkALgAAAAAAHYQDEapmEc2byACqAC%2FEWg0Ah9KI2NDsL0G2LhypLBZNAAAGUdx62AAA"
};

const KEY_USER="galaxyUser";
const KEY_PASS="galaxyPass"; // demo only
const KEY_AUTO="galaxyAutoLogin";
const KEY_THEME="galaxyTheme";
const KEY_PANIC="panicPreset";

function $(id){return document.getElementById(id);}

function setLoginError(msg){
  const el=$("login-error");
  el.textContent=msg||"";
  el.style.display = msg ? "block" : "none";
}

function showLogin(){ $("login").style.display="flex"; }
function hideLogin(){ $("login").style.display="none"; }

function applyTheme(t){
  const theme = t || localStorage.getItem(KEY_THEME) || "midnight";
  document.documentElement.setAttribute("data-theme", theme);
}
function initTheme(){
  applyTheme();
  const cur = localStorage.getItem(KEY_THEME) || "midnight";
  document.querySelectorAll('input[name="themePreset"]').forEach(r=>{
    if(r.value===cur) r.checked=true;
    r.addEventListener("change", ()=>{ localStorage.setItem(KEY_THEME, r.value); applyTheme(r.value); });
  });
}

function initPanic(){
  const cur = localStorage.getItem(KEY_PANIC) || "canvas";
  document.querySelectorAll('input[name="panicPreset"]').forEach(r=>{
    if(r.value===cur) r.checked=true;
    r.addEventListener("change", ()=>localStorage.setItem(KEY_PANIC, r.value));
  });
}

function initAutoLoginToggles(){
  const enabled = localStorage.getItem(KEY_AUTO)==="1";
  $("autoLogin").checked = enabled;
  const auto2 = $("autoLogin2");
  if(auto2) auto2.checked = enabled;
  $("autoLogin").addEventListener("change", ()=>localStorage.setItem(KEY_AUTO, $("autoLogin").checked ? "1":"0"));
  if(auto2) auto2.addEventListener("change", ()=>{
    localStorage.setItem(KEY_AUTO, auto2.checked ? "1":"0");
    $("autoLogin").checked = auto2.checked;
  });
}

function login(){
  const u=$("user").value.trim();
  const p=$("pass").value.trim();
  if(!u || !p){ setLoginError("Enter a username and password."); return; }
  localStorage.setItem(KEY_USER,u);
  localStorage.setItem(KEY_PASS,p);
  localStorage.setItem(KEY_AUTO, $("autoLogin").checked ? "1":"0");
  setLoginError("");
  hideLogin();
  openWin("games");
  showChangelogIfNeeded();
}

function logout(){
  localStorage.removeItem(KEY_AUTO);
  // keep user/pass if you want; remove if you want true logout:
  // localStorage.removeItem(KEY_USER); localStorage.removeItem(KEY_PASS);
  closeAll();
  showLogin();
}

function lockScreen(){
  closeAll();
  showLogin();
}

function tryAutoLogin(){
  const auto = localStorage.getItem(KEY_AUTO)==="1";
  const u = localStorage.getItem(KEY_USER);
  const p = localStorage.getItem(KEY_PASS);
  if(auto && u && p){
    hideLogin();
    openWin("games");
    return true;
  }
  return false;
}

function panic(){
  const k = localStorage.getItem(KEY_PANIC) || "canvas";
  location.href = panicUrls[k] || panicUrls.canvas;
}

function toggleStart(){
  const m=$("startMenu");
  m.style.display = (m.style.display==="block") ? "none" : "block";
}
document.addEventListener("click",(e)=>{
  if(!e.target.closest("#startMenu") && !e.target.closest("#startBtn")){
    const m=$("startMenu"); if(m) m.style.display="none";
  }
});

function openWin(id){
  const w=$(id); if(!w) return;
  w.dataset.minimized="0";
  w.style.display="flex";
  w.style.zIndex=String(Date.now());
  refreshTaskbar();
}
function closeWin(id){
  const w=$(id); if(!w) return;
  w.style.display="none";
  w.dataset.minimized="0";
  refreshTaskbar();
}
function minWin(id){
  const w=$(id); if(!w) return;
  w.dataset.minimized="1";
  w.style.display="none";
  refreshTaskbar();
}
function toggleMax(id){
  const w=$(id); if(!w) return;
  w.classList.toggle("maximized");
  w.style.zIndex=String(Date.now());
  refreshTaskbar();
}
function closeAll(){
  ["games","music","settings"].forEach(id=>{ const w=$(id); if(w){w.style.display="none"; w.dataset.minimized="0";} });
  refreshTaskbar();
}
function topmostOpen(){
  const apps=["games","music","settings"];
  let top=null, topZ=-1;
  apps.forEach(id=>{
    const w=$(id); if(!w) return;
    if(w.style.display!=="flex") return;
    const z=Number(w.style.zIndex||0);
    if(z>topZ){topZ=z; top=id;}
  });
  return top;
}
function refreshTaskbar(){
  const bar=$("taskbar");
  const apps=["games","music","settings"];
  // keep Start button
  const startBtn = $("startBtn");
  bar.innerHTML="";
  bar.appendChild(startBtn);
  const top=topmostOpen();
  apps.forEach(id=>{
    const w=$(id); if(!w) return;
    const open = (w.style.display==="flex");
    const minimized = (w.dataset.minimized==="1");
    if(!open && !minimized) return;
    const btn=document.createElement("button");
    btn.className="task-btn"+(top===id?" active":"");
    btn.textContent=id[0].toUpperCase()+id.slice(1);
    btn.onclick=()=>openWin(id);
    bar.appendChild(btn);
  });
}

document.addEventListener("mousedown",(e)=>{
  // focus windows
  const win=e.target.closest(".window");
  if(win) win.style.zIndex=String(Date.now());
  refreshTaskbar();
});

document.addEventListener("keydown",(e)=>{
  if(e.key==="Enter" && $("login").style.display==="flex") login();
});

// Boot
setTimeout(()=>{
  $("boot").style.display="none";
  showLogin();
  const u = localStorage.getItem(KEY_USER);
  if(u) $("user").value=u;
  initTheme();
  initPanic();
  initAutoLoginToggles();
  tryAutoLogin();
}, 1200);

/* ===== Changelog ===== */
const CHANGELOG_VERSION = "1.6.4";
const CHANGELOG_KEY = "gx_changelog_seen_" + CHANGELOG_VERSION;

function openChangelog(force = true){
  const m = document.getElementById("changelogModal");
  if(!m) return;
  m.style.display = "flex";
  if(force) localStorage.setItem(CHANGELOG_KEY, "1");
}
function closeChangelog(){
  const m = document.getElementById("changelogModal");
  if(!m) return;
  m.style.display = "none";
  localStorage.setItem(CHANGELOG_KEY, "1");
}
function showChangelogIfNeeded(){
  if(localStorage.getItem(CHANGELOG_KEY) === "1") return;
  openChangelog(false);
}
function dontShowChangelogAgain(){
  localStorage.setItem(CHANGELOG_KEY, "1");
  closeChangelog();
}

/* ===== Browser (Scramjet) ===== */
let __gxBrowser = {
  ready: false,
  frame: null,
  controller: null,
};

async function ensureBrowser(){
  if(__gxBrowser.ready) return;
  const stage = document.getElementById("browser-stage");
  const loading = document.getElementById("browser-loading");
  if(!stage) return;

  // Require Scramjet loader to be present.
  if(typeof globalThis.$scramjetLoadController !== "function"){
    if(loading) loading.textContent = "Scramjet not found. Ensure scramjet.all.js is in the same folder.";
    return;
  }

  const { ScramjetController } = globalThis.$scramjetLoadController();
  const controller = new ScramjetController({ prefix: "/scramjet/" });

  try{
    await controller.init();
  }catch(e){
    if(loading) loading.textContent = "Proxy init failed. (This file must be served over http(s), not file://)";
    console.error(e);
    return;
  }

  const frame = controller.createFrame();
  frame.frame.style.width = "100%";
  frame.frame.style.height = "100%";
  frame.frame.style.border = "0";
  frame.frame.style.display = "block";

  if(loading) loading.remove();
  stage.appendChild(frame.frame);

  __gxBrowser.ready = true;
  __gxBrowser.frame = frame;
  __gxBrowser.controller = controller;

  // Default home
  browserGo("https://example.com");
}

function normalizeUrl(u){
  const s = String(u || "").trim();
  if(!s) return "";
  if(/^[a-zA-Z][a-zA-Z0-9+.-]*:/.test(s)) return s;
  return "https://" + s;
}

function browserGo(u){
  const input = document.getElementById("browser-url");
  const url = normalizeUrl(u || (input ? input.value : ""));
  if(input && url) input.value = url;

  if(!__gxBrowser.ready){
    ensureBrowser().then(() => {
      if(__gxBrowser.frame && url) __gxBrowser.frame.go(url);
    });
    return;
  }
  if(__gxBrowser.frame && url) __gxBrowser.frame.go(url);
}

function browserBack(){ try{ __gxBrowser.frame?.back(); }catch(e){} }
function browserForward(){ try{ __gxBrowser.frame?.forward(); }catch(e){} }
function browserReload(){ try{ __gxBrowser.frame?.reload(); }catch(e){} }

/* Hook window open to init browser on first open */
const __openWinOriginal = openWin;
openWin = function(id){
  __openWinOriginal(id);
  if(id === "browser") setTimeout(() => ensureBrowser(), 0);
};

</script>

<div id="changelogModal" style="position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.62);backdrop-filter: blur(10px);z-index:9999;">
  <div style="width:min(760px,92vw);max-height:82vh;overflow:auto;background:rgba(20,26,42,.92);border:1px solid rgba(255,255,255,.14);border-radius:18px;box-shadow:0 20px 80px rgba(0,0,0,.55);padding:18px;">
    <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;">
      <div>
        <div style="font-weight:800;letter-spacing:.02em;">Galaxy Lounge ‚Äî Changelog</div>
        <div style="color:var(--muted);font-size:.9rem;margin-top:2px;">What‚Äôs new in this build</div>
      </div>
      <button class="btn" onclick="closeChangelog()">Close</button>
    </div>
    <div style="margin-top:14px;display:grid;gap:10px;line-height:1.35;">
      <div style="padding:12px;border-radius:14px;border:1px solid rgba(255,255,255,.10);background:rgba(255,255,255,.04);">
        <div style="font-weight:800;">v1.6.1</div>
        <ul style="margin:8px 0 0 18px;color:var(--text);">
          <li>Games and Music windows now correctly fill the available height.</li>
          <li>Music app upgraded to Galaxy Music Hub (iTunes preview search + monthly picks).</li>
          <li>New Browser app (Scramjet proxy-backed).</li>
          <li>Changelog now opens automatically on launch (once per version).</li>
        </ul>
      </div>
      <div style="padding:12px;border-radius:14px;border:1px solid rgba(255,255,255,.10);background:rgba(255,255,255,.04);">
        <div style="font-weight:800;">Notes</div>
        <div style="color:var(--muted);margin-top:6px;">
          The Browser requires the Scramjet files to be in the same folder as this HTML.
        </div>
      </div>
    </div>
    <div style="display:flex;justify-content:flex-end;gap:10px;margin-top:16px;">
      <button class="btn" onclick="dontShowChangelogAgain()">Don‚Äôt show again</button>
      <button class="btn primary" onclick="closeChangelog()">Got it</button>
    </div>
  </div>
</div>

</body>
</html>
